import{$ as Xi,$a as cr,$c as Vr,A as $e,Aa as x,Ac as Dr,Ad as qr,B as zt,Ba as M,Bc as Or,Bd as oi,C as Yi,Ca as Ue,Cc as Ei,Cd as Gr,D as Y,Da as re,Dc as Tr,Dd as Qr,E as Ae,Ea as mt,Ec as kr,Ed as Kr,F as U,Fa as he,Fb as J,Fd as Zr,Ga as W,Gb as ee,Gd as Yr,H as l,Ha as q,Hc as Ir,Hd as Xr,I as Jn,Ia as ir,Ib as K,Ic as Rr,Id as Jr,J as k,Ja as ht,Jb as Rt,Jc as po,Jd as es,K as I,Ka as It,Kb as yt,Kc as Ct,Kd as ts,L as Ke,La as _e,Lb as Kt,Lc as L,Ld as pn,M as Ht,Ma as Ze,Mb as gr,Mc as Ar,Md as un,N as G,Na as F,Nc as Xe,Nd as Di,O as ae,Oa as or,Ob as Le,Oc as Xt,P as le,Pa as u,Pb as Ne,Pc as Fr,Pd as Ee,Q as O,Qa as v,Qb as _r,Qc as uo,Qd as ve,R as $t,Ra as E,Rb as br,Rc as Jt,Rd as ni,S as Ut,Sa as nr,Sb as io,Sc as fo,Sd as ri,Ta as rr,Tb as vr,Tc as Lr,Td as si,U as oe,Ua as sr,Ub as At,Uc as ei,Ud as ai,Va as ar,Vb as Ye,Vc as St,Vd as is,W as c,Wa as lr,Wb as oo,Wc as Nr,X as Ot,Xa as sn,Xb as je,Xc as ti,Y as Ci,Ya as ce,Yc as go,Z as Si,Za as _,Zb as no,Zc as ii,_ as Tt,_a as b,_b as ro,_c as jr,a as D,aa as C,ab as de,ac as yr,ad as Br,b as xe,ba as Fe,bb as eo,bd as H,c as jt,ca as ne,cd as zr,d as Re,db as qt,dc as xr,dd as Hr,e as _t,ea as er,eb as me,ec as Pe,ed as hn,f as S,fa as bt,fb as pt,fc as Zt,fd as N,g as Ge,ga as tr,gb as dr,gc as Cr,h as Un,ha as Ji,hb as Pi,hc as an,i as Wn,ia as Ce,ib as Me,ic as so,j as xi,ja as wi,jb as pe,jc as Yt,k as Vt,ka as Mi,kb as mr,kc as ln,kd as $r,l as qn,la as R,lb as hr,lc as Sr,ld as Je,ma as A,mb as pr,md as Ur,n as Gn,na as vt,nb as to,nc as ao,nd as et,o as Qe,oa as Wt,oc as cn,od as be,p as Et,pa as Se,pc as lo,pd as Ve,qa as we,qc as xt,qd as se,r as Zi,ra as y,rb as ur,rc as dn,rd as V,sa as h,sc as co,t as Qn,ta as m,tb as fr,tc as wr,td as wt,u as Kn,ua as w,uc as mn,ud as ge,v as Zn,va as lt,vc as Mr,vd as j,w as Yn,wa as ct,wc as mo,wd as Wr,x as Xn,xa as kt,xb as Gt,xc as Pr,y as Dt,ya as Q,yb as Qt,yc as Er,z as Bt,za as dt,zb as X,zc as ho}from"./chunk-7WE2LLYI.js";var Ft=(()=>{class n{constructor(){this._imageChange=O({mosaicConfig:null,shouldFocus:!1}),this.imageChange=this._imageChange.asReadonly()}emitImageChange(e,t){this._imageChange.set({mosaicConfig:e,shouldFocus:t})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();var os=(()=>{class n{constructor(){this.store=l(N),this.destroyRef=l(G),this.configService=l(Ft),this.toolService=l(Ee),this.mosaicConfig=this.store.selectSignal(Je),this.imageObject=O(null),this.imageChanged$=Hr(this.configService.imageChange),this.ribbonActions=[{iconName:"crop",visibility:O("on"),onClick:()=>this.toolService.openTakeSnapshotDialog(this.activeCanvas,"configuration_snapshot.png")},{iconName:"recenter",visibility:de(()=>this.imageObject()?"on":"disabled"),onClick:()=>{this.focusOnImage(this.imageObject()),this.activeCanvas.redraw()}}]}sectionEntered(e,t){return this.activeCanvas=e,this.imageChanged$.pipe(H(this.destroyRef),Xn(1)).subscribe(o=>{let r=o.shouldFocus||t;this.drawImage(o.mosaicConfig,r)}),{ribbon:this.ribbonActions}}async drawImage(e,t){let o=this.imageObject();o?.removeObject(),o=null,e&&(o=await Ee.createImageObject(e),this.activeCanvas.addCanvasObject(o,!1),t&&this.focusOnImage(o)),this.imageObject.set(o),this.activeCanvas.redraw()}focusOnImage(e){let t=Ee.calculateZoomForImage(e.size,this.activeCanvas.viewport);this.activeCanvas.setViewport(t,j.zero)}onRouterChange(){this.configService.emitImageChange(this.mosaicConfig(),!1)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-configuration"]],features:[ce([Ft])],decls:1,vars:0,consts:[[3,"activate"]],template:function(t,o){t&1&&(h(0,"router-outlet",0),x("activate",function(){return o.onRouterChange()}),m())},dependencies:[V,K,Qt],styles:["[_nghost-%COMP%]{display:block;box-sizing:border-box;height:100%;padding:20px 10px;overflow-y:auto;overflow-x:hidden}"],changeDetection:0})}}return n})();var li=(()=>{class n{constructor(){this.translate=l(J),this.data=l(qr),this.noLabel=this.data.noCustomLabel??this.translate.instant("common.no"),this.yesLabel=this.data.yesCustomLabel??this.translate.instant("common.yes")}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-dialog"]],decls:10,vars:5,consts:[[1,"dialog-content"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"h1",1),u(2),m(),h(3,"div",2),u(4),m(),h(5,"div",3)(6,"button",4),u(7),m(),h(8,"button",5),u(9),m()()()),t&2&&(c(2),v(o.data.title),c(2),v(o.data.message),c(3),v(o.noLabel),c(),y("mat-dialog-close",!0),c(),v(o.yesLabel))},dependencies:[Yr,Gr,Qr,Zr,Kr,V,se],styles:[".dialog-content[_ngcontent-%COMP%]{max-width:400px}.dialog-content[_ngcontent-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{padding-bottom:0}"],changeDetection:0})}}return n})();function $a(n,i){if(n&1){let e=Q();h(0,"button",0),x("click",function(){k(e);let o=M();return I(o.navigateToProjectConfiguration())}),u(1),_(2,"translate"),m(),h(3,"button",1),u(4),_(5,"translate"),m(),h(6,"button",1),u(7),_(8,"translate"),m(),h(9,"button",2),x("click",function(){k(e);let o=M();return I(o.rejectProject())}),u(10),_(11,"translate"),m()}n&2&&(c(),v(b(2,4,"tool.config.menu.projectSettings")),c(3),v(b(5,6,"tool.config.menu.saveProject")),c(3),v(b(8,8,"tool.config.menu.loadProject")),c(3),v(b(11,10,"tool.config.menu.rejectProject")))}function Ua(n,i){if(n&1){let e=Q();h(0,"button",3),x("click",function(){k(e);let o=M();return I(o.navigateToProjectConfiguration())}),u(1),_(2,"translate"),m(),h(3,"button",1),u(4),_(5,"translate"),m(),h(6,"button",1),u(7),_(8,"translate"),m()}n&2&&(c(),v(b(2,3,"tool.config.menu.newProject")),c(3),v(b(5,5,"tool.config.menu.exampleProjects")),c(3),v(b(8,7,"tool.config.menu.loadProject")))}var ns=(()=>{class n{constructor(){this.store=l(N),this.translate=l(J),this.mosaicConfig=this.store.selectSignal(Je),this.dialog=l(oi),this.router=l(X),this.configService=l(Ft),this.destroyRef=l(G)}navigateToProjectConfiguration(){this.router.navigate(["/tool/config/project"])}rejectProject(){let e={title:this.translate.instant("tool.config.menu.rejectProject"),message:this.translate.instant("tool.config.menu.rejectProjectWarning")};this.dialog.open(li,{data:e}).afterClosed().pipe(H(this.destroyRef)).subscribe(t=>{t&&(this.store.dispatch(ve.projectCanceled()),this.configService.emitImageChange(null,!1))})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-config-menu"]],decls:2,vars:1,consts:[["mat-flat-button","",3,"click"],["mat-flat-button","","color","accent","disabled",""],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(t,o){t&1&&R(0,$a,12,12)(1,Ua,9,9),t&2&&A(o.mosaicConfig()?0:1)},dependencies:[V,se,K,ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:10px}"],changeDetection:0})}}return n})();var fn=class{_box;_destroyed=new S;_resizeSubject=new S;_resizeObserver;_elementObservables=new Map;constructor(i){this._box=i,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(e=>this._resizeSubject.next(e)))}observe(i){return this._elementObservables.has(i)||this._elementObservables.set(i,new _t(e=>{let t=this._resizeSubject.subscribe(e);return this._resizeObserver?.observe(i,{box:this._box}),()=>{this._resizeObserver?.unobserve(i),t.unsubscribe(),this._elementObservables.delete(i)}}).pipe(Et(e=>e.some(t=>t.target===i)),Yn({bufferSize:1,refCount:!0}),$e(this._destroyed))),this._elementObservables.get(i)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},rs=(()=>{class n{_cleanupErrorListener;_observers=new Map;_ngZone=l(le);constructor(){typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,e]of this._observers)e.destroy();this._observers.clear(),this._cleanupErrorListener?.()}observe(e,t){let o=t?.box||"content-box";return this._observers.has(o)||this._observers.set(o,new fn(o)),this._observers.get(o).observe(e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Wa=["notch"],qa=["matFormFieldNotchedOutline",""],Ga=["*"],ss=["iconPrefixContainer"],as=["textPrefixContainer"],ls=["iconSuffixContainer"],cs=["textSuffixContainer"],Qa=["textField"],Ka=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Za=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function Ya(n,i){n&1&&w(0,"span",21)}function Xa(n,i){if(n&1&&(h(0,"label",20),re(1,1),R(2,Ya,1,0,"span",21),m()),n&2){let e=M(2);y("floating",e._shouldLabelFloat())("monitorResize",e._hasOutline())("id",e._labelId),Ce("for",e._control.disableAutomaticLabeling?null:e._control.id),c(2),A(!e.hideRequiredMarker&&e._control.required?2:-1)}}function Ja(n,i){if(n&1&&R(0,Xa,3,5,"label",20),n&2){let e=M();A(e._hasFloatingLabel()?0:-1)}}function el(n,i){n&1&&w(0,"div",7)}function tl(n,i){}function il(n,i){if(n&1&&bt(0,tl,0,0,"ng-template",13),n&2){M(2);let e=_e(1);y("ngTemplateOutlet",e)}}function ol(n,i){if(n&1&&(h(0,"div",9),R(1,il,1,1,null,13),m()),n&2){let e=M();y("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat()),c(),A(e._forceDisplayInfixLabel()?-1:1)}}function nl(n,i){n&1&&(h(0,"div",10,2),re(2,2),m())}function rl(n,i){n&1&&(h(0,"div",11,3),re(2,3),m())}function sl(n,i){}function al(n,i){if(n&1&&bt(0,sl,0,0,"ng-template",13),n&2){M();let e=_e(1);y("ngTemplateOutlet",e)}}function ll(n,i){n&1&&(h(0,"div",14,4),re(2,4),m())}function cl(n,i){n&1&&(h(0,"div",15,5),re(2,5),m())}function dl(n,i){n&1&&w(0,"div",16)}function ml(n,i){n&1&&(h(0,"div",18),re(1,6),m())}function hl(n,i){if(n&1&&(h(0,"mat-hint",22),u(1),m()),n&2){let e=M(2);y("id",e._hintLabelId),c(),v(e.hintLabel)}}function pl(n,i){if(n&1&&(h(0,"div",19),R(1,hl,2,2,"mat-hint",22),re(2,7),w(3,"div",23),re(4,8),m()),n&2){let e=M();c(),A(e.hintLabel?1:-1)}}var Oe=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["mat-label"]]})}return n})(),gs=new U("MatError"),Oi=(()=>{class n{id=l(Pe).getId("mat-mdc-error-");constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["mat-error"],["","matError",""]],hostAttrs:[1,"mat-mdc-form-field-error","mat-mdc-form-field-bottom-align"],hostVars:1,hostBindings:function(t,o){t&2&&dt("id",o.id)},inputs:{id:"id"},features:[ce([{provide:gs,useExisting:n}])]})}return n})(),gn=(()=>{class n{align="start";id=l(Pe).getId("mat-mdc-hint-");static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(t,o){t&2&&(dt("id",o.id),Ce("align",null),F("mat-mdc-form-field-hint-end",o.align==="end"))},inputs:{align:"align",id:"id"}})}return n})(),ul=new U("MatPrefix");var _s=new U("MatSuffix"),Ti=(()=>{class n{set _isTextSelector(e){this._isText=!0}_isText=!1;static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:[0,"matTextSuffix","_isTextSelector"]},features:[ce([{provide:_s,useExisting:n}])]})}return n})(),bs=new U("FloatingLabelParent"),ds=(()=>{class n{_elementRef=l(oe);get floating(){return this._floating}set floating(e){this._floating=e,this.monitorResize&&this._handleResize()}_floating=!1;get monitorResize(){return this._monitorResize}set monitorResize(e){this._monitorResize=e,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}_monitorResize=!1;_resizeObserver=l(rs);_ngZone=l(le);_parent=l(bs);_resizeSubscription=new Re;constructor(){}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return fl(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(t,o){t&2&&F("mdc-floating-label--float-above",o.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return n})();function fl(n){let i=n;if(i.offsetParent!==null)return i.scrollWidth;let e=i.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);let t=e.scrollWidth;return e.remove(),t}var ms="mdc-line-ripple--active",_o="mdc-line-ripple--deactivating",hs=(()=>{class n{_elementRef=l(oe);_cleanupTransitionEnd;constructor(){let e=l(le),t=l(Tt);e.runOutsideAngular(()=>{this._cleanupTransitionEnd=t.listen(this._elementRef.nativeElement,"transitionend",this._handleTransitionEnd)})}activate(){let e=this._elementRef.nativeElement.classList;e.remove(_o),e.add(ms)}deactivate(){this._elementRef.nativeElement.classList.add(_o)}_handleTransitionEnd=e=>{let t=this._elementRef.nativeElement.classList,o=t.contains(_o);e.propertyName==="opacity"&&o&&t.remove(ms,_o)};ngOnDestroy(){this._cleanupTransitionEnd()}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return n})(),ps=(()=>{class n{_elementRef=l(oe);_ngZone=l(le);open=!1;_notch;ngAfterViewInit(){let e=this._elementRef.nativeElement,t=e.querySelector(".mdc-floating-label");t?(e.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(t.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>t.style.transitionDuration="")}))):e.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(e){let t=this._notch.nativeElement;!this.open||!e?t.style.width="":t.style.width=`calc(${e}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}_setMaxWidth(e){this._notch.nativeElement.style.setProperty("--mat-form-field-notch-max-width",`calc(100% - ${e}px)`)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(t,o){if(t&1&&he(Wa,5),t&2){let r;W(r=q())&&(o._notch=r.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(t,o){t&2&&F("mdc-notched-outline--notched",o.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},attrs:qa,ngContentSelectors:Ga,decls:5,vars:0,consts:[["notch",""],[1,"mat-mdc-notch-piece","mdc-notched-outline__leading"],[1,"mat-mdc-notch-piece","mdc-notched-outline__notch"],[1,"mat-mdc-notch-piece","mdc-notched-outline__trailing"]],template:function(t,o){t&1&&(Ue(),kt(0,"div",1),lt(1,"div",2,0),re(3),ct(),kt(4,"div",3))},encapsulation:2,changeDetection:0})}return n})(),_n=(()=>{class n{value;stateChanges;id;placeholder;ngControl;focused;empty;shouldLabelFloat;required;disabled;errorState;controlType;autofilled;userAriaDescribedBy;disableAutomaticLabeling;describedByIds;static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n})}return n})();var ki=new U("MatFormField"),gl=new U("MAT_FORM_FIELD_DEFAULT_OPTIONS"),us="fill",_l="auto",fs="fixed",bl="translateY(-50%)",ze=(()=>{class n{_elementRef=l(oe);_changeDetectorRef=l(Me);_platform=l(Ye);_idGenerator=l(Pe);_ngZone=l(le);_defaults=l(gl,{optional:!0});_currentDirection;_textField;_iconPrefixContainer;_textPrefixContainer;_iconSuffixContainer;_textSuffixContainer;_floatingLabel;_notchedOutline;_lineRipple;_iconPrefixContainerSignal=pt("iconPrefixContainer");_textPrefixContainerSignal=pt("textPrefixContainer");_iconSuffixContainerSignal=pt("iconSuffixContainer");_textSuffixContainerSignal=pt("textSuffixContainer");_prefixSuffixContainers=de(()=>[this._iconPrefixContainerSignal(),this._textPrefixContainerSignal(),this._iconSuffixContainerSignal(),this._textSuffixContainerSignal()].map(e=>e?.nativeElement).filter(e=>e!==void 0));_formFieldControl;_prefixChildren;_suffixChildren;_errorChildren;_hintChildren;_labelChild=dr(Oe);get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=Yt(e)}_hideRequiredMarker=!1;color="primary";get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||_l}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}_floatLabel;get appearance(){return this._appearanceSignal()}set appearance(e){let t=e||this._defaults?.appearance||us;this._appearanceSignal.set(t)}_appearanceSignal=O(us);get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||fs}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||fs}_subscriptSizing=null;get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}_hintLabel="";_hasIconPrefix=!1;_hasTextPrefix=!1;_hasIconSuffix=!1;_hasTextSuffix=!1;_labelId=this._idGenerator.getId("mat-mdc-form-field-label-");_hintLabelId=this._idGenerator.getId("mat-mdc-hint-");_describedByIds;get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}_destroyed=new S;_isFocused=null;_explicitFormFieldControl;_previousControl=null;_previousControlValidatorFn=null;_stateChanges;_valueChanges;_describedByChanges;_outlineLabelOffsetResizeObserver=null;_animationsDisabled=xt();constructor(){let e=this._defaults,t=l(Rt);e&&(e.appearance&&(this.appearance=e.appearance),this._hideRequiredMarker=!!e?.hideRequiredMarker,e.color&&(this.color=e.color)),$t(()=>this._currentDirection=t.valueSignal()),this._syncOutlineLabelOffset()}ngAfterViewInit(){this._updateFocusState(),this._animationsDisabled||this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-form-field-animations-enabled")},300)}),this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeSubscript(),this._initializePrefixAndSuffix()}ngAfterContentChecked(){this._assertFormFieldControl(),this._control!==this._previousControl&&(this._initializeControl(this._previousControl),this._control.ngControl&&this._control.ngControl.control&&(this._previousControlValidatorFn=this._control.ngControl.control.validator),this._previousControl=this._control),this._control.ngControl&&this._control.ngControl.control&&this._control.ngControl.control.validator!==this._previousControlValidatorFn&&this._changeDetectorRef.markForCheck()}ngOnDestroy(){this._outlineLabelOffsetResizeObserver?.disconnect(),this._stateChanges?.unsubscribe(),this._valueChanges?.unsubscribe(),this._describedByChanges?.unsubscribe(),this._destroyed.next(),this._destroyed.complete()}getLabelId=de(()=>this._hasFloatingLabel()?this._labelId:null);getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(e){let t=this._control,o="mat-mdc-form-field-type-";e&&this._elementRef.nativeElement.classList.remove(o+e.controlType),t.controlType&&this._elementRef.nativeElement.classList.add(o+t.controlType),this._stateChanges?.unsubscribe(),this._stateChanges=t.stateChanges.subscribe(()=>{this._updateFocusState(),this._changeDetectorRef.markForCheck()}),this._describedByChanges?.unsubscribe(),this._describedByChanges=t.stateChanges.pipe(Dt([void 0,void 0]),Vt(()=>[t.errorState,t.userAriaDescribedBy]),Zn(),Et(([[r,s],[a,d]])=>r!==a||s!==d)).subscribe(()=>this._syncDescribedByIds()),this._valueChanges?.unsubscribe(),t.ngControl&&t.ngControl.valueChanges&&(this._valueChanges=t.ngControl.valueChanges.pipe($e(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()))}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Qe(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){let e=this._control.focused;e&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!e&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._elementRef.nativeElement.classList.toggle("mat-focused",e),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",e)}_syncOutlineLabelOffset(){hr({earlyRead:()=>{if(this._appearanceSignal()!=="outline")return this._outlineLabelOffsetResizeObserver?.disconnect(),null;if(globalThis.ResizeObserver){this._outlineLabelOffsetResizeObserver||=new globalThis.ResizeObserver(()=>{this._writeOutlinedLabelStyles(this._getOutlinedLabelOffset())});for(let e of this._prefixSuffixContainers())this._outlineLabelOffsetResizeObserver.observe(e,{box:"border-box"})}return this._getOutlinedLabelOffset()},write:e=>this._writeOutlinedLabelStyles(e())})}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel=de(()=>!!this._labelChild());_shouldLabelFloat(){return this._hasFloatingLabel()?this._control.shouldLabelFloat||this._shouldAlwaysFloat():!1}_shouldForward(e){let t=this._control?this._control.ngControl:null;return t&&t[e]}_getSubscriptMessageType(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&e.push(...this._control.userAriaDescribedBy.split(" ")),this._getSubscriptMessageType()==="hint"){let r=this._hintChildren?this._hintChildren.find(a=>a.align==="start"):null,s=this._hintChildren?this._hintChildren.find(a=>a.align==="end"):null;r?e.push(r.id):this._hintLabel&&e.push(this._hintLabelId),s&&e.push(s.id)}else this._errorChildren&&e.push(...this._errorChildren.map(r=>r.id));let t=this._control.describedByIds,o;if(t){let r=this._describedByIds||e;o=e.concat(t.filter(s=>s&&!r.includes(s)))}else o=e;this._control.setDescribedByIds(o),this._describedByIds=e}}_getOutlinedLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return null;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return["",null];if(!this._isAttachedToDom())return null;let e=this._iconPrefixContainer?.nativeElement,t=this._textPrefixContainer?.nativeElement,o=this._iconSuffixContainer?.nativeElement,r=this._textSuffixContainer?.nativeElement,s=e?.getBoundingClientRect().width??0,a=t?.getBoundingClientRect().width??0,d=o?.getBoundingClientRect().width??0,f=r?.getBoundingClientRect().width??0,g=this._currentDirection==="rtl"?"-1":"1",B=`${s+a}px`,yi=`calc(${g} * (${B} + var(--mat-mdc-form-field-label-offset-x, 0px)))`,on=`var(--mat-mdc-form-field-label-transform, ${bl} translateX(${yi}))`,nn=s+a+d+f;return[on,nn]}_writeOutlinedLabelStyles(e){if(e!==null){let[t,o]=e;this._floatingLabel&&(this._floatingLabel.element.style.transform=t),o!==null&&this._notchedOutline?._setMaxWidth(o)}}_isAttachedToDom(){let e=this._elementRef.nativeElement;if(e.getRootNode){let t=e.getRootNode();return t&&t!==e}return document.documentElement.contains(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["mat-form-field"]],contentQueries:function(t,o,r){if(t&1&&(ir(r,o._labelChild,Oe,5),mt(r,_n,5),mt(r,ul,5),mt(r,_s,5),mt(r,gs,5),mt(r,gn,5)),t&2){It();let s;W(s=q())&&(o._formFieldControl=s.first),W(s=q())&&(o._prefixChildren=s),W(s=q())&&(o._suffixChildren=s),W(s=q())&&(o._errorChildren=s),W(s=q())&&(o._hintChildren=s)}},viewQuery:function(t,o){if(t&1&&(ht(o._iconPrefixContainerSignal,ss,5),ht(o._textPrefixContainerSignal,as,5),ht(o._iconSuffixContainerSignal,ls,5),ht(o._textSuffixContainerSignal,cs,5),he(Qa,5),he(ss,5),he(as,5),he(ls,5),he(cs,5),he(ds,5),he(ps,5),he(hs,5)),t&2){It(4);let r;W(r=q())&&(o._textField=r.first),W(r=q())&&(o._iconPrefixContainer=r.first),W(r=q())&&(o._textPrefixContainer=r.first),W(r=q())&&(o._iconSuffixContainer=r.first),W(r=q())&&(o._textSuffixContainer=r.first),W(r=q())&&(o._floatingLabel=r.first),W(r=q())&&(o._notchedOutline=r.first),W(r=q())&&(o._lineRipple=r.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:38,hostBindings:function(t,o){t&2&&F("mat-mdc-form-field-label-always-float",o._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",o._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",o._hasIconSuffix)("mat-form-field-invalid",o._control.errorState)("mat-form-field-disabled",o._control.disabled)("mat-form-field-autofilled",o._control.autofilled)("mat-form-field-appearance-fill",o.appearance=="fill")("mat-form-field-appearance-outline",o.appearance=="outline")("mat-form-field-hide-placeholder",o._hasFloatingLabel()&&!o._shouldLabelFloat())("mat-primary",o.color!=="accent"&&o.color!=="warn")("mat-accent",o.color==="accent")("mat-warn",o.color==="warn")("ng-untouched",o._shouldForward("untouched"))("ng-touched",o._shouldForward("touched"))("ng-pristine",o._shouldForward("pristine"))("ng-dirty",o._shouldForward("dirty"))("ng-valid",o._shouldForward("valid"))("ng-invalid",o._shouldForward("invalid"))("ng-pending",o._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[ce([{provide:ki,useExisting:n},{provide:bs,useExisting:n}])],ngContentSelectors:Za,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],["textSuffixContainer",""],["iconSuffixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],["aria-atomic","true","aria-live","polite",1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(t,o){if(t&1){let r=Q();Ue(Ka),bt(0,Ja,1,1,"ng-template",null,0,cr),h(2,"div",6,1),x("click",function(a){return k(r),I(o._control.onContainerClick(a))}),R(4,el,1,0,"div",7),h(5,"div",8),R(6,ol,2,2,"div",9),R(7,nl,3,0,"div",10),R(8,rl,3,0,"div",11),h(9,"div",12),R(10,al,1,1,null,13),re(11),m(),R(12,ll,3,0,"div",14),R(13,cl,3,0,"div",15),m(),R(14,dl,1,0,"div",16),m(),h(15,"div",17),R(16,ml,2,0,"div",18)(17,pl,5,1,"div",19),m()}if(t&2){let r;c(2),F("mdc-text-field--filled",!o._hasOutline())("mdc-text-field--outlined",o._hasOutline())("mdc-text-field--no-label",!o._hasFloatingLabel())("mdc-text-field--disabled",o._control.disabled)("mdc-text-field--invalid",o._control.errorState),c(2),A(!o._hasOutline()&&!o._control.disabled?4:-1),c(2),A(o._hasOutline()?6:-1),c(),A(o._hasIconPrefix?7:-1),c(),A(o._hasTextPrefix?8:-1),c(2),A(!o._hasOutline()||o._forceDisplayInfixLabel()?10:-1),c(2),A(o._hasTextSuffix?12:-1),c(),A(o._hasIconSuffix?13:-1),c(),A(o._hasOutline()?-1:14),c(),F("mat-mdc-form-field-subscript-dynamic-size",o.subscriptSizing==="dynamic");let s=o._getSubscriptMessageType();c(),A((r=s)==="error"?16:r==="hint"?17:-1)}},dependencies:[ds,ps,pr,hs,gn],styles:[`.mdc-text-field{display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field__input{width:100%;min-width:0;border:none;border-radius:0;background:none;padding:0;-moz-appearance:none;-webkit-appearance:none;height:28px}.mdc-text-field__input::-webkit-calendar-picker-indicator,.mdc-text-field__input::-webkit-search-cancel-button{display:none}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input::placeholder{opacity:0}.mdc-text-field__input::-moz-placeholder{opacity:0}.mdc-text-field__input::-webkit-input-placeholder{opacity:0}.mdc-text-field__input:-ms-input-placeholder{opacity:0}.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-moz-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-webkit-input-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive:-ms-input-placeholder{opacity:0}.mdc-text-field--outlined .mdc-text-field__input,.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mat-form-field-filled-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mat-form-field-filled-caret-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mat-form-field-filled-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-filled-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-filled-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-filled-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mat-form-field-outlined-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mat-form-field-outlined-caret-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mat-form-field-outlined-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-outlined-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-outlined-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-outlined-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mat-form-field-filled-error-caret-color, var(--mat-sys-error))}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mat-form-field-outlined-error-caret-color, var(--mat-sys-error))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mat-form-field-filled-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mat-form-field-outlined-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}}.mdc-text-field--filled{height:56px;border-bottom-right-radius:0;border-bottom-left-radius:0;border-top-left-radius:var(--mat-form-field-filled-container-shape, var(--mat-sys-corner-extra-small));border-top-right-radius:var(--mat-form-field-filled-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mat-form-field-filled-container-color, var(--mat-sys-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mat-form-field-filled-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 4%, transparent))}.mdc-text-field--outlined{height:56px;overflow:visible;padding-right:max(16px,var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small)));padding-left:max(16px,var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small)) + 4px)}[dir=rtl] .mdc-text-field--outlined{padding-right:max(16px,var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small)) + 4px);padding-left:max(16px,var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small)))}.mdc-floating-label{position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:auto}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:auto;right:4px}.mdc-text-field--filled .mdc-floating-label{left:16px;right:auto}[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:auto;right:16px}.mdc-text-field--disabled .mdc-floating-label{cursor:default}@media(forced-colors: active){.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mat-form-field-filled-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mat-form-field-filled-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mat-form-field-filled-hover-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label{color:var(--mat-form-field-filled-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mat-form-field-filled-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mat-form-field-filled-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mat-form-field-filled-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mat-form-field-filled-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-form-field-filled-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-form-field-filled-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-form-field-filled-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mat-form-field-outlined-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mat-form-field-outlined-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mat-form-field-outlined-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label{color:var(--mat-form-field-outlined-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mat-form-field-outlined-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mat-form-field-outlined-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mat-form-field-outlined-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mat-form-field-outlined-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-form-field-outlined-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-form-field-outlined-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-form-field-outlined-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-floating-label--float-above{cursor:auto;transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1);font-size:.75rem}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mat-mdc-notch-piece{box-sizing:border-box;height:100%;pointer-events:none;border-top:1px solid;border-bottom:1px solid}.mdc-text-field--focused .mat-mdc-notch-piece{border-width:2px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mat-mdc-notch-piece{border-color:var(--mat-form-field-outlined-outline-color, var(--mat-sys-outline));border-width:var(--mat-form-field-outlined-outline-width, 1px)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mat-mdc-notch-piece{border-color:var(--mat-form-field-outlined-hover-outline-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mat-form-field-outlined-focus-outline-color, var(--mat-sys-primary))}.mdc-text-field--outlined.mdc-text-field--disabled .mat-mdc-notch-piece{border-color:var(--mat-form-field-outlined-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mat-mdc-notch-piece{border-color:var(--mat-form-field-outlined-error-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-notched-outline .mat-mdc-notch-piece{border-color:var(--mat-form-field-outlined-error-hover-outline-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mat-form-field-outlined-error-focus-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mat-mdc-notch-piece{border-width:var(--mat-form-field-outlined-focus-outline-width, 2px)}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small)))}[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__trailing{flex-grow:1;border-left:none;border-right:1px solid;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small))}[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:min(var(--mat-form-field-notch-max-width, 100%),calc(100% - max(12px, var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small))) * 2))}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{max-width:min(100%,calc(100% - max(12px, var(--mat-form-field-outlined-container-shape, var(--mat-sys-corner-extra-small))) * 2))}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1;border-bottom-width:var(--mat-form-field-filled-active-indicator-height, 1px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mat-form-field-filled-active-indicator-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mat-form-field-filled-hover-active-indicator-color, var(--mat-sys-on-surface))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mat-form-field-filled-disabled-active-indicator-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-line-ripple::before{border-bottom-color:var(--mat-form-field-filled-error-active-indicator-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mat-form-field-filled-error-hover-active-indicator-color, var(--mat-sys-on-error-container))}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mat-form-field-filled-focus-active-indicator-height, 2px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mat-form-field-filled-focus-active-indicator-color, var(--mat-sys-primary))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mat-form-field-filled-error-focus-active-indicator-color, var(--mat-sys-error))}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-text-field--disabled{pointer-events:none}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height, 56px);padding-top:var(--mat-form-field-filled-with-label-container-padding-top, 24px);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom, 8px)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding, 16px);padding-bottom:var(--mat-form-field-container-vertical-padding, 16px)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height, 56px)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height, 56px) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}@keyframes _mat-form-field-subscript-animation{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px;opacity:1;transform:translateY(0);animation:_mat-form-field-subscript-animation 0ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color, var(--mat-sys-error))}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-form-field-subscript-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-form-field-subscript-text-size, var(--mat-sys-body-small-size));letter-spacing:var(--mat-form-field-subscript-text-tracking, var(--mat-sys-body-small-tracking));font-weight:var(--mat-form-field-subscript-text-weight, var(--mat-sys-body-small-weight))}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color, var(--mat-sys-on-surface))}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity, 0)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color, var(--mat-sys-neutral10))}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color, color-mix(in srgb, var(--mat-sys-neutral10) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}@media(forced-colors: active){.mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}}@media(forced-colors: active){.mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-form-field-container-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-form-field-container-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-form-field-container-text-tracking, var(--mat-sys-body-large-tracking));font-weight:var(--mat-form-field-container-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color, var(--mat-sys-error))}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color, var(--mat-sys-on-error-container))}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color, var(--mat-sys-error))}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field-infix:has(textarea[cols]){width:auto}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input{transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::-moz-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input::-webkit-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mat-mdc-form-field.mat-form-field-animations-enabled.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field.mat-form-field-animations-enabled .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field.mat-form-field-animations-enabled .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field.mat-form-field-animations-enabled .mat-mdc-form-field-error-wrapper{animation-duration:300ms}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}
`],encapsulation:2,changeDetection:0})}return n})();var We=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=Fe({type:n});static \u0275inj=Ae({imports:[yr,ze,yt]})}return n})();var vl=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-text-field-style-loader",""],decls:0,vars:0,template:function(t,o){},styles:[`textarea.cdk-textarea-autosize{resize:none}textarea.cdk-textarea-autosize-measuring{padding:2px 0 !important;box-sizing:content-box !important;height:auto !important;overflow:hidden !important}textarea.cdk-textarea-autosize-measuring-firefox{padding:2px 0 !important;box-sizing:content-box !important;height:0 !important}@keyframes cdk-text-field-autofill-start{/*!*/}@keyframes cdk-text-field-autofill-end{/*!*/}.cdk-text-field-autofill-monitored:-webkit-autofill{animation:cdk-text-field-autofill-start 0s 1ms}.cdk-text-field-autofill-monitored:not(:-webkit-autofill){animation:cdk-text-field-autofill-end 0s 1ms}
`],encapsulation:2,changeDetection:0})}return n})(),yl={passive:!0},vs=(()=>{class n{_platform=l(Ye);_ngZone=l(le);_renderer=l(Si).createRenderer(null,null);_styleLoader=l(Kt);_monitoredElements=new Map;constructor(){}monitor(e){if(!this._platform.isBrowser)return Wn;this._styleLoader.load(vl);let t=je(e),o=this._monitoredElements.get(t);if(o)return o.subject;let r=new S,s="cdk-text-field-autofilled",a=f=>{f.animationName==="cdk-text-field-autofill-start"&&!t.classList.contains(s)?(t.classList.add(s),this._ngZone.run(()=>r.next({target:f.target,isAutofilled:!0}))):f.animationName==="cdk-text-field-autofill-end"&&t.classList.contains(s)&&(t.classList.remove(s),this._ngZone.run(()=>r.next({target:f.target,isAutofilled:!1})))},d=this._ngZone.runOutsideAngular(()=>(t.classList.add("cdk-text-field-autofill-monitored"),this._renderer.listen(t,"animationstart",a,yl)));return this._monitoredElements.set(t,{subject:r,unlisten:d}),r}stopMonitoring(e){let t=je(e),o=this._monitoredElements.get(t);o&&(o.unlisten(),o.subject.complete(),t.classList.remove("cdk-text-field-autofill-monitored"),t.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(t))}ngOnDestroy(){this._monitoredElements.forEach((e,t)=>this.stopMonitoring(t))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ys=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=Fe({type:n});static \u0275inj=Ae({})}return n})();var xs=new U("MAT_INPUT_VALUE_ACCESSOR");var Cs=(()=>{class n{isErrorState(e,t){return!!(e&&e.invalid&&(e.touched||t&&t.submitted))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var bo=class{_defaultMatcher;ngControl;_parentFormGroup;_parentForm;_stateChanges;errorState=!1;matcher;constructor(i,e,t,o,r){this._defaultMatcher=i,this.ngControl=e,this._parentFormGroup=t,this._parentForm=o,this._stateChanges=r}updateErrorState(){let i=this.errorState,e=this._parentFormGroup||this._parentForm,t=this.matcher||this._defaultMatcher,o=this.ngControl?this.ngControl.control:null,r=t?.isErrorState(o,e)??!1;r!==i&&(this.errorState=r,this._stateChanges.next())}};var xl=["button","checkbox","file","hidden","image","radio","range","reset","submit"],Cl=new U("MAT_INPUT_CONFIG"),it=(()=>{class n{_elementRef=l(oe);_platform=l(Ye);ngControl=l(Ar,{optional:!0,self:!0});_autofillMonitor=l(vs);_ngZone=l(le);_formField=l(ki,{optional:!0});_renderer=l(Tt);_uid=l(Pe).getId("mat-input-");_previousNativeValue;_inputValueAccessor;_signalBasedValueAccessor;_previousPlaceholder;_errorStateTracker;_config=l(Cl,{optional:!0});_cleanupIosKeyup;_cleanupWebkitWheel;_isServer;_isNativeSelect;_isTextarea;_isInFormField;focused=!1;stateChanges=new S;controlType="mat-input";autofilled=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=Yt(e),this.focused&&(this.focused=!1,this.stateChanges.next())}_disabled=!1;get id(){return this._id}set id(e){this._id=e||this._uid}_id;placeholder;name;get required(){return this._required??this.ngControl?.control?.hasValidator(L.required)??!1}set required(e){this._required=Yt(e)}_required;get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&ln().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}_type="text";get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(e){this._errorStateTracker.matcher=e}userAriaDescribedBy;get value(){return this._signalBasedValueAccessor?this._signalBasedValueAccessor.value():this._inputValueAccessor.value}set value(e){e!==this.value&&(this._signalBasedValueAccessor?this._signalBasedValueAccessor.value.set(e):this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=Yt(e)}_readonly=!1;disabledInteractive;get errorState(){return this._errorStateTracker.errorState}set errorState(e){this._errorStateTracker.errorState=e}_neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(e=>ln().has(e));constructor(){let e=l(Fr,{optional:!0}),t=l(St,{optional:!0}),o=l(Cs),r=l(xs,{optional:!0,self:!0}),s=this._elementRef.nativeElement,a=s.nodeName.toLowerCase();r?Ji(r.value)?this._signalBasedValueAccessor=r:this._inputValueAccessor=r:this._inputValueAccessor=s,this._previousNativeValue=this.value,this.id=this.id,this._platform.IOS&&this._ngZone.runOutsideAngular(()=>{this._cleanupIosKeyup=this._renderer.listen(s,"keyup",this._iOSKeyupListener)}),this._errorStateTracker=new bo(o,this.ngControl,t,e,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=a==="select",this._isTextarea=a==="textarea",this._isInFormField=!!this._formField,this.disabledInteractive=this._config?.disabledInteractive||!1,this._isNativeSelect&&(this.controlType=s.multiple?"mat-native-select-multiple":"mat-native-select"),this._signalBasedValueAccessor&&$t(()=>{this._signalBasedValueAccessor.value(),this.stateChanges.next()})}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._cleanupIosKeyup?.(),this._cleanupWebkitWheel?.()}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(e){if(e!==this.focused){if(!this._isNativeSelect&&e&&this.disabled&&this.disabledInteractive){let t=this._elementRef.nativeElement;t.type==="number"?(t.type="text",t.setSelectionRange(0,0),t.type="number"):t.setSelectionRange(0,0)}this.focused=e,this.stateChanges.next()}}_onInput(){}_dirtyCheckNativeValue(){let e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){let e=this._getPlaceholder();if(e!==this._previousPlaceholder){let t=this._elementRef.nativeElement;this._previousPlaceholder=e,e?t.setAttribute("placeholder",e):t.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){xl.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let e=this._elementRef.nativeElement,t=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&t&&t.label)}else return this.focused&&!this.disabled||!this.empty}get describedByIds(){return this._elementRef.nativeElement.getAttribute("aria-describedby")?.split(" ")||[]}setDescribedByIds(e){let t=this._elementRef.nativeElement;e.length?t.setAttribute("aria-describedby",e.join(" ")):t.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}_iOSKeyupListener=e=>{let t=e.target;!t.value&&t.selectionStart===0&&t.selectionEnd===0&&(t.setSelectionRange(1,1),t.setSelectionRange(0,0))};_getReadonlyAttribute(){return this._isNativeSelect?null:this.readonly||this.disabled&&this.disabledInteractive?"true":null}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:21,hostBindings:function(t,o){t&1&&x("focus",function(){return o._focusChanged(!0)})("blur",function(){return o._focusChanged(!1)})("input",function(){return o._onInput()}),t&2&&(dt("id",o.id)("disabled",o.disabled&&!o.disabledInteractive)("required",o.required),Ce("name",o.name||null)("readonly",o._getReadonlyAttribute())("aria-disabled",o.disabled&&o.disabledInteractive?"true":null)("aria-invalid",o.empty&&o.required?null:o.errorState)("aria-required",o.required)("id",o.id),F("mat-input-server",o._isServer)("mat-mdc-form-field-textarea-control",o._isInFormField&&o._isTextarea)("mat-mdc-form-field-input-control",o._isInFormField)("mat-mdc-input-disabled-interactive",o.disabledInteractive)("mdc-text-field__input",o._isInFormField)("mat-mdc-native-select-inline",o._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly",disabledInteractive:[2,"disabledInteractive","disabledInteractive",pe]},exportAs:["matInput"],features:[ce([{provide:_n,useExisting:n}]),Ut]})}return n})(),ot=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=Fe({type:n});static \u0275inj=Ae({imports:[We,We,ys,yt]})}return n})();function Sl(n,i){if(n&1){let e=Q();h(0,"div",1)(1,"button",2),x("click",function(){k(e);let o=M();return I(o.action())}),u(2),m()()}if(n&2){let e=M();c(2),E(" ",e.data.action," ")}}var wl=["label"];function Ml(n,i){}var Pl=Math.pow(2,31)-1,Ai=class{_overlayRef;instance;containerInstance;_afterDismissed=new S;_afterOpened=new S;_onAction=new S;_durationTimeoutId;_dismissedByAction=!1;constructor(i,e){this._overlayRef=e,this.containerInstance=i,i._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(i){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(i,Pl))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},Ss=new U("MatSnackBarData"),ci=class{politeness="polite";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},El=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return n})(),Dl=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return n})(),Ol=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return n})(),Tl=(()=>{class n{snackBarRef=l(Ai);data=l(Ss);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["matButton","","matSnackBarAction","",3,"click"]],template:function(t,o){t&1&&(h(0,"div",0),u(1),m(),R(2,Sl,3,1,"div",1)),t&2&&(c(),E(" ",o.data.message,`
`),c(),A(o.hasAction?2:-1))},dependencies:[se,El,Dl,Ol],styles:[`.mat-mdc-simple-snack-bar{display:flex}.mat-mdc-simple-snack-bar .mat-mdc-snack-bar-label{max-height:50vh;overflow:auto}
`],encapsulation:2,changeDetection:0})}return n})(),bn="_mat-snack-bar-enter",vn="_mat-snack-bar-exit",kl=(()=>{class n extends wr{_ngZone=l(le);_elementRef=l(oe);_changeDetectorRef=l(Me);_platform=l(Ye);_animationsDisabled=xt();snackBarConfig=l(ci);_document=l(Ht);_trackedModals=new Set;_enterFallback;_exitFallback;_injector=l(Ke);_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new S;_onExit=new S;_onEnter=new S;_animationState="void";_live;_label;_role;_liveElementId=l(Pe).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();let t=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),t}attachTemplatePortal(e){this._assertNotAttached();let t=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),t}attachDomPortal=e=>{this._assertNotAttached();let t=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),t};onAnimationEnd(e){e===vn?this._completeExit():e===bn&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?Ot(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(bn)))},{injector:this._injector}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(bn)},200)))}exit(){return this._destroyed?xi(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?Ot(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(vn)))},{injector:this._injector}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(vn),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,t=this.snackBarConfig.panelClass;t&&(Array.isArray(t)?t.forEach(s=>e.classList.add(s)):e.classList.add(t)),this._exposeToModals();let o=this._label.nativeElement,r="mdc-snackbar__label";o.classList.toggle(r,!o.querySelector(`.${r}`))}_exposeToModals(){let e=this._liveElementId,t=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let o=0;o<t.length;o++){let r=t[o],s=r.getAttribute("aria-owns");this._trackedModals.add(r),s?s.indexOf(e)===-1&&r.setAttribute("aria-owns",s+" "+e):r.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let t=e.getAttribute("aria-owns");if(t){let o=t.replace(this._liveElementId,"").trim();o.length>0?e.setAttribute("aria-owns",o):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;let e=this._elementRef.nativeElement,t=e.querySelector("[aria-hidden]"),o=e.querySelector("[aria-live]");if(t&&o){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&t.contains(document.activeElement)&&(r=document.activeElement),t.removeAttribute("aria-hidden"),o.appendChild(t),r?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["mat-snack-bar-container"]],viewQuery:function(t,o){if(t&1&&(he(mn,7),he(wl,7)),t&2){let r;W(r=q())&&(o._portalOutlet=r.first),W(r=q())&&(o._label=r.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(t,o){t&1&&x("animationend",function(s){return o.onAnimationEnd(s.animationName)})("animationcancel",function(s){return o.onAnimationEnd(s.animationName)}),t&2&&F("mat-snack-bar-container-enter",o._animationState==="visible")("mat-snack-bar-container-exit",o._animationState==="hidden")("mat-snack-bar-container-animations-enabled",!o._animationsDisabled)},features:[er],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(t,o){t&1&&(h(0,"div",1)(1,"div",2,0)(3,"div",3),bt(4,Ml,0,0,"ng-template",4),m(),w(5,"div"),m()()),t&2&&(c(5),Ce("aria-live",o._live)("role",o._role)("id",o._liveElementId))},dependencies:[mn],styles:[`@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mat-snack-bar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-snack-bar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-snack-bar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mat-snack-bar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-snack-bar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mat-snack-bar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mat-snack-bar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-button-text-state-layer-color: currentColor;--mat-button-text-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}
`],encapsulation:2})}return n})(),Il=new U("mat-snack-bar-default-options",{providedIn:"root",factory:()=>new ci}),nt=(()=>{class n{_live=l(xr);_injector=l(Ke);_breakpointObserver=l(ro);_parentSnackBar=l(n,{optional:!0,skipSelf:!0});_defaultConfig=l(Il);_animationsDisabled=xt();_snackBarRefAtThisLevel=null;simpleSnackBarComponent=Tl;snackBarContainerComponent=kl;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,t){return this._attach(e,t)}openFromTemplate(e,t){return this._attach(e,t)}open(e,t="",o){let r=D(D({},this._defaultConfig),o);return r.data={message:e,action:t},r.announcementMessage===e&&(r.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,r)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,t){let o=t&&t.viewContainerRef&&t.viewContainerRef.injector,r=Ke.create({parent:o||this._injector,providers:[{provide:ci,useValue:t}]}),s=new dn(this.snackBarContainerComponent,t.viewContainerRef,r),a=e.attach(s);return a.instance.snackBarConfig=t,a.instance}_attach(e,t){let o=D(D(D({},new ci),this._defaultConfig),t),r=this._createOverlay(o),s=this._attachSnackBarContainer(r,o),a=new Ai(s,r);if(e instanceof Ci){let d=new co(e,null,{$implicit:o.data,snackBarRef:a});a.instance=s.attachTemplatePortal(d)}else{let d=this._createInjector(o,a),f=new dn(e,void 0,d),g=s.attachComponentPortal(f);a.instance=g.instance}return this._breakpointObserver.observe(lo.HandsetPortrait).pipe($e(r.detachments())).subscribe(d=>{r.overlayElement.classList.toggle(this.handsetCssClass,d.matches)}),o.announcementMessage&&s._onAnnounce.subscribe(()=>{this._live.announce(o.announcementMessage,o.politeness)}),this._animateSnackBar(a,o),this._openedSnackBarRef=a,this._openedSnackBarRef}_animateSnackBar(e,t){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),t.announcementMessage&&this._live.clear()}),t.duration&&t.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(t.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){let t=new mo;t.direction=e.direction;let o=Er(this._injector),r=e.direction==="rtl",s=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!r||e.horizontalPosition==="end"&&r,a=!s&&e.horizontalPosition!=="center";return s?o.left("0"):a?o.right("0"):o.centerHorizontally(),e.verticalPosition==="top"?o.top("0"):o.bottom("0"),t.positionStrategy=o,t.disableAnimations=this._animationsDisabled,ho(this._injector,t)}_createInjector(e,t){let o=e&&e.viewContainerRef&&e.viewContainerRef.injector;return Ke.create({parent:o||this._injector,providers:[{provide:Ai,useValue:t},{provide:Ss,useValue:e.data}]})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var di=class{static getErrorLabel(i,e){if(i.errors){for(let t of Object.keys(i.errors))if(i.errors[t]&&t in e)return e[t]()}return null}static getFieldErrorLabel(i,e){let t=i.errors();for(let{kind:o}of t)if(o in e)return e[o]();return null}};var ws=1,Ms=1e3,Ps=(()=>{class n{constructor(){this.fb=l(ti),this.destroyRef=l(G),this.snackBar=l(nt),this.router=l(X),this.configService=l(Ft),this.store=l(N),this.translate=l(J),this.mosaicConfig=this.store.selectSignal(Je),this.errorLabels={min:()=>this.translate.instant("tool.config.project.mosaicMinWidthErrorMessage",{width:ws}),max:()=>this.translate.instant("tool.config.project.mosaicMaxWidthErrorMessage",{width:Ms}),required:()=>this.translate.instant("tool.config.project.mosaicWidthRequiredErrorMessage")}}ngOnInit(){this.buildProjectForm(),this.isReadOnlyMode()?this.projectForm.disable():this.subscribeOnFormValueChanged()}buildProjectForm(){this.projectForm=this.fb.group({mosaicWidth:this.fb.nonNullable.control(this.mosaicConfig()?.mosaicWidth??100,{validators:[L.required,L.min(ws),L.max(Ms)]}),mosaicImage:this.fb.control(null,{validators:[L.required]})})}subscribeOnFormValueChanged(){this.projectForm.valueChanges.pipe(H(this.destroyRef)).subscribe(e=>{if(this.projectForm.valid){let t=new FileReader;t.readAsDataURL(e.mosaicImage),t.onload=o=>{this.configService.emitImageChange({base64Image:o?.target?.result,mosaicWidth:e.mosaicWidth},!0)}}else this.configService.emitImageChange(null,!1)})}navigateToConfiguration(){this.router.navigate(["/tool/config"])}trySave(){if(this.projectForm.valid)this.save();else{let e=this.getErrorMessage();this.snackBar.open(e,this.translate.instant("common.ok"),{duration:2e3})}}save(){let e=this.projectForm.getRawValue(),t=new FileReader;t.readAsDataURL(e.mosaicImage),t.onload=o=>{let s={config:{base64Image:o?.target?.result,mosaicWidth:e.mosaicWidth},tilesSets:[],sectors:[]};this.createNewProject(s),this.snackBar.open(this.translate.instant("tool.config.project.projectCreated"),this.translate.instant("common.ok"),{duration:2e3}),this.navigateToConfiguration()}}createNewProject(e){this.store.dispatch(ve.projectCreated({project:e}))}getErrorMessage(){if(this.projectForm.controls.mosaicImage.valid){if(!this.projectForm.controls.mosaicWidth.valid)return this.getErrorLabel(this.projectForm.controls.mosaicWidth)}else return this.translate.instant("tool.config.project.selectImageErrorMessage");return""}getErrorLabel(e){return di.getErrorLabel(e,this.errorLabels)}onImageSelected(e){let o=e.target.files?.item(0);this.projectForm.patchValue({mosaicImage:o})}isReadOnlyMode(){return!!this.mosaicConfig()}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-config-project"]],decls:23,vars:20,consts:[["imageUploader",""],[1,"actions"],["mat-flat-button","",3,"click"],["mat-flat-button","","color","accent",3,"click","hidden"],[1,"form",3,"formGroup"],["hidden","","type","file","accept",".jpg, .png, .jpeg, .gif, .bmp, .tif, .tiff|image/*",3,"change"],["mat-flat-button","",3,"click","color","hidden"],["appearance","outline",1,"density-3"],["matInput","","type","number","formControlName","mosaicWidth"],["matTextSuffix",""]],template:function(t,o){if(t&1){let r=Q();h(0,"div",1)(1,"button",2),x("click",function(){return k(r),I(o.navigateToConfiguration())}),u(2),_(3,"translate"),m(),h(4,"button",3),x("click",function(){return k(r),I(o.trySave())}),u(5),_(6,"translate"),m()(),h(7,"form",4)(8,"input",5,0),x("change",function(a){return k(r),I(o.onImageSelected(a))}),m(),h(10,"button",6),x("click",function(){k(r);let a=_e(9);return I(a.click())}),u(11),_(12,"translate"),m(),h(13,"mat-form-field",7)(14,"mat-label"),u(15),_(16,"translate"),m(),w(17,"input",8),h(18,"span",9),u(19),_(20,"translate"),m(),h(21,"mat-error"),u(22),m()()()}t&2&&(c(2),E(" ",b(3,10,"common.return")," "),c(2),y("hidden",o.isReadOnlyMode()),c(),E(" ",b(6,12,"common.confirm")," "),c(2),y("formGroup",o.projectForm),c(3),y("color",o.projectForm.controls.mosaicImage.valid?"":"accent")("hidden",o.isReadOnlyMode()),c(),E(" ",b(12,14,o.projectForm.controls.mosaicImage.valid?"tool.config.project.changeImage":"tool.config.project.chooseImage")," "),c(4),v(b(16,16,"tool.config.project.mosaicWidth")),c(4),v(b(20,18,"common.cm")),c(3),v(o.getErrorLabel(o.projectForm.controls.mosaicWidth)))},dependencies:[K,V,se,We,ze,Oe,Oi,Ti,ot,it,ii,Jt,Ct,fo,Xe,Xt,St,ei,ee],styles:[".actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1 1 0}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;margin-top:20px}"],changeDetection:0})}}return n})();var mi=class extends wt{constructor(i,e){super(),this.vertices=i,this.hexColor=e}drawObject(i,e){i.beginPath();let t=e.getViewportPosition(this.vertices[0]);i.moveTo(t.x,t.y);for(let o=1;o<this.vertices.length;++o)t=e.getViewportPosition(this.vertices[o]),i.lineTo(t.x,t.y);i.closePath(),i.fillStyle=this.hexColor,i.fill()}getOrder(){return 100}};var Rl=Math.PI/180;function Al(n,i,e){e*=Rl;let t=Math.cos(e)*(n.x-i.x)-Math.sin(e)*(n.y-i.y)+i.x,o=Math.sin(e)*(n.x-i.x)+Math.cos(e)*(n.y-i.y)+i.y;return new j(t,o)}function yo(n,i,e=0,t=1){return n.map(o=>Al(o,j.zero,e).multiply(t).add(i))}var Es=(()=>{class n{static drawTiles(e,t){let o=this.sortAndMapTilesBySize(e),r=this.getTreeMapChartArray(o),s={width:r.size.width,height:r.size.height,x:-r.size.width/2,y:-r.size.height/2};this.drawChart(r,s,t)}static drawChart(e,t,o){if(e.type==="group"){let r=e.left.size.width+e.right.size.width,s=e.left.size.height+e.right.size.height;this.drawChart(e.left,{x:t.x,y:t.y,width:t.width*(e.split==="horizontal"?e.left.size.width/r:1),height:t.height*(e.split==="horizontal"?1:e.left.size.height/s)},o),this.drawChart(e.right,{x:t.x+(e.split==="horizontal"?t.width*(e.left.size.width/r):0),y:t.y+(e.split==="horizontal"?0:t.height*(e.left.size.height/s)),width:t.width*(e.split==="horizontal"?e.right.size.width/r:1),height:t.height*(e.split==="horizontal"?1:e.right.size.height/s)},o)}else{let r=yo(e.value.vertices,new j(t.x+t.width/2,t.y+t.height/2),0),s=new mi(r,e.value.color);o.addCanvasObject(s)}}static getTreeMapChartArray(e){if(e.length>1){let t=this.splitTileArrayInHalf(e),o=this.getTreeMapChartArray(t[0]),r=this.getTreeMapChartArray(t[1]),s=(o.size.height+r.size.height)*1.5<o.size.width+r.size.width?"vertical":"horizontal";return{type:"group",split:s,size:{width:s==="horizontal"?o.size.width+r.size.width:Math.max(o.size.width,r.size.width),height:s==="horizontal"?Math.max(o.size.height,r.size.height):o.size.height+r.size.height},left:o,right:r}}else return{type:"leaf",size:this.getTileSize(e[0].tile),value:e[0].tile}}static sortAndMapTilesBySize(e){return e.map(t=>{let o=this.getTileSize(t),r=o.height*o.height+o.width*o.width;return{tile:t,size:o,radius:r}}).sort((t,o)=>o.radius-t.radius)}static splitTileArrayInHalf(e){let o=e.reduce((a,d)=>a+d.size.width,0)/2,r=e.length-1,s=e[r].size.width;for(let a=e.length-2;a>0;a--){let d=e[a];if(s+=d.size.width,s>o){r=a;break}}return[e.slice(0,r),e.slice(r)]}static getTileSize(e){return{width:Math.max(...e.vertices.map(t=>t.x))-Math.min(...e.vertices.map(t=>t.x)),height:Math.max(...e.vertices.map(t=>t.y))-Math.min(...e.vertices.map(t=>t.y))}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();var Ds=(()=>{class n{constructor(){this.store=l(N),this.destroyRef=l(G),this.toolService=l(Ee),this.tilesSets$=this.store.select(et)}ngAfterViewInit(){queueMicrotask(()=>this.subscribeOnTilesSetsChange())}subscribeOnTilesSetsChange(){this.tilesSets$.pipe(H(this.destroyRef)).subscribe(e=>this.drawTiles(e.flatMap(t=>t.tiles)))}sectionEntered(e){return this.activeCanvas=e,{ribbon:[{iconName:"crop",visibility:O("on"),onClick:()=>this.toolService.openTakeSnapshotDialog(this.activeCanvas,"sectors_snapshot.png")}]}}drawTiles(e){this.activeCanvas.removeObjects(),e.length&&Es.drawTiles(e,this.activeCanvas),this.activeCanvas.redraw()}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-tray"]],decls:1,vars:0,template:function(t,o){t&1&&w(0,"router-outlet")},dependencies:[Qt],styles:["[_nghost-%COMP%]{display:block;box-sizing:border-box;height:100%;padding:20px 10px;overflow-y:auto;overflow-x:hidden}"],changeDetection:0})}}return n})();var xo="/tool";var Co=()=>l(N).selectSignal(Ur)()?!0:(l(X).navigate([xo]),!1);var Ll=["text"],Nl=[[["mat-icon"]],"*"],jl=["mat-icon","*"];function Vl(n,i){if(n&1&&w(0,"mat-pseudo-checkbox",1),n&2){let e=M();y("disabled",e.disabled)("state",e.selected?"checked":"unchecked")}}function Bl(n,i){if(n&1&&w(0,"mat-pseudo-checkbox",3),n&2){let e=M();y("disabled",e.disabled)}}function zl(n,i){if(n&1&&(h(0,"span",4),u(1),m()),n&2){let e=M();c(),E("(",e.group.label,")")}}var xn=new U("MAT_OPTION_PARENT_COMPONENT"),Cn=new U("MatOptgroup");var Fi=class{source;isUserInput;constructor(i,e=!1){this.source=i,this.isUserInput=e}},hi=(()=>{class n{_element=l(oe);_changeDetectorRef=l(Me);_parent=l(xn,{optional:!0});group=l(Cn,{optional:!0});_signalDisableRipple=!1;_selected=!1;_active=!1;_mostRecentViewValue="";get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}value;id=l(Pe).getId("mat-option-");get disabled(){return this.group&&this.group.disabled||this._disabled()}set disabled(e){this._disabled.set(e)}_disabled=O(!1);get disableRipple(){return this._signalDisableRipple?this._parent.disableRipple():!!this._parent?.disableRipple}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}onSelectionChange=new ae;_text;_stateChanges=new S;constructor(){let e=l(Kt);e.load(Rr),e.load(gr),this._signalDisableRipple=!!this._parent&&Ji(this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(e=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}deselect(e=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}focus(e,t){let o=this._getHostElement();typeof o.focus=="function"&&o.focus(t)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(e.keyCode===13||e.keyCode===32)&&!Zt(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=e)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new Fi(this,e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["mat-option"]],viewQuery:function(t,o){if(t&1&&he(Ll,7),t&2){let r;W(r=q())&&(o._text=r.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(t,o){t&1&&x("click",function(){return o._selectViaInteraction()})("keydown",function(s){return o._handleKeydown(s)}),t&2&&(dt("id",o.id),Ce("aria-selected",o.selected)("aria-disabled",o.disabled.toString()),F("mdc-list-item--selected",o.selected)("mat-mdc-option-multiple",o.multiple)("mat-mdc-option-active",o.active)("mdc-list-item--disabled",o.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",pe]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:jl,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(t,o){t&1&&(Ue(Nl),R(0,Vl,1,2,"mat-pseudo-checkbox",1),re(1),h(2,"span",2,0),re(4,1),m(),R(5,Bl,1,1,"mat-pseudo-checkbox",3),R(6,zl,2,1,"span",4),w(7,"div",5)),t&2&&(A(o.multiple?0:-1),c(5),A(!o.multiple&&o.selected&&!o.hideSingleSelectionIndicator?5:-1),c(),A(o.group&&o.group._inert?6:-1),c(),y("matRippleTrigger",o._getHostElement())("matRippleDisabled",o.disabled||o.disableRipple))},dependencies:[jr,Ir],styles:[`.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-active,.mat-mdc-option-multiple,:focus,:hover){background-color:var(--mat-option-selected-state-layer-color, var(--mat-sys-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-active,.mat-mdc-option-multiple,:focus,:hover) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-pseudo-checkbox-minimal-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}@media(forced-colors: active){.mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{right:auto;left:16px}}.mat-mdc-option-multiple{--mat-list-list-item-selected-container-color: var(--mat-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-focus-indicator::before{content:""}
`],encapsulation:2,changeDetection:0})}return n})();function Os(n,i,e){if(e.length){let t=i.toArray(),o=e.toArray(),r=0;for(let s=0;s<n+1;s++)t[s].group&&t[s].group===o[r]&&r++;return r}return 0}function Ts(n,i,e,t){return n<e?n:n+i>e+t?Math.max(0,n-t+i):e}var Sn=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=Fe({type:n});static \u0275inj=Ae({imports:[Br,Vr,hi,yt]})}return n})();var Ul=["panel"],Wl=["*"];function ql(n,i){if(n&1&&(lt(0,"div",1,0),re(2),ct()),n&2){let e=i.id,t=M();or(t._classList),F("mat-mdc-autocomplete-visible",t.showPanel)("mat-mdc-autocomplete-hidden",!t.showPanel)("mat-autocomplete-panel-animations-enabled",!t._animationsDisabled)("mat-primary",t._color==="primary")("mat-accent",t._color==="accent")("mat-warn",t._color==="warn"),dt("id",t.id),Ce("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby(e))}}var wn=class{source;option;constructor(i,e){this.source=i,this.option=e}},Rs=new U("mat-autocomplete-default-options",{providedIn:"root",factory:()=>({autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1,hasBackdrop:!1})}),As=(()=>{class n{_changeDetectorRef=l(Me);_elementRef=l(oe);_defaults=l(Rs);_animationsDisabled=xt();_activeOptionChanges=Re.EMPTY;_keyManager;showPanel=!1;get isOpen(){return this._isOpen&&this.showPanel}_isOpen=!1;_latestOpeningTrigger;_setColor(e){this._color=e,this._changeDetectorRef.markForCheck()}_color;template;panel;options;optionGroups;ariaLabel;ariaLabelledby;displayWith=null;autoActiveFirstOption;autoSelectActiveOption;requireSelection;panelWidth;disableRipple;optionSelected=new ae;opened=new ae;closed=new ae;optionActivated=new ae;set classList(e){this._classList=e,this._elementRef.nativeElement.className=""}_classList;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncParentProperties()}_hideSingleSelectionIndicator;_syncParentProperties(){if(this.options)for(let e of this.options)e._changeDetectorRef.markForCheck()}id=l(Pe).getId("mat-autocomplete-");inertGroups;constructor(){let e=l(Ye);this.inertGroups=e?.SAFARI||!1,this.autoActiveFirstOption=!!this._defaults.autoActiveFirstOption,this.autoSelectActiveOption=!!this._defaults.autoSelectActiveOption,this.requireSelection=!!this._defaults.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new Cr(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options?.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){let t=new wn(this,e);this.optionSelected.emit(t)}_getPanelAriaLabelledby(e){if(this.ariaLabel)return null;let t=e?e+" ":"";return this.ariaLabelledby?t+this.ariaLabelledby:e}_skipPredicate(){return!1}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["mat-autocomplete"]],contentQueries:function(t,o,r){if(t&1&&(mt(r,hi,5),mt(r,Cn,5)),t&2){let s;W(s=q())&&(o.options=s),W(s=q())&&(o.optionGroups=s)}},viewQuery:function(t,o){if(t&1&&(he(Ci,7),he(Ul,5)),t&2){let r;W(r=q())&&(o.template=r.first),W(r=q())&&(o.panel=r.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[2,"autoActiveFirstOption","autoActiveFirstOption",pe],autoSelectActiveOption:[2,"autoSelectActiveOption","autoSelectActiveOption",pe],requireSelection:[2,"requireSelection","requireSelection",pe],panelWidth:"panelWidth",disableRipple:[2,"disableRipple","disableRipple",pe],classList:[0,"class","classList"],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",pe]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],features:[ce([{provide:xn,useExisting:n}])],ngContentSelectors:Wl,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(t,o){t&1&&(Ue(),tr(0,ql,3,17,"ng-template"))},styles:[`div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:relative;border-radius:var(--mat-autocomplete-container-shape, var(--mat-sys-corner-extra-small));box-shadow:var(--mat-autocomplete-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));background-color:var(--mat-autocomplete-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-autocomplete-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden,.cdk-overlay-pane:has(>.mat-mdc-autocomplete-hidden){visibility:hidden;pointer-events:none}@keyframes _mat-autocomplete-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}.mat-autocomplete-panel-animations-enabled{animation:_mat-autocomplete-enter 120ms cubic-bezier(0, 0, 0.2, 1)}mat-autocomplete{display:none}
`],encapsulation:2,changeDetection:0})}return n})();var Gl={provide:po,useExisting:Yi(()=>Mn),multi:!0};var Ql=new U("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let n=l(Ke);return()=>Mr(n)}}),Mn=(()=>{class n{_environmentInjector=l(Jn);_element=l(oe);_injector=l(Ke);_viewContainerRef=l(Xi);_zone=l(le);_changeDetectorRef=l(Me);_dir=l(Rt,{optional:!0});_formField=l(ki,{optional:!0,host:!0});_viewportRuler=l(ao);_scrollStrategy=l(Ql);_renderer=l(Tt);_animationsDisabled=xt();_defaults=l(Rs,{optional:!0});_overlayRef;_portal;_componentDestroyed=!1;_initialized=new S;_keydownSubscription;_outsideClickSubscription;_cleanupWindowBlur;_previousValue;_valueOnAttach;_valueOnLastKeydown;_positionStrategy;_manuallyFloatingLabel=!1;_closingActionsSubscription;_viewportSubscription=Re.EMPTY;_breakpointObserver=l(ro);_handsetLandscapeSubscription=Re.EMPTY;_canOpenOnNextFocus=!0;_valueBeforeAutoSelection;_pendingAutoselectedOption;_closeKeyEventStream=new S;_overlayPanelClass=no(this._defaults?.overlayPanelClass||[]);_windowBlurHandler=()=>{this._canOpenOnNextFocus=this.panelOpen||!this._hasFocus()};_onChange=()=>{};_onTouched=()=>{};autocomplete;position="auto";connectedTo;autocompleteAttribute="off";autocompleteDisabled;constructor(){}_aboveClass="mat-mdc-autocomplete-panel-above";ngAfterViewInit(){this._initialized.next(),this._initialized.complete(),this._cleanupWindowBlur=this._renderer.listen("window","blur",this._windowBlurHandler)}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){this._cleanupWindowBlur?.(),this._handsetLandscapeSubscription.unsubscribe(),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}_overlayAttached=!1;openPanel(){this._openPanelInternal()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._latestOpeningTrigger===this&&(this.autocomplete._isOpen=!1,this.autocomplete._latestOpeningTrigger=null),this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal&&so(this._trackedModal,"aria-owns",this.autocomplete.id))}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return Qe(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(Et(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(Et(()=>this._overlayAttached)):xi()).pipe(Vt(e=>e instanceof Fi?e:null))}optionSelections=qn(()=>{let e=this.autocomplete?this.autocomplete.options:null;return e?e.changes.pipe(Dt(e),Bt(()=>Qe(...e.map(t=>t.onSelectionChange)))):this._initialized.pipe(Bt(()=>this.optionSelections))});get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return new _t(e=>{let t=r=>{let s=At(r),a=this._formField?this._formField.getConnectedOverlayOrigin().nativeElement:null,d=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;this._overlayAttached&&s!==this._element.nativeElement&&!this._hasFocus()&&(!a||!a.contains(s))&&(!d||!d.contains(s))&&this._overlayRef&&!this._overlayRef.overlayElement.contains(s)&&e.next(r)},o=[this._renderer.listen("document","click",t),this._renderer.listen("document","auxclick",t),this._renderer.listen("document","touchend",t)];return()=>{o.forEach(r=>r())}})}writeValue(e){Promise.resolve(null).then(()=>this._assignOptionValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e}_handleKeydown(e){let t=e,o=t.keyCode,r=Zt(t);if(o===27&&!r&&t.preventDefault(),this._valueOnLastKeydown=this._element.nativeElement.value,this.activeOption&&o===13&&this.panelOpen&&!r)this.activeOption._selectViaInteraction(),this._resetActiveItem(),t.preventDefault();else if(this.autocomplete){let s=this.autocomplete._keyManager.activeItem,a=o===38||o===40;o===9||a&&!r&&this.panelOpen?this.autocomplete._keyManager.onKeydown(t):a&&this._canOpen()&&this._openPanelInternal(this._valueOnLastKeydown),(a||this.autocomplete._keyManager.activeItem!==s)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._valueOnLastKeydown),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(e){let t=e.target,o=t.value;if(t.type==="number"&&(o=o==""?null:parseFloat(o)),this._previousValue!==o){if(this._previousValue=o,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(o),!o)this._clearPreviousSelectedOption(null,!1);else if(this.panelOpen&&!this.autocomplete.requireSelection){let r=this.autocomplete.options?.find(s=>s.selected);if(r){let s=this._getDisplayValue(r.value);o!==s&&r.deselect(!1)}}if(this._canOpen()&&this._hasFocus()){let r=this._valueOnLastKeydown??this._element.nativeElement.value;this._valueOnLastKeydown=null,this._openPanelInternal(r)}}}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(this._previousValue),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this._openPanelInternal()}_hasFocus(){return vr()===this._element.nativeElement}_floatLabel(e=!1){this._formField&&this._formField.floatLabel==="auto"&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){let e=new _t(o=>{Ot(()=>{o.next()},{injector:this._environmentInjector})}),t=this.autocomplete.options?.changes.pipe(zt(()=>this._positionStrategy.reapplyLastPosition()),Qn(0))??xi();return Qe(e,t).pipe(Bt(()=>this._zone.run(()=>{let o=this.panelOpen;return this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),o!==this.panelOpen&&(this.panelOpen?this._emitOpened():this.autocomplete.closed.emit()),this.panelClosingActions})),Zi(1)).subscribe(o=>this._setValueAndClose(o))}_emitOpened(){this.autocomplete.opened.emit()}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_getDisplayValue(e){let t=this.autocomplete;return t&&t.displayWith?t.displayWith(e):e}_assignOptionValue(e){let t=this._getDisplayValue(e);e==null&&this._clearPreviousSelectedOption(null,!1),this._updateNativeInputValue(t??"")}_updateNativeInputValue(e){this._formField?this._formField._control.value=e:this._element.nativeElement.value=e,this._previousValue=e}_setValueAndClose(e){let t=this.autocomplete,o=e?e.source:this._pendingAutoselectedOption;o?(this._clearPreviousSelectedOption(o),this._assignOptionValue(o.value),this._onChange(o.value),t._emitSelectEvent(o),this._element.nativeElement.focus()):t.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(e,t){this.autocomplete?.options?.forEach(o=>{o!==e&&o.selected&&o.deselect(t)})}_openPanelInternal(e=this._element.nativeElement.value){if(this._attachOverlay(e),this._floatLabel(),this._trackedModal){let t=this.autocomplete.id;an(this._trackedModal,"aria-owns",t)}}_attachOverlay(e){if(!this.autocomplete)return;let t=this._overlayRef;t?(this._positionStrategy.setOrigin(this._getConnectedElement()),t.updateSize({width:this._getPanelWidth()})):(this._portal=new co(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),t=ho(this._injector,this._getOverlayConfig()),this._overlayRef=t,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&t&&t.updateSize({width:this._getPanelWidth()})}),this._handsetLandscapeSubscription=this._breakpointObserver.observe(lo.HandsetLandscape).subscribe(r=>{r.matches?this._positionStrategy.withFlexibleDimensions(!0).withGrowAfterOpen(!0).withViewportMargin(8):this._positionStrategy.withFlexibleDimensions(!1).withGrowAfterOpen(!1).withViewportMargin(0)})),t&&!t.hasAttached()&&(t.attach(this._portal),this._valueOnAttach=e,this._valueOnLastKeydown=null,this._closingActionsSubscription=this._subscribeToClosingActions());let o=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._latestOpeningTrigger=this,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this.panelOpen&&o!==this.panelOpen&&this._emitOpened()}_handlePanelKeydown=e=>{(e.keyCode===27&&!Zt(e)||e.keyCode===38&&Zt(e,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),e.stopPropagation(),e.preventDefault())};_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){let e=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=e.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=e.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new mo({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,hasBackdrop:this._defaults?.hasBackdrop,backdropClass:this._defaults?.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:this._overlayPanelClass,disableAnimations:this._animationsDisabled})}_getOverlayPosition(){let e=Pr(this._injector,this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1).withPopoverLocation("inline");return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){let t=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],o=this._aboveClass,r=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:o},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:o}],s;this.position==="above"?s=r:this.position==="below"?s=t:s=[...t,...r],e.withPositions(s)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){let e=this.autocomplete;if(e.autoActiveFirstOption){let t=-1;for(let o=0;o<e.options.length;o++)if(!e.options.get(o).disabled){t=o;break}e._keyManager.setActiveItem(t)}else e._keyManager.setActiveItem(-1)}_canOpen(){let e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this.autocompleteDisabled}_scrollToOption(e){let t=this.autocomplete,o=Os(e,t.options,t.optionGroups);if(e===0&&o===1)t._setScrollTop(0);else if(t.panel){let r=t.options.toArray()[e];if(r){let s=r._getHostElement(),a=Ts(s.offsetTop,s.offsetHeight,t._getScrollTop(),t.panel.nativeElement.offsetHeight);t._setScrollTop(a)}}}_trackedModal=null;_applyModalPanelOwnership(){let e=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;let t=this.autocomplete.id;this._trackedModal&&so(this._trackedModal,"aria-owns",t),an(e,"aria-owns",t),this._trackedModal=e}_clearFromModal(){if(this._trackedModal){let e=this.autocomplete.id;so(this._trackedModal,"aria-owns",e),this._trackedModal=null}}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(t,o){t&1&&x("focusin",function(){return o._handleFocus()})("blur",function(){return o._onTouched()})("input",function(s){return o._handleInput(s)})("keydown",function(s){return o._handleKeydown(s)})("click",function(){return o._handleClick()}),t&2&&Ce("autocomplete",o.autocompleteAttribute)("role",o.autocompleteDisabled?null:"combobox")("aria-autocomplete",o.autocompleteDisabled?null:"list")("aria-activedescendant",o.panelOpen&&o.activeOption?o.activeOption.id:null)("aria-expanded",o.autocompleteDisabled?null:o.panelOpen.toString())("aria-controls",o.autocompleteDisabled||!o.panelOpen||o.autocomplete==null?null:o.autocomplete.id)("aria-haspopup",o.autocompleteDisabled?null:"listbox")},inputs:{autocomplete:[0,"matAutocomplete","autocomplete"],position:[0,"matAutocompletePosition","position"],connectedTo:[0,"matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:[0,"autocomplete","autocompleteAttribute"],autocompleteDisabled:[2,"matAutocompleteDisabled","autocompleteDisabled",pe]},exportAs:["matAutocompleteTrigger"],features:[ce([Gl]),Ut]})}return n})(),Fs=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=Fe({type:n});static \u0275inj=Ae({imports:[Ei,Sn,cn,Sn,yt]})}return n})();var Li=class{static calculateConvexityFactor(i){let e=this.calculatePolygonArea(i),t=this.calculatePolygonCircumference(i);return Math.sqrt(e)/t}static calculatePolygonArea(i){if(i.length<3)throw new Error("polygon should have at least 3 vertices");let e=i.at(-1).x*i[0].y,t=i.at(-1).y*i[0].x;for(let o=0,r=i.length-1;o<r;++o)e+=i[o].x*i[o+1].y,t+=i[o].y*i[o+1].x;return(e-t)/2}static calculatePolygonCircumference(i){let e=j.distance(i[0],i.at(-1));for(let t=1;t<i.length;++t)e+=j.distance(i[t],i[t-1]);return e}static calculatePolygonCentroid(i){let e=0,t=0,o=0,r=i.at(-1);for(let s of i){let a=s.y*r.x-s.x*r.y;o+=a,e+=(s.x+r.x)*a,t+=(s.y+r.y)*a,r=s}return o*=3,o==0?j.zero:new j(e/o,t/o)}static calculateOuterRadius(i){let e=0;for(let t of i){let o=j.distance(j.zero,t);o>e&&(e=o)}return e}};var ut=class{static nextInt(i,e){return Math.floor(Math.random()*(e-i+1)+i)}static nextFloat(i,e){return Math.random()*(e-i)+i}};var So=class{constructor(i){this.imagePixelArray=i}generateTileSet(i,e){let t=[];for(let o=0;o<e;++o)t.push(this.generateTile(i));return t}generateTile(i){let e;do e=this.generateVertices(i);while(Li.calculateConvexityFactor([...e].reverse())<.18);let t=this.rotatePolygonToHorizontal(e),o=Li.calculatePolygonCentroid(t),r=this.normalizeVertices(t,o);return{id:crypto.randomUUID(),vertices:r,color:this.randomColor().hex()}}generateVertices(i){let e=ut.nextInt(4,6),t=[];for(let o=0;o<e;++o){let r=ut.nextFloat(i.min,i.max);t.push(this.generateVertex(o,e,r))}return t}generateVertex(i,e,t){let r=(360/e*i+ut.nextFloat(0,30))%360*Math.PI/180;return new j(Math.sin(r),Math.cos(r)).multiply(t)}randomColor(){let i=this.imagePixelArray.length/4,e=ut.nextInt(0,i-1);return ge({r:this.imagePixelArray[e*4],g:this.imagePixelArray[e*4+1],b:this.imagePixelArray[e*4+2]})}normalizeVertices(i,e){return i.map(t=>this.roundVertexCoords(t.sub(e)))}roundVertexCoords(i){return new j(Math.round((i.x+Number.EPSILON)*100)/100,Math.round((i.y+Number.EPSILON)*100)/100)}rotatePolygonToHorizontal(i){let e=0,t=i[0],o=i[1];for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++){let d=i[a].x-i[s].x,f=i[a].y-i[s].y,g=d*d+f*f;g>e&&(e=g,t=i[s],o=i[a])}let r=Math.atan2(o.y-t.y,o.x-t.x);return i.map(s=>{let a=s.x-t.x,d=s.y-t.y,f=a*Math.cos(-r)-d*Math.sin(-r),g=a*Math.sin(-r)+d*Math.cos(-r);return new j(f+t.x,g+t.y)})}};function Zl(n,i){if(n&1&&(h(0,"mat-option",7),u(1),m()),n&2){let e=i.$implicit;y("value",e),c(),v(e)}}var Ls=(()=>{class n{constructor(){this.router=l(X),this.store=l(N),this.snackBar=l(nt),this.translate=l(J),this.tilesSetsSignal=this.store.selectSignal(et),this.seriesNamesSignal=de(()=>this.tilesSetsSignal().map(e=>e.name)),this.errorLabels={min:()=>this.translate.instant("tool.tiles.random.radiusTooSmall"),max:()=>this.translate.instant("tool.tiles.random.radiusTooLarge"),required:()=>this.translate.instant("tool.tiles.random.fieldRequired"),minGreaterThenMax:()=>this.translate.instant("tool.tiles.random.maxRadiusLargerThanMin")},this.formData=O({name:"",minRadius:null,maxRadius:null,count:null}),this.form=Xr(this.formData,e=>{Di(e.name),Di(e.minRadius),un(e.minRadius,.01),pn(e.minRadius,1e3),Di(e.maxRadius),un(e.maxRadius,.01),pn(e.maxRadius,1e3),es(e.maxRadius,({value:t,valueOf:o})=>t()<o(e.minRadius)?Jr({kind:"minGreaterThenMax"}):null),Di(e.count,{message:this.translate.instant("tool.tiles.random.fieldRequired")})})}getFieldErrorLabel(e){return di.getFieldErrorLabel(e,this.errorLabels)}async getTileSet(){if(this.form().valid()){let e=this.formData(),t=new So(await this.getImagePixelArray()),o={name:e.name,source:"generated",tiles:t.generateTileSet({min:e.minRadius,max:e.maxRadius},e.count),minRadius:e.minRadius,maxRadius:e.maxRadius};this.snackBar.open(this.translate.instant("tool.tiles.random.tilesSeriesGenerated"),this.translate.instant("common.ok"),{duration:3e3}),this.store.dispatch(ve.tilesSetAdded({tilesSet:o})),this.navigateToMenu()}}async getImagePixelArray(){let e=this.store.selectSignal($r)();return Wr.getImageSrcPixelArray(e)}navigateToMenu(){this.router.navigate(["/tool/tray"])}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-random-tiles"]],decls:46,vars:37,consts:[["auto","matAutocomplete"],[1,"actions"],["mat-flat-button","",3,"click"],["mat-flat-button","","color","accent",3,"click"],[1,"form"],["appearance","outline","subscriptSizing","dynamic",1,"density-3"],["matInput","","type","text",3,"field","matAutocomplete"],[3,"value"],["matInput","","type","number",3,"field"],["matTextSuffix",""]],template:function(t,o){if(t&1){let r=Q();h(0,"div",1)(1,"button",2),x("click",function(){return k(r),I(o.navigateToMenu())}),u(2),_(3,"translate"),m(),h(4,"button",3),x("click",function(){return k(r),I(o.getTileSet())}),u(5),_(6,"translate"),m()(),h(7,"form",4)(8,"mat-form-field",5)(9,"mat-label"),u(10),_(11,"translate"),m(),w(12,"input",6),wi(),h(13,"mat-autocomplete",null,0),Se(15,Zl,2,2,"mat-option",7,Wt),m(),h(17,"mat-error"),u(18),m()(),h(19,"mat-form-field",5)(20,"mat-label"),u(21),_(22,"translate"),m(),w(23,"input",8),wi(),h(24,"span",9),u(25),_(26,"translate"),m(),h(27,"mat-error"),u(28),m()(),h(29,"mat-form-field",5)(30,"mat-label"),u(31),_(32,"translate"),m(),w(33,"input",8),wi(),h(34,"span",9),u(35),_(36,"translate"),m(),h(37,"mat-error"),u(38),m()(),h(39,"mat-form-field",5)(40,"mat-label"),u(41),_(42,"translate"),m(),w(43,"input",8),wi(),h(44,"mat-error"),u(45),m()()()}if(t&2){let r=_e(14);c(2),E(" ",b(3,21,"common.return")," "),c(3),E(" ",b(6,23,"tool.tiles.random.randomTiles")," "),c(5),v(b(11,25,"tool.tiles.random.seriesName")),c(2),Mi(o.form.name),y("matAutocomplete",r),c(3),we(o.seriesNamesSignal()),c(3),v(o.getFieldErrorLabel(o.form.name())),c(3),v(b(22,27,"tool.tiles.random.minRadius")),c(2),Mi(o.form.minRadius),c(2),v(b(26,29,"common.cm")),c(3),v(o.getFieldErrorLabel(o.form.minRadius())),c(3),v(b(32,31,"tool.tiles.random.maxRadius")),c(2),Mi(o.form.maxRadius),c(2),v(b(36,33,"common.cm")),c(3),v(o.getFieldErrorLabel(o.form.maxRadius())),c(3),v(b(42,35,"tool.tiles.random.count")),c(2),Mi(o.form.count),c(2),v(o.getFieldErrorLabel(o.form.count()))}},dependencies:[We,ze,Oe,Oi,Ti,ot,it,K,V,se,Fs,As,hi,Mn,ts,ee],styles:["[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1 1 0}[_nghost-%COMP%]   .form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:20px;gap:18px}"],changeDetection:0})}}return n})();var Yl=["*"],pi=(()=>{class n{constructor(){this.isOpen=me.required(),this.elementRef=l(oe)}getExpandDuration(){let e=this.elementRef.nativeElement.scrollHeight,t=150+Math.sqrt(e)*5;return this.isOpen()?t:t*.66}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-expandable-panel"]],hostVars:6,hostBindings:function(t,o){t&2&&(Ze("--expand-duration",o.getExpandDuration()+"ms")("--panel-height",o.elementRef.nativeElement.scrollHeight+"px"),F("open",o.isOpen()))},inputs:{isOpen:[1,"isOpen"]},ngContentSelectors:Yl,decls:1,vars:0,template:function(t,o){t&1&&(Ue(),re(0))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden;max-height:0;transition:max-height var(--expand-duration, .3s) ease-out}.open[_nghost-%COMP%]{max-height:var(--panel-height, 1000px)}"],changeDetection:0})}}return n})();var js=(()=>{class n{constructor(){this.tile=me.required(),this.router=l(X)}navigateToTileDetails(){this.router.navigate([`/tool/tray/tile/${this.tile().id}`])}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-tile-list-elem"]],inputs:{tile:[1,"tile"]},decls:13,vars:5,consts:[["menu","matMenu"],[1,"label"],[1,"elem-actions"],["mat-icon-button","",1,"elem-action",3,"matMenuTriggerFor"],["matListIcon",""],["classList","paddingless"],["mat-menu-item","",3,"click"],["matListIcon","",1,"material-symbols-outlined"]],template:function(t,o){if(t&1){let r=Q();h(0,"span",1),u(1),m(),h(2,"div",2)(3,"button",3)(4,"mat-icon",4),u(5," more_vert "),m()(),h(6,"mat-menu",5,0)(8,"button",6),x("click",function(){return k(r),I(o.navigateToTileDetails())}),h(9,"mat-icon",7),u(10," page_info "),m(),u(11),_(12,"translate"),m()()()}if(t&2){let r=_e(7);c(),E(" ",o.tile().id,`
`),c(2),y("matMenuTriggerFor",r),c(8),E(" ",b(12,3,"common.details")," ")}},dependencies:[Ne,Le,V,Ve,ai,ri,ni,si,K,ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}.selected[_nghost-%COMP%]{background:var(--irr-contrast-light)}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap}[_nghost-%COMP%]   .elem-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:12px;margin-left:4px}[_nghost-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]     .mat-icon{width:24px;height:24px;font-size:24px}[_nghost-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]    {--mat-icon-button-state-layer-size: 32px;padding:4px}[_nghost-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]     .mat-mdc-button-touch-target{width:var(--mat-icon-button-state-layer-size);height:var(--mat-icon-button-state-layer-size)}[_nghost-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]{color:var(--irr-contrast-medium);margin:-6px}"],changeDetection:0})}}return n})();function Xl(n,i){if(n&1&&w(0,"app-tile-list-elem",11),n&2){let e=i.$implicit;y("tile",e)}}var Vs=(()=>{class n{constructor(){this.tilesSet=me.required(),this.isOpen=O(!1),this.store=l(N),this.dialog=l(oi),this.translate=l(J),this.destroyRef=l(G)}toggleTilesList(){this.isOpen.update(e=>!e)}removeTilesSet(){this.showRemoveTilesSetWarning().pipe(H(this.destroyRef)).subscribe(e=>{e&&this.store.dispatch(ve.tilesSetRemoved({removedTilesSet:this.tilesSet()}))})}showRemoveTilesSetWarning(){let e={title:this.translate.instant("tool.tiles.menu.removeTilesSet"),message:this.translate.instant("tool.tiles.menu.removeTilesSetQuery",{name:this.tilesSet().name})};return this.dialog.open(li,{data:e}).afterClosed()}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-tiles-set-list-elem"]],inputs:{tilesSet:[1,"tilesSet"]},decls:20,vars:8,consts:[["menu","matMenu"],[1,"list-elem"],[1,"elem-actions"],["mat-icon-button","",1,"elem-action",3,"matMenuTriggerFor"],["matListIcon",""],["mat-icon-button","",1,"elem-action","toggle-action",3,"click"],[1,"chevron"],["classList","paddingless"],["mat-menu-item","",3,"click"],["matListIcon","",1,"material-symbols-outlined"],[1,"panel",3,"isOpen"],[3,"tile"]],template:function(t,o){if(t&1){let r=Q();h(0,"div",1)(1,"span"),u(2),m(),h(3,"div",2)(4,"button",3)(5,"mat-icon",4),u(6," more_vert "),m()(),h(7,"button",5),x("click",function(){return k(r),I(o.toggleTilesList())}),h(8,"mat-icon",6),u(9," keyboard_arrow_up "),m()(),h(10,"mat-menu",7,0)(12,"button",8),x("click",function(){return k(r),I(o.removeTilesSet())}),h(13,"mat-icon",9),u(14,"delete"),m(),u(15),_(16,"translate"),m()()()(),h(17,"app-expandable-panel",10),Se(18,Xl,1,1,"app-tile-list-elem",11,vt),m()}if(t&2){let r=_e(11);c(2),v(o.tilesSet().name),c(2),y("matMenuTriggerFor",r),c(4),F("chevron--closed",!o.isOpen()),c(7),E(" ",b(16,6,"tool.tiles.menu.removeTilesSet")," "),c(2),y("isOpen",o.isOpen()),c(),we(o.tilesSet().tiles.slice(0,100))}},dependencies:[pi,V,Ve,Ne,Le,ai,ri,ni,si,js,K,ee],styles:["[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}[_nghost-%COMP%]   .list-elem.selected[_ngcontent-%COMP%]{background:var(--irr-contrast-light)}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:12px}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]     .mat-icon{width:24px;height:24px;font-size:24px}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]    {--mat-icon-button-state-layer-size: 32px;padding:4px}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]     .mat-mdc-button-touch-target{width:var(--mat-icon-button-state-layer-size);height:var(--mat-icon-button-state-layer-size)}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .elem-action[_ngcontent-%COMP%]{color:var(--irr-contrast-medium);margin:-6px}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .toggle-action[_ngcontent-%COMP%]{color:var(--irr-contrast-medium)}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .toggle-action[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:all .25s ease}[_nghost-%COMP%]   .list-elem[_ngcontent-%COMP%]   .elem-actions[_ngcontent-%COMP%]   .toggle-action[_ngcontent-%COMP%]   .chevron--closed[_ngcontent-%COMP%]{transform:rotate(180deg)}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{overflow:hidden;display:flex;flex-direction:column;gap:6px}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-top:6px}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{align-self:center;color:#666}"],changeDetection:0})}}return n})();function Jl(n,i){if(n&1&&w(0,"app-tiles-set-list-elem",4),n&2){let e=i.$implicit;y("tilesSet",e)}}function ec(n,i){n&1&&(h(0,"span",5),u(1),_(2,"translate"),m()),n&2&&(c(),E(" ",b(2,1,"tool.tiles.menu.noTiles")," "))}var Bs=(()=>{class n{constructor(){this.router=l(X),this.store=l(N),this.tilesSets=this.store.selectSignal(et)}navigateToRandomTiles(){this.router.navigate(["/tool/tray/random"])}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-tray-menu"]],decls:14,vars:10,consts:[[1,"actions"],["mat-flat-button","","color","accent","disabled",""],["mat-flat-button","","color","accent",3,"click"],[1,"tiles-sets"],[3,"tilesSet"],[1,"no-sets"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"button",1),u(2),_(3,"translate"),m(),h(4,"button",1),u(5),_(6,"translate"),m(),h(7,"button",2),x("click",function(){return o.navigateToRandomTiles()}),u(8),_(9,"translate"),m()(),h(10,"div",3),Se(11,Jl,1,1,"app-tiles-set-list-elem",4,vt,!1,ec,3,3,"span",5),m()),t&2&&(c(2),E(" ",b(3,4,"tool.tiles.menu.loadFromFile")," "),c(3),E(" ",b(6,6,"tool.tiles.menu.createTile")," "),c(3),E(" ",b(9,8,"tool.tiles.menu.randomTiles")," "),c(3),we(o.tilesSets()))},dependencies:[V,se,Vs,K,ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:20px;height:100%}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}[_nghost-%COMP%]   .tiles-sets[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;flex:1 1 0}[_nghost-%COMP%]   .tiles-sets[_ngcontent-%COMP%]   .no-sets[_ngcontent-%COMP%]{color:var(--irr-contrast-light);margin:auto}"],changeDetection:0})}}return n})();var tc=["canvas"],zs=(()=>{class n{constructor(){this.value=Pi(),this.valueChange=qt(),this.canvas=pt.required("canvas"),this.cursorData=de(()=>{let e=this.value(),t=this.canvas()?.nativeElement.getBoundingClientRect().width??1;return this.computeCursorData(e,t)}),this.destroyRef=l(G),this.isDragging=!1,this.onMouseDown=e=>{this.isDragging=!0,document.body.style.cursor="pointer",this.onSliderMouseInteraction(e)},this.onMouseUp=()=>{this.isDragging=!1,document.body.style.cursor=""},this.onMouseMove=e=>{this.isDragging&&this.onSliderMouseInteraction(e)}}onSliderMouseInteraction(e){let t=this.canvas().nativeElement.getBoundingClientRect(),o=(e.clientX-t.x)/t.width;this.value.set(Math.max(0,Math.min(1,o))),this.valueChange.emit(this.value())}ngAfterViewInit(){this.drawSliderCanvas(),this.canvas().nativeElement.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),this.destroyRef.onDestroy(()=>{this.canvas().nativeElement.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove)})}drawSliderCanvas(){let e=this.canvas().nativeElement.getContext("2d"),t={height:this.canvas().nativeElement.height,width:this.canvas().nativeElement.width},o=e.createLinearGradient(0,0,t.width,0),r=20;for(let s=0;s<=r;++s){let a=s*(1/r);o.addColorStop(a,ge({h:a*360,s:100,v:100}).hex())}e.fillStyle=o,e.fillRect(0,0,t.width,t.height)}computeCursorData(e,t){let o=t*e-8,r=ge({h:e*360,s:100,v:100}).hex();return{horizontalOffset:`${o}px`,color:r}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-color-slider"]],viewQuery:function(t,o){t&1&&ht(o.canvas,tc,5),t&2&&It()},inputs:{value:[1,"value"]},outputs:{value:"valueChange",valueChange:"valueChange"},decls:3,vars:4,consts:[["canvas",""],["width","250","height","8",1,"slider"],[1,"cursor"]],template:function(t,o){if(t&1&&kt(0,"canvas",1,0)(2,"div",2),t&2){let r=o.cursorData();c(2),Ze("left",r.horizontalOffset)("background-color",r.color)}},styles:["[_nghost-%COMP%]{width:100%;position:relative;cursor:pointer}[_nghost-%COMP%]   .slider[_ngcontent-%COMP%]{display:block;width:100%;height:8px;border-radius:5px}[_nghost-%COMP%]   .cursor[_ngcontent-%COMP%]{position:absolute;width:18px;height:18px;border-radius:50%;border:2px solid #ffffff;box-sizing:border-box;top:-5px;pointer-events:none}"],changeDetection:0})}}return n})();var ic=["canvas"],Hs=(()=>{class n{constructor(){this.hValue=me(),this.sValue=Pi(),this.vValue=Pi(),this.colorChange=qt(),this.canvas=pt.required("canvas"),this.cursorData=de(()=>this.computeCursorData()),this.destroyRef=l(G),this.isDragging=!1,this.onMouseDown=e=>{this.isDragging=!0,document.body.style.cursor="pointer",this.onCanvasMouseInteraction(e)},this.onMouseUp=()=>{this.isDragging=!1,document.body.style.cursor=""},this.onMouseMove=e=>{this.isDragging&&this.onCanvasMouseInteraction(e)},$t(()=>this.drawColorCanvas())}onCanvasMouseInteraction(e){let t=this.canvas().nativeElement.getBoundingClientRect(),o=(e.clientX-t.x)/t.width,r=(e.clientY-t.y)/t.height;this.sValue.set(Math.min(1,Math.max(0,o))),this.vValue.set(Math.min(1,Math.max(0,1-r))),this.colorChange.emit(ge({h:this.hValue()*360,s:this.sValue()*100,v:this.vValue()*100}))}ngAfterViewInit(){this.canvas().nativeElement.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),this.destroyRef.onDestroy(()=>{this.canvas().nativeElement.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove)})}drawColorCanvas(){let e={height:this.canvas().nativeElement.height,width:this.canvas().nativeElement.width},t=this.canvas().nativeElement.getContext("2d"),o=t.createLinearGradient(0,0,e.width,0);o.addColorStop(0,"#FFFFFF");let r=ge({h:this.hValue()*360,s:100,v:100}).hex();o.addColorStop(1,r);let s=t.createLinearGradient(0,0,0,e.height);s.addColorStop(0,"#00000000"),s.addColorStop(1,"#000000"),t.fillStyle=o,t.fillRect(0,0,e.width,e.height),t.fillStyle=s,t.fillRect(0,0,e.width,e.height)}computeCursorData(){let e=this.canvas().nativeElement.getBoundingClientRect(),t=e.width*this.sValue()-8,o=e.height*(1-this.vValue())-8;return{horizontalOffset:`${t}px`,verticalOffset:`${o}px`,color:ge({h:this.hValue()*360,s:this.sValue()*100,v:this.vValue()*100}).hex()}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-color-canvas"]],viewQuery:function(t,o){t&1&&ht(o.canvas,ic,5),t&2&&It()},inputs:{hValue:[1,"hValue"],sValue:[1,"sValue"],vValue:[1,"vValue"]},outputs:{sValue:"sValueChange",vValue:"vValueChange",colorChange:"colorChange"},decls:3,vars:6,consts:[["canvas",""],["width","250","height","150",1,"panel"],[1,"cursor"]],template:function(t,o){if(t&1&&kt(0,"canvas",1,0)(2,"div",2),t&2){let r=o.cursorData();c(2),Ze("left",r.horizontalOffset)("top",r.verticalOffset)("background-color",r.color)}},styles:["[_nghost-%COMP%]{position:relative;cursor:pointer;overflow:hidden;display:block}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{display:block;width:100%}[_nghost-%COMP%]   .cursor[_ngcontent-%COMP%]{position:absolute;width:18px;height:18px;border-radius:50%;border:2px solid #ffffff;box-sizing:border-box;pointer-events:none}"],changeDetection:0})}}return n})();var oc=/^#([0-9a-f]{3}){1,2}$/i,$s=(()=>{class n{constructor(){this.color=me.required({transform:e=>ge(e)}),this.colorChange=qt(),this.hValue=eo({source:this.color,computation:e=>e.hue()/360}),this.sValue=eo({source:this.color,computation:e=>e.saturationv()/100}),this.vValue=eo({source:this.color,computation:e=>e.value()/100}),this.hexColor=de(()=>ge({h:this.hValue()*360,s:this.sValue()*100,v:this.vValue()*100}).hex())}ngOnDestroy(){let e=ge({h:this.hValue()*360,s:this.sValue()*100,v:this.vValue()*100});this.colorChange.emit(e)}onHexCodeChange(e){let t=e.currentTarget;if(oc.test(t.value)){let o=ge(t.value);this.hValue.set(o.hue()/360),this.sValue.set(o.saturationv()/100),this.vValue.set(o.value()/100)}}onColorCanvasChanged(e){this.sValue.set(e.saturationv()/100),this.vValue.set(e.value()/100)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-color-selection-panel"]],inputs:{color:[1,"color"]},outputs:{colorChange:"colorChange"},decls:10,vars:7,consts:[[1,"sv-preview"],[3,"colorChange","hValue","sValue","vValue"],[1,"slider-container"],[3,"valueChange","value"],[1,"result-wrapper"],["role","presentation",1,"color-preview"],["appearance","outline",1,"density-3","code-input"],["matInput","",3,"change","ngModel"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"app-color-canvas",1),x("colorChange",function(s){return o.onColorCanvasChanged(s)}),m()(),h(2,"div",2)(3,"app-color-slider",3),sr("valueChange",function(s){return rr(o.hValue,s)||(o.hValue=s),s}),m()(),h(4,"div",4),w(5,"div",5),h(6,"mat-form-field",6)(7,"mat-label"),u(8,"Hex"),m(),h(9,"input",7),x("change",function(s){return o.onHexCodeChange(s)}),m()()()),t&2&&(c(),y("hValue",o.hValue())("sValue",o.sValue())("vValue",o.vValue()),c(2),nr("value",o.hValue),c(2),Ze("background",o.hexColor()),c(4),y("ngModel",o.hexColor()))},dependencies:[ot,it,ze,Oe,go,Ct,Xe,uo,zs,Hs],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;background-color:var(--irr-contrast-lightest);border-radius:5px;overflow:hidden;box-shadow:0 3px 5px -1px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}[_nghost-%COMP%]   .slider-container[_ngcontent-%COMP%]{padding:20px 10px}[_nghost-%COMP%]   .result-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:10px;padding:0 10px 15px}[_nghost-%COMP%]   .result-wrapper[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{display:block;min-width:40px;height:40px;border-radius:50%;box-shadow:0 0 4px 1px #0003}[_nghost-%COMP%]   .result-wrapper[_ngcontent-%COMP%]   .code-input[_ngcontent-%COMP%]{width:auto}[_nghost-%COMP%]   .result-wrapper[_ngcontent-%COMP%]   .code-input[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}"],changeDetection:0})}}return n})();function nc(n,i){if(n&1){let e=Q();h(0,"app-color-selection-panel",6),x("colorChange",function(o){k(e);let r=M();return I(r.onColorChanged(o))}),m()}if(n&2){let e=M();y("color",e.hexColor())}}var wo=(()=>{class n{constructor(){this.label=me.required(),this.hexColor=O("#000000"),this.isOpen=O(!1),this.isDisabled=O(!1),this.onChange=()=>{},this.onTouched=()=>{}}toggleColorPanel(){this.isDisabled()||this.isOpen.update(e=>!e)}onColorChanged(e){this.hexColor.set(e.hex()),this.onChange(e.hex())}writeValue(e){this.hexColor.set(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.isDisabled.set(e)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-color-picker"]],inputs:{label:[1,"label"]},features:[ce([{provide:po,useExisting:Yi(()=>n),multi:!0}])],decls:8,vars:10,consts:[["trigger","cdkOverlayOrigin"],[1,"color-label"],[1,"color-label__header"],[1,"color-label__code"],["role","presentation","cdkOverlayOrigin","",1,"color-preview",3,"click"],["cdkConnectedOverlay","",3,"backdropClick","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayHasBackdrop","cdkConnectedOverlayBackdropClass"],[3,"colorChange","color"]],template:function(t,o){if(t&1){let r=Q();h(0,"div",1)(1,"span",2),u(2),m(),h(3,"span",3),u(4),m()(),h(5,"div",4,0),x("click",function(){return k(r),I(o.toggleColorPanel())}),m(),bt(7,nc,1,1,"ng-template",5),x("backdropClick",function(){return k(r),I(o.toggleColorPanel())})}if(t&2){let r=_e(6);c(2),v(o.label()),c(2),v(o.hexColor()),c(),Ze("background-color",o.hexColor()),F("disabled",o.isDisabled()),c(2),y("cdkConnectedOverlayOrigin",r)("cdkConnectedOverlayOpen",o.isOpen())("cdkConnectedOverlayHasBackdrop",o.isOpen())("cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop-cs")}},dependencies:[Ei,Or,Dr,$s],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;align-items:center;border-radius:4px;padding:10px 15px;background-color:var(--irr-contrast-lightest);box-shadow:0 0 5px 1px #0000001a}[_nghost-%COMP%]   .color-preview[_ngcontent-%COMP%]{display:block;width:40px;height:40px;margin-left:auto;border-radius:50%;box-shadow:0 0 4px 1px #0000001a}[_nghost-%COMP%]   .color-preview[_ngcontent-%COMP%]:not(.disabled){cursor:pointer}[_nghost-%COMP%]   .color-label[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .color-label__header[_ngcontent-%COMP%]{color:var(--irr-contrast-highest)}[_nghost-%COMP%]   .color-label__code[_ngcontent-%COMP%]{color:var(--irr-contrast-medium);font-size:15px}"],changeDetection:0})}}return n})();function rc(n,i){if(n&1&&(h(0,"div",5)(1,"div",6),u(2),_(3,"translate"),m(),h(4,"div",7),u(5),m()(),w(6,"app-color-picker",8)),n&2){let e=i,t=M();c(2),E("",b(3,4,"tool.tiles.details.tileId"),":"),c(3),v(e.id),c(),y("ngModel",e.color)("label",t.translate.instant("tool.tiles.details.tileColor"))}}function sc(n,i){n&1&&(h(0,"div",4),u(1),_(2,"translate"),m()),n&2&&(c(),v(b(2,1,"tool.tiles.details.tileNoExist")))}var Us=(()=>{class n{constructor(){this.tile=O(null),this.route=l(Gt),this.store=l(N),this.router=l(X),this.translate=l(J)}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");if(e){let t=this.getTileModel(e);t&&this.tile.set(t)}}getTileModel(e){return this.store.selectSignal(et)().flatMap(o=>o.tiles).find(o=>o.id===e)}navigateToMenu(){this.router.navigate(["/tool/tray"])}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-tile-detail"]],decls:10,vars:7,consts:[[1,"actions"],["mat-flat-button","",3,"click"],["mat-flat-button","","color","accent","disabled",""],[1,"details"],[1,"no-exist"],[1,"id"],[1,"label"],[1,"value"],["disabled","true",3,"ngModel","label"]],template:function(t,o){if(t&1&&(h(0,"div",0)(1,"button",1),x("click",function(){return o.navigateToMenu()}),u(2),_(3,"translate"),m(),h(4,"button",2),u(5),_(6,"translate"),m()(),h(7,"div",3),R(8,rc,7,6)(9,sc,3,3,"div",4),m()),t&2){let r;c(2),E(" ",b(3,3,"common.return")," "),c(3),E(" ",b(6,5,"common.edit")," "),c(3),A((r=o.tile())?8:9,r)}},dependencies:[K,V,se,wo,go,Xe,uo,ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:12px;height:100%}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1 1 0}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;flex:1}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{padding:2px;color:#e6e6e6}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:12px;overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]   .no-exist[_ngcontent-%COMP%]{color:var(--irr-contrast-medium);margin:auto}"],changeDetection:0})}}return n})();var ft=(()=>{class n{constructor(){this.sectorForContourEditionChanged=new Ge(null),this.sectorForContourEdition$=this.sectorForContourEditionChanged.asObservable(),this.sectorListChanged=new Ge(null),this.sectorListChange$=this.sectorListChanged.asObservable(),this.sectorForPropertyEditionChanged=new Ge(null),this.sectorForPropertyEdition$=this.sectorForPropertyEditionChanged.asObservable(),this.canvasClickedSub=new S,this.canvasClicked$=this.canvasClickedSub.asObservable()}emitEditedSectorContour(e){this.sectorForContourEditionChanged.next(e)}emitEditedSectorProperty(e){this.sectorForPropertyEditionChanged.next(e)}emitSectorListChanged(e){this.sectorListChanged.next(e)}emitCanvasClicked(e){this.canvasClickedSub.next(e)}static createNewSector(){return{id:crypto.randomUUID(),name:"",color:ge({h:ut.nextFloat(0,360),s:75,v:95}).hex(),vertices:[],properties:{sectionMaxArea:5,sectionMinAngle:35,maxTileRadius:4,minTileRadius:0,tilesMargin:.1,evaluationParams:{singleSectionPopulation:2,overlappingAreaOutsideSector:-2,additionalPopulationOfNeighboringSectors:4,overlappingNotPopulatedSections:-1,tileColorMismatch:-2},populationParams:{initialPopulationSize:100,countOfTriesToInsertTile:30,countOfTrianglePositionDraws:30,countOfColorMatchingAttempts:40,iterationsCount:100,populationSize:10}}}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ac=10,lc=10,Mo=class extends wt{constructor(i,e,t,o=100){super(),this.vertices=i,this.selectedIndex=e,this.hexColor=t,this.order=o}drawObject(i,e){if(this.vertices.length>=2){let t=ac*e.scaleFactor;i.lineWidth=t,i.strokeStyle=this.hexColor,i.setLineDash([t]),i.beginPath(),i.globalAlpha=.25;let o=e.getViewportPosition(this.vertices.at(-1));i.moveTo(o.x,o.y),o=e.getViewportPosition(this.vertices[0]),i.lineTo(o.x,o.y),i.stroke(),i.globalAlpha=.7,i.setLineDash([]),i.beginPath(),i.moveTo(o.x,o.y);for(let r=1;r<this.vertices.length;++r)o=e.getViewportPosition(this.vertices[r]),i.lineTo(o.x,o.y);i.stroke()}i.lineWidth=1,i.globalAlpha=1,this.selectedIndex!==-1&&this.drawPoint(i,e,this.vertices[this.selectedIndex])}drawPoint(i,e,t){let o=e.getViewportPosition(t);i.beginPath();let r=lc*e.scaleFactor;i.arc(o.x,o.y,r,0,2*Math.PI),i.fillStyle=this.hexColor,i.fill()}getOrder(){return this.order}};function cc(n){let i=n.length,e=5381,t=52711,o;for(;i--;)o=n.charCodeAt(i),e=e*33^o,t=t*33^o;return(e>>>0)*4096+(t>>>0)}var Vi="|",dc=/\[object ([HTML|SVG](.*)Element)\]/,mc={"[object Arguments]":0,"[object Array]":1,"[object ArrayBuffer]":2,"[object AsyncFunction]":3,"[object AsyncGeneratorFunction]":4,"[object BigInt]":5,"[object BigInt64Array]":6,"[object BigUint64Array]":7,"[object Boolean]":8,"[object DataView]":9,"[object Date]":10,"[object DocumentFragment]":11,"[object Error]":12,"[object Event]":13,"[object Float32Array]":14,"[object Float64Array]":15,"[object Function]":16,"[object Generator]":17,"[object GeneratorFunction]":18,"[object Int8Array]":19,"[object Int16Array]":20,"[object Map]":21,"[object Number]":22,"[object Object]":23,"[object Promise]":24,"[object RegExp]":25,"[object Set]":26,"[object SharedArrayBuffer]":27,"[object String]":28,"[object Uint8Array]":29,"[object Uint8ClampedArray]":30,"[object Uint16Array]":31,"[object Uint32Array]":32,"[object WeakMap]":33,"[object WeakRef]":34,"[object WeakSet]":35,CUSTOM:36,ELEMENT:37},hc={"[object Arguments]":1,"[object Array]":2},Ks={"[object Generator]":1,"[object Promise]":2,"[object WeakMap]":3,"[object WeakRef]":4,"[object WeakSet]":5},pc={"[object AsyncFunction]":1,"[object AsyncGeneratorFunction]":2,"[object Boolean]":3,"[object Function]":4,"[object GeneratorFunction]":5,"[object Number]":6,"[object String]":7},uc={"[object BigInt64Array]":1,"[object BigUint64Array]":2,"[object Float32Array]":3,"[object Float64Array]":4,"[object Int8Array]":5,"[object Int16Array]":6,"[object Uint8Array]":7,"[object Uint8ClampedArray]":8,"[object Uint16Array]":9,"[object Uint32Array]":10},fc={"[object Arguments]":1,"[object Array]":2,"[object ArrayBuffer]":3,"[object BigInt64Array]":4,"[object BigUint64Array]":5,"[object DataView]":6,"[object Float32Array]":7,"[object Float64Array]":8,"[object Int8Array]":9,"[object Int16Array]":10,"[object Map]":11,"[object Object]":12,"[object Set]":13,"[object SharedArrayBuffer]":14,"[object Uint8Array]":15,"[object Uint8ClampedArray]":16,"[object Uint16Array]":17,"[object Uint32Array]":18,CUSTOM:19},ji={bigint:"i",boolean:"b",empty:"e",function:"g",number:"n",object:"o",string:"s",symbol:"s"};function fe(n,i){return ji.object+Vi+mc[n]+Vi+i}var Ws=new WeakMap,gc=0;function Pn(n,i){let e=Ws.get(n);if(e)return e;let t=fe(i,"NOT_ENUMERABLE"+Vi+gc++);return Ws.set(n,t),t}function _c(n,i){return n[0]>i[0]}function Zs(n,i){return n>i}function En(n,i){let e,t;for(let o=0;o<n.length;++o){for(t=n[o],e=o-1;~e&&i(n[e],t);--e)n[e+1]=n[e];n[e+1]=t}return n}var bc=Object.prototype.toString;function vc(n,i,e){if(fc[i])return qs(i,n,e);if(i==="[object Date]")return fe(i,n.getTime());if(i==="[object RegExp]")return fe(i,n.toString());if(i==="[object Event]")return fe(i,[n.bubbles,n.cancelBubble,n.cancelable,n.composed,n.currentTarget,n.defaultPrevented,n.eventPhase,n.isTrusted,n.returnValue,n.target,n.type].join());if(i==="[object Error]")return fe(i,n.message+Vi+n.stack);if(i==="[object DocumentFragment]")return fe(i,wc(n));let t=i.match(dc);return t?fe("ELEMENT",t[1]+Vi+n.outerHTML):Ks[i]?Pn(n,i):pc[i]?fe(i,n.toString()):qs("CUSTOM",n,e)}function qs(n,i,e){let t=e.cache.get(i);return t?fe(n,"RECURSIVE~"+t):(e.cache.set(i,++e.id),n==="[object Object]"?i[Symbol.iterator]?Pn(i,n):fe(n,Qs(i,e)):hc[n]?fe(n,yc(i,e)):n==="[object Map]"?fe(n,Mc(i,e)):n==="[object Set]"?fe(n,Pc(i,e)):uc[n]?fe(n,i.join()):n==="[object ArrayBuffer]"?fe(n,Gs(i)):n==="[object DataView]"?fe(n,Gs(i.buffer)):Ks[n]?Pn(i,n):fe("CUSTOM",Qs(i,e)))}function yc(n,i){let e=n.length,t=new Array(e);for(;--e>=0;)t[e]=ui(n[e],i);return t.join()}function xc(n){return Buffer.from(n).toString("utf8")}function Cc(n){return String.fromCharCode.apply(null,new Uint16Array(n))}function Sc(){return"UNSUPPORTED"}function wc(n){let i=n.children,e=i.length,t=new Array(e);for(;--e>=0;)t[e]=i[e].outerHTML;return t.join()}var Gs=typeof Buffer<"u"&&typeof Buffer.from=="function"?xc:typeof Uint16Array=="function"?Cc:Sc;function Mc(n,i){let e=new Array(n.size),t=0;for(n.forEach((o,r)=>{e[t++]=[ui(r,i),ui(o,i)]}),En(e,_c);--t>=0;)e[t]="["+e[t][0]+","+e[t][1]+"]";return"["+e.join()+"]"}function Qs(n,i){let e=En(Object.getOwnPropertyNames(n),Zs),t=e.length,o=new Array(t),r=t;for(;--r>=0;)o[r]=e[r]+":"+ui(n[e[r]],i);return"{"+o.join()+"}"}function Pc(n,i){let e=new Array(n.size),t=0;return n.forEach(o=>{e[t++]=ui(o,i)}),"["+En(e,Zs).join()+"]"}function ui(n,i){let e=typeof n;return n==null||e==="undefined"?ji.empty+n:e==="object"?vc(n,bc.call(n),i||{cache:new WeakMap,id:1}):e==="function"||e==="symbol"?ji[e]+n.toString():e==="boolean"?ji.boolean+ +n:ji[e]+n}function Ys(n){return cc(ui(n,void 0))}var gt=class{constructor(i,e){this.start=i,this.end=e}hash(){return Ys(this)}};var fi=class n extends wt{constructor(i,e,t,o=100){super(),this.hexColor=t,this.order=o,this.borderThickness=8,this.innerThickness=3,this.outerContour=e,this.innerLines=n.getLines(i)}drawObject(i,e){this.outerContour.length<3||(i.strokeStyle=this.hexColor,this.drawTriangulationMesh(i,e),this.drawBorder(i,e),i.lineWidth=1)}drawBorder(i,e){i.lineWidth=this.borderThickness*e.scaleFactor;let t=e.getViewportPosition(this.outerContour[0]);i.beginPath(),i.moveTo(t.x,t.y);for(let o=1;o<this.outerContour.length;++o)t=e.getViewportPosition(this.outerContour[o]),i.lineTo(t.x,t.y);i.closePath(),i.stroke(),i.globalAlpha=.25,i.fillStyle=this.hexColor,i.fill(),i.globalAlpha=1}drawTriangulationMesh(i,e){i.lineWidth=this.innerThickness*e.scaleFactor,i.globalAlpha=.3;for(let t of this.innerLines){i.beginPath();let o=e.getViewportPosition(t.start);i.moveTo(o.x,o.y);let r=e.getViewportPosition(t.end);i.lineTo(r.x,r.y),i.stroke()}i.globalAlpha=1}static getLines(i){let e=this.collectMeshLines(i),t=[];for(let o of e.values())o.count===2&&t.push(o.line);return t}getOrder(){return this.order}static collectMeshLines(i){let e=new Map;for(let t of i){let o=t.getVertices(),r=o.at(-1);for(let s=0;s<3;++s){let a=o[s],d=r.sqrMagnitude()<a.sqrMagnitude()?[r,a]:[a,r],f=new gt(d[0],d[1]),g=f.hash(),B=e.get(g);B?B.count++:e.set(g,{line:f,count:1}),r=a}}return e}};var gi=class extends wt{constructor(i,e,t=10,o=8){super(),this.vertices=i,this.hexColor=e,this.order=t,this.baseLineThickness=o}drawObject(i,e){if(this.vertices.length<3)return;i.beginPath();let t=e.getViewportPosition(this.vertices[0]);i.moveTo(t.x,t.y);for(let o=1;o<this.vertices.length;++o)t=e.getViewportPosition(this.vertices[o]),i.lineTo(t.x,t.y);i.lineWidth=this.baseLineThickness*e.scaleFactor,i.strokeStyle=this.hexColor,i.closePath(),i.globalAlpha=.25,i.fillStyle=this.hexColor,i.fill(),i.globalAlpha=1,i.stroke(),i.lineWidth=1}getOrder(){return this.order}};var Xs=(()=>{class n{constructor(){this.store=l(N),this.service=l(ft),this.destroyRef=l(G),this.toolService=l(Ee),this.sectorForContourEdition=hn(this.service.sectorForContourEdition$,{requireSync:!0}),this.sectorForPropertyEdition=hn(this.service.sectorForPropertyEdition$,{requireSync:!0}),this.visualElements=[],this.ribbonActions=[{iconName:"crop",visibility:O("on"),onClick:()=>this.toolService.openTakeSnapshotDialog(this.activeCanvas,"sectors_snapshot.png")},{iconName:"recenter",visibility:O("on"),onClick:()=>{this.focusOnImage(),this.activeCanvas.redraw()}}]}ngOnInit(){this.service.emitEditedSectorContour(null),this.service.emitEditedSectorProperty(null)}ngAfterViewInit(){this.subscribeOnEditedSectorChange(),this.subscribeOnEditedSectorPropertiesChange(),this.subscribeOnSectorListChange(),zr(this.activeCanvas.clicked).pipe(H(this.destroyRef)).subscribe(e=>this.service.emitCanvasClicked(e))}subscribeOnEditedSectorChange(){this.service.sectorForContourEdition$.pipe(H(this.destroyRef)).subscribe(e=>this.onEditedSectorChanged(e))}subscribeOnEditedSectorPropertiesChange(){this.service.sectorForPropertyEdition$.pipe(H(this.destroyRef)).subscribe(()=>this.redrawSectors())}subscribeOnSectorListChange(){this.service.sectorListChange$.pipe(H(this.destroyRef)).subscribe(()=>this.redrawSectors())}onEditedSectorChanged(e){this.activeCanvas.options.update(t=>xe(D({},t),{isMovable:!e})),this.redrawSectors()}redrawSectors(){this.visualElements.forEach(e=>e.removeObject()),this.visualElements=this.prepareSectorsContours();for(let e of this.visualElements)this.activeCanvas.addCanvasObject(e);this.activeCanvas.redraw()}prepareSectorsContours(){let e=this.sectorForContourEdition(),t=this.sectorForPropertyEdition(),o,r=this.store.selectSignal(be)();return e?r=is.addOrUpdate([...r],e.sector,s=>s.id===e.sector.id):this.service.sectorListChange$.pipe(Kn()).subscribe(s=>{o=s?.selectedSector}),this.mapSectorsToContours(r,e,t,o)}mapSectorsToContours(e,t,o,r){return e.map((s,a)=>{if(s.id===t?.sector.id)return new Mo([...t.sector.vertices],t.sector.vertices.indexOf(t.selectedVertex),t.sector.color);if(o?.mesh&&s.id===o?.sector.id){let d=o.mesh,f=o.contour;return new fi(d,f,o.sector.color)}else{let d=s.id===r?.id?10:8;return new gi([...s.vertices],s.color,10+a,d)}})}sectionEntered(e,t){this.activeCanvas=e;let o=this.store.selectSignal(Je)();return queueMicrotask(async()=>{this.imageObject=await Ee.createImageObject(o),this.activeCanvas.addCanvasObject(this.imageObject),t&&this.focusOnImage(),this.activeCanvas.redraw()}),{ribbon:this.ribbonActions}}focusOnImage(){let e=Ee.calculateZoomForImage(this.imageObject.size,this.activeCanvas.viewport);this.activeCanvas.setViewport(e,j.zero)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-sectors"]],decls:1,vars:0,template:function(t,o){t&1&&w(0,"router-outlet")},dependencies:[Qt],styles:["[_nghost-%COMP%]{display:block;box-sizing:border-box;height:100%;padding:20px 10px;overflow-y:auto;overflow-x:hidden}"],changeDetection:0})}}return n})();var Te=class extends Error{constructor(i,e){let t=new.target.prototype;super(`${i}: Status code '${e}'`),this.statusCode=e,this.__proto__=t}},Mt=class extends Error{constructor(i="A timeout occurred."){let e=new.target.prototype;super(i),this.__proto__=e}},ue=class extends Error{constructor(i="An abort occurred."){let e=new.target.prototype;super(i),this.__proto__=e}},Po=class extends Error{constructor(i,e){let t=new.target.prototype;super(i),this.transport=e,this.errorType="UnsupportedTransportError",this.__proto__=t}},Eo=class extends Error{constructor(i,e){let t=new.target.prototype;super(i),this.transport=e,this.errorType="DisabledTransportError",this.__proto__=t}},Do=class extends Error{constructor(i,e){let t=new.target.prototype;super(i),this.transport=e,this.errorType="FailedToStartTransportError",this.__proto__=t}},Bi=class extends Error{constructor(i){let e=new.target.prototype;super(i),this.errorType="FailedToNegotiateWithServerError",this.__proto__=e}},Oo=class extends Error{constructor(i,e){let t=new.target.prototype;super(i),this.innerErrors=e,this.__proto__=t}};var _i=class{constructor(i,e,t){this.statusCode=i,this.statusText=e,this.content=t}},rt=class{get(i,e){return this.send(xe(D({},e),{method:"GET",url:i}))}post(i,e){return this.send(xe(D({},e),{method:"POST",url:i}))}delete(i,e){return this.send(xe(D({},e),{method:"DELETE",url:i}))}getCookieString(i){return""}};var p=(function(n){return n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None",n})(p||{});var st=class{constructor(){}log(i,e){}};st.instance=new st;var Js="10.0.0";var z=class{static isRequired(i,e){if(i==null)throw new Error(`The '${e}' argument is required.`)}static isNotEmpty(i,e){if(!i||i.match(/^\s*$/))throw new Error(`The '${e}' argument should not be empty.`)}static isIn(i,e,t){if(!(i in e))throw new Error(`Unknown ${t} value: ${i}.`)}},$=class n{static get isBrowser(){return!n.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!n.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!n.isNode&&typeof window=="object"&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}};function Pt(n,i){let e="";return qe(n)?(e=`Binary data of length ${n.byteLength}`,i&&(e+=`. Content: '${Ec(n)}'`)):typeof n=="string"&&(e=`String data of length ${n.length}`,i&&(e+=`. Content: '${n}'`)),e}function Ec(n){let i=new Uint8Array(n),e="";return i.forEach(t=>{let o=t<16?"0":"";e+=`0x${o}${t.toString(16)} `}),e.substring(0,e.length-1)}function qe(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}async function ko(n,i,e,t,o,r){let s={},[a,d]=at();s[a]=d,n.log(p.Trace,`(${i} transport) sending data. ${Pt(o,r.logMessageContent)}.`);let f=qe(o)?"arraybuffer":"text",g=await e.post(t,{content:o,headers:D(D({},s),r.headers),responseType:f,timeout:r.timeout,withCredentials:r.withCredentials});n.log(p.Trace,`(${i} transport) request complete. Response status: ${g.statusCode}.`)}function ea(n){return n===void 0?new Lt(p.Information):n===null?st.instance:n.log!==void 0?n:new Lt(n)}var To=class{constructor(i,e){this._subject=i,this._observer=e}dispose(){let i=this._subject.observers.indexOf(this._observer);i>-1&&this._subject.observers.splice(i,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(e=>{})}},Lt=class{constructor(i){this._minLevel=i,this.out=console}log(i,e){if(i>=this._minLevel){let t=`[${new Date().toISOString()}] ${p[i]}: ${e}`;switch(i){case p.Critical:case p.Error:this.out.error(t);break;case p.Warning:this.out.warn(t);break;case p.Information:this.out.info(t);break;default:this.out.log(t);break}}}};function at(){let n="X-SignalR-User-Agent";return $.isNode&&(n="User-Agent"),[n,Dc(Js,Oc(),kc(),Tc())]}function Dc(n,i,e,t){let o="Microsoft SignalR/",r=n.split(".");return o+=`${r[0]}.${r[1]}`,o+=` (${n}; `,i&&i!==""?o+=`${i}; `:o+="Unknown OS; ",o+=`${e}`,t?o+=`; ${t}`:o+="; Unknown Runtime Version",o+=")",o}function Oc(){if($.isNode)switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}else return""}function Tc(){if($.isNode)return process.versions.node}function kc(){return $.isNode?"NodeJS":"Browser"}function Io(n){return n.stack?n.stack:n.message?n.message:`${n}`}function ta(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}var Ro=class extends rt{constructor(i){if(super(),this._logger=i,typeof fetch>"u"||$.isNode){let e=typeof __webpack_require__=="function"?__non_webpack_require__:jt;this._jar=new(e("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=e("node-fetch"):this._fetchType=fetch,this._fetchType=e("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(ta());if(typeof AbortController>"u"){let e=typeof __webpack_require__=="function"?__non_webpack_require__:jt;this._abortControllerType=e("abort-controller")}else this._abortControllerType=AbortController}async send(i){if(i.abortSignal&&i.abortSignal.aborted)throw new ue;if(!i.method)throw new Error("No method defined.");if(!i.url)throw new Error("No url defined.");let e=new this._abortControllerType,t;i.abortSignal&&(i.abortSignal.onabort=()=>{e.abort(),t=new ue});let o=null;if(i.timeout){let d=i.timeout;o=setTimeout(()=>{e.abort(),this._logger.log(p.Warning,"Timeout from HTTP request."),t=new Mt},d)}i.content===""&&(i.content=void 0),i.content&&(i.headers=i.headers||{},qe(i.content)?i.headers["Content-Type"]="application/octet-stream":i.headers["Content-Type"]="text/plain;charset=UTF-8");let r;try{r=await this._fetchType(i.url,{body:i.content,cache:"no-cache",credentials:i.withCredentials===!0?"include":"same-origin",headers:D({"X-Requested-With":"XMLHttpRequest"},i.headers),method:i.method,mode:"cors",redirect:"follow",signal:e.signal})}catch(d){throw t||(this._logger.log(p.Warning,`Error from HTTP request. ${d}.`),d)}finally{o&&clearTimeout(o),i.abortSignal&&(i.abortSignal.onabort=null)}if(!r.ok){let d=await ia(r,"text");throw new Te(d||r.statusText,r.status)}let a=await ia(r,i.responseType);return new _i(r.status,r.statusText,a)}getCookieString(i){let e="";return $.isNode&&this._jar&&this._jar.getCookies(i,(t,o)=>e=o.join("; ")),e}};function ia(n,i){let e;switch(i){case"arraybuffer":e=n.arrayBuffer();break;case"text":e=n.text();break;case"blob":case"document":case"json":throw new Error(`${i} is not supported.`);default:e=n.text();break}return e}var Ao=class extends rt{constructor(i){super(),this._logger=i}send(i){return i.abortSignal&&i.abortSignal.aborted?Promise.reject(new ue):i.method?i.url?new Promise((e,t)=>{let o=new XMLHttpRequest;o.open(i.method,i.url,!0),o.withCredentials=i.withCredentials===void 0?!0:i.withCredentials,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.content===""&&(i.content=void 0),i.content&&(qe(i.content)?o.setRequestHeader("Content-Type","application/octet-stream"):o.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));let r=i.headers;r&&Object.keys(r).forEach(s=>{o.setRequestHeader(s,r[s])}),i.responseType&&(o.responseType=i.responseType),i.abortSignal&&(i.abortSignal.onabort=()=>{o.abort(),t(new ue)}),i.timeout&&(o.timeout=i.timeout),o.onload=()=>{i.abortSignal&&(i.abortSignal.onabort=null),o.status>=200&&o.status<300?e(new _i(o.status,o.statusText,o.response||o.responseText)):t(new Te(o.response||o.responseText||o.statusText,o.status))},o.onerror=()=>{this._logger.log(p.Warning,`Error from HTTP request. ${o.status}: ${o.statusText}.`),t(new Te(o.statusText,o.status))},o.ontimeout=()=>{this._logger.log(p.Warning,"Timeout from HTTP request."),t(new Mt)},o.send(i.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}};var Fo=class extends rt{constructor(i){if(super(),typeof fetch<"u"||$.isNode)this._httpClient=new Ro(i);else if(typeof XMLHttpRequest<"u")this._httpClient=new Ao(i);else throw new Error("No usable HttpClient found.")}send(i){return i.abortSignal&&i.abortSignal.aborted?Promise.reject(new ue):i.method?i.url?this._httpClient.send(i):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(i){return this._httpClient.getCookieString(i)}};var ke=class n{static write(i){return`${i}${n.RecordSeparator}`}static parse(i){if(i[i.length-1]!==n.RecordSeparator)throw new Error("Message is incomplete.");let e=i.split(n.RecordSeparator);return e.pop(),e}};ke.RecordSeparatorCode=30;ke.RecordSeparator=String.fromCharCode(ke.RecordSeparatorCode);var Lo=class{writeHandshakeRequest(i){return ke.write(JSON.stringify(i))}parseHandshakeResponse(i){let e,t;if(qe(i)){let a=new Uint8Array(i),d=a.indexOf(ke.RecordSeparatorCode);if(d===-1)throw new Error("Message is incomplete.");let f=d+1;e=String.fromCharCode.apply(null,Array.prototype.slice.call(a.slice(0,f))),t=a.byteLength>f?a.slice(f).buffer:null}else{let a=i,d=a.indexOf(ke.RecordSeparator);if(d===-1)throw new Error("Message is incomplete.");let f=d+1;e=a.substring(0,f),t=a.length>f?a.substring(f):null}let o=ke.parse(e),r=JSON.parse(o[0]);if(r.type)throw new Error("Expected a handshake response from the server.");return[t,r]}};var P=(function(n){return n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n[n.Ack=8]="Ack",n[n.Sequence=9]="Sequence",n})(P||{});var No=class{constructor(){this.observers=[]}next(i){for(let e of this.observers)e.next(i)}error(i){for(let e of this.observers)e.error&&e.error(i)}complete(){for(let i of this.observers)i.complete&&i.complete()}subscribe(i){return this.observers.push(i),new To(this,i)}};var jo=class{constructor(i,e,t){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=i,this._connection=e,this._bufferSize=t}async _send(i){let e=this._protocol.writeMessage(i),t=Promise.resolve();if(this._isInvocationMessage(i)){this._totalMessageCount++;let o=()=>{},r=()=>{};qe(e)?this._bufferedByteCount+=e.byteLength:this._bufferedByteCount+=e.length,this._bufferedByteCount>=this._bufferSize&&(t=new Promise((s,a)=>{o=s,r=a})),this._messages.push(new Dn(e,this._totalMessageCount,o,r))}try{this._reconnectInProgress||await this._connection.send(e)}catch{this._disconnected()}await t}_ack(i){let e=-1;for(let t=0;t<this._messages.length;t++){let o=this._messages[t];if(o._id<=i.sequenceId)e=t,qe(o._message)?this._bufferedByteCount-=o._message.byteLength:this._bufferedByteCount-=o._message.length,o._resolver();else if(this._bufferedByteCount<this._bufferSize)o._resolver();else break}e!==-1&&(this._messages=this._messages.slice(e+1))}_shouldProcessMessage(i){if(this._waitForSequenceMessage)return i.type!==P.Sequence?!1:(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(i))return!0;let e=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,e<=this._latestReceivedSequenceId?(e===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=e,this._ackTimer(),!0)}_resetSequence(i){if(i.sequenceId>this._nextReceivingSequenceId){this._connection.stop(new Error("Sequence ID greater than amount of messages we've received."));return}this._nextReceivingSequenceId=i.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){let i=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:P.Sequence,sequenceId:i}));let e=this._messages;for(let t of e)await this._connection.send(t._message);this._reconnectInProgress=!1}_dispose(i){i??(i=new Error("Unable to reconnect to server."));for(let e of this._messages)e._rejector(i)}_isInvocationMessage(i){switch(i.type){case P.Invocation:case P.StreamItem:case P.Completion:case P.StreamInvocation:case P.CancelInvocation:return!0;case P.Close:case P.Sequence:case P.Ping:case P.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:P.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0},1e3))}},Dn=class{constructor(i,e,t,o){this._message=i,this._id=e,this._resolver=t,this._rejector=o}};var Ic=30*1e3,Rc=15*1e3,Ac=1e5,Z=(function(n){return n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting",n})(Z||{}),Vo=class n{static create(i,e,t,o,r,s,a){return new n(i,e,t,o,r,s,a)}constructor(i,e,t,o,r,s,a){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(p.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},z.isRequired(i,"connection"),z.isRequired(e,"logger"),z.isRequired(t,"protocol"),this.serverTimeoutInMilliseconds=r??Ic,this.keepAliveIntervalInMilliseconds=s??Rc,this._statefulReconnectBufferSize=a??Ac,this._logger=e,this._protocol=t,this.connection=i,this._reconnectPolicy=o,this._handshakeProtocol=new Lo,this.connection.onreceive=d=>this._processIncomingData(d),this.connection.onclose=d=>this._connectionClosed(d),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Z.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:P.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(i){if(this._connectionState!==Z.Disconnected&&this._connectionState!==Z.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!i)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=i}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==Z.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=Z.Connecting,this._logger.log(p.Debug,"Starting HubConnection.");try{await this._startInternal(),$.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=Z.Connected,this._connectionStarted=!0,this._logger.log(p.Debug,"HubConnection connected successfully.")}catch(i){return this._connectionState=Z.Disconnected,this._logger.log(p.Debug,`HubConnection failed to start successfully because of error '${i}'.`),Promise.reject(i)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;let i=new Promise((e,t)=>{this._handshakeResolver=e,this._handshakeRejecter=t});await this.connection.start(this._protocol.transferFormat);try{let e=this._protocol.version;this.connection.features.reconnect||(e=1);let t={protocol:this._protocol.name,version:e};if(this._logger.log(p.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(t)),this._logger.log(p.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await i,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new jo(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(e){throw this._logger.log(p.Debug,`Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(e),e}}async stop(){let i=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await i}catch{}}_stopInternal(i){if(this._connectionState===Z.Disconnected)return this._logger.log(p.Debug,`Call to HubConnection.stop(${i}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===Z.Disconnecting)return this._logger.log(p.Debug,`Call to HttpConnection.stop(${i}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;let e=this._connectionState;return this._connectionState=Z.Disconnecting,this._logger.log(p.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(p.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(e===Z.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=i||new ue("The connection was stopped before the hub handshake could complete."),this.connection.stop(i))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(i,...e){let[t,o]=this._replaceStreamingParams(e),r=this._createStreamInvocation(i,e,o),s,a=new No;return a.cancelCallback=()=>{let d=this._createCancelInvocation(r.invocationId);return delete this._callbacks[r.invocationId],s.then(()=>this._sendWithProtocol(d))},this._callbacks[r.invocationId]=(d,f)=>{if(f){a.error(f);return}else d&&(d.type===P.Completion?d.error?a.error(new Error(d.error)):a.complete():a.next(d.item))},s=this._sendWithProtocol(r).catch(d=>{a.error(d),delete this._callbacks[r.invocationId]}),this._launchStreams(t,s),a}_sendMessage(i){return this._resetKeepAliveInterval(),this.connection.send(i)}_sendWithProtocol(i){return this._messageBuffer?this._messageBuffer._send(i):this._sendMessage(this._protocol.writeMessage(i))}send(i,...e){let[t,o]=this._replaceStreamingParams(e),r=this._sendWithProtocol(this._createInvocation(i,e,!0,o));return this._launchStreams(t,r),r}invoke(i,...e){let[t,o]=this._replaceStreamingParams(e),r=this._createInvocation(i,e,!1,o);return new Promise((a,d)=>{this._callbacks[r.invocationId]=(g,B)=>{if(B){d(B);return}else g&&(g.type===P.Completion?g.error?d(new Error(g.error)):a(g.result):d(new Error(`Unexpected message type: ${g.type}`)))};let f=this._sendWithProtocol(r).catch(g=>{d(g),delete this._callbacks[r.invocationId]});this._launchStreams(t,f)})}on(i,e){!i||!e||(i=i.toLowerCase(),this._methods[i]||(this._methods[i]=[]),this._methods[i].indexOf(e)===-1&&this._methods[i].push(e))}off(i,e){if(!i)return;i=i.toLowerCase();let t=this._methods[i];if(t)if(e){let o=t.indexOf(e);o!==-1&&(t.splice(o,1),t.length===0&&delete this._methods[i])}else delete this._methods[i]}onclose(i){i&&this._closedCallbacks.push(i)}onreconnecting(i){i&&this._reconnectingCallbacks.push(i)}onreconnected(i){i&&this._reconnectedCallbacks.push(i)}_processIncomingData(i){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(i=this._processHandshakeResponse(i),this._receivedHandshakeResponse=!0),i){let e=this._protocol.parseMessages(i,this._logger);for(let t of e)if(!(this._messageBuffer&&!this._messageBuffer._shouldProcessMessage(t)))switch(t.type){case P.Invocation:this._invokeClientMethod(t).catch(o=>{this._logger.log(p.Error,`Invoke client method threw error: ${Io(o)}`)});break;case P.StreamItem:case P.Completion:{let o=this._callbacks[t.invocationId];if(o){t.type===P.Completion&&delete this._callbacks[t.invocationId];try{o(t)}catch(r){this._logger.log(p.Error,`Stream callback threw error: ${Io(r)}`)}}break}case P.Ping:break;case P.Close:{this._logger.log(p.Information,"Close message received from server.");let o=t.error?new Error("Server returned an error on close: "+t.error):void 0;t.allowReconnect===!0?this.connection.stop(o):this._stopPromise=this._stopInternal(o);break}case P.Ack:this._messageBuffer&&this._messageBuffer._ack(t);break;case P.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(t);break;default:this._logger.log(p.Warning,`Invalid message type: ${t.type}.`);break}}this._resetTimeoutPeriod()}_processHandshakeResponse(i){let e,t;try{[t,e]=this._handshakeProtocol.parseHandshakeResponse(i)}catch(o){let r="Error parsing handshake response: "+o;this._logger.log(p.Error,r);let s=new Error(r);throw this._handshakeRejecter(s),s}if(e.error){let o="Server returned handshake error: "+e.error;this._logger.log(p.Error,o);let r=new Error(o);throw this._handshakeRejecter(r),r}else this._logger.log(p.Debug,"Server handshake complete.");return this._handshakeResolver(),t}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!this.connection.features||!this.connection.features.inherentKeepAlive){this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds);let i=this._nextKeepAlive-new Date().getTime();if(i<0){this._connectionState===Z.Connected&&this._trySendPingMessage();return}this._pingServerHandle===void 0&&(i<0&&(i=0),this._pingServerHandle=setTimeout(async()=>{this._connectionState===Z.Connected&&await this._trySendPingMessage()},i))}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(i){let e=i.target.toLowerCase(),t=this._methods[e];if(!t){this._logger.log(p.Warning,`No client method with the name '${e}' found.`),i.invocationId&&(this._logger.log(p.Warning,`No result given for '${e}' method and invocation ID '${i.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(i.invocationId,"Client didn't provide a result.",null)));return}let o=t.slice(),r=!!i.invocationId,s,a,d;for(let f of o)try{let g=s;s=await f.apply(this,i.arguments),r&&s&&g&&(this._logger.log(p.Error,`Multiple results provided for '${e}'. Sending error to server.`),d=this._createCompletionMessage(i.invocationId,"Client provided multiple results.",null)),a=void 0}catch(g){a=g,this._logger.log(p.Error,`A callback for the method '${e}' threw error '${g}'.`)}d?await this._sendWithProtocol(d):r?(a?d=this._createCompletionMessage(i.invocationId,`${a}`,null):s!==void 0?d=this._createCompletionMessage(i.invocationId,null,s):(this._logger.log(p.Warning,`No result given for '${e}' method and invocation ID '${i.invocationId}'.`),d=this._createCompletionMessage(i.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(d)):s&&this._logger.log(p.Error,`Result given for '${e}' method but server is not expecting a result.`)}_connectionClosed(i){this._logger.log(p.Debug,`HubConnection.connectionClosed(${i}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||i||new ue("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(i||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Z.Disconnecting?this._completeClose(i):this._connectionState===Z.Connected&&this._reconnectPolicy?this._reconnect(i):this._connectionState===Z.Connected&&this._completeClose(i)}_completeClose(i){if(this._connectionStarted){this._connectionState=Z.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(i??new Error("Connection closed.")),this._messageBuffer=void 0),$.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(e=>e.apply(this,[i]))}catch(e){this._logger.log(p.Error,`An onclose callback called with error '${i}' threw error '${e}'.`)}}}async _reconnect(i){let e=Date.now(),t=0,o=i!==void 0?i:new Error("Attempting to reconnect due to a unknown error."),r=this._getNextRetryDelay(t,0,o);if(r===null){this._logger.log(p.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(i);return}if(this._connectionState=Z.Reconnecting,i?this._logger.log(p.Information,`Connection reconnecting because of error '${i}'.`):this._logger.log(p.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(s=>s.apply(this,[i]))}catch(s){this._logger.log(p.Error,`An onreconnecting callback called with error '${i}' threw error '${s}'.`)}if(this._connectionState!==Z.Reconnecting){this._logger.log(p.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;r!==null;){if(this._logger.log(p.Information,`Reconnect attempt number ${t+1} will start in ${r} ms.`),await new Promise(s=>{this._reconnectDelayHandle=setTimeout(s,r)}),this._reconnectDelayHandle=void 0,this._connectionState!==Z.Reconnecting){this._logger.log(p.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(await this._startInternal(),this._connectionState=Z.Connected,this._logger.log(p.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(s=>s.apply(this,[this.connection.connectionId]))}catch(s){this._logger.log(p.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${s}'.`)}return}catch(s){if(this._logger.log(p.Information,`Reconnect attempt failed because of error '${s}'.`),this._connectionState!==Z.Reconnecting){this._logger.log(p.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===Z.Disconnecting&&this._completeClose();return}t++,o=s instanceof Error?s:new Error(s.toString()),r=this._getNextRetryDelay(t,Date.now()-e,o)}}this._logger.log(p.Information,`Reconnect retries have been exhausted after ${Date.now()-e} ms and ${t} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(i,e,t){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:e,previousRetryCount:i,retryReason:t})}catch(o){return this._logger.log(p.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${i}, ${e}) threw error '${o}'.`),null}}_cancelCallbacksWithError(i){let e=this._callbacks;this._callbacks={},Object.keys(e).forEach(t=>{let o=e[t];try{o(null,i)}catch(r){this._logger.log(p.Error,`Stream 'error' callback called with '${i}' threw error: ${Io(r)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(i,e,t,o){if(t)return o.length!==0?{target:i,arguments:e,streamIds:o,type:P.Invocation}:{target:i,arguments:e,type:P.Invocation};{let r=this._invocationId;return this._invocationId++,o.length!==0?{target:i,arguments:e,invocationId:r.toString(),streamIds:o,type:P.Invocation}:{target:i,arguments:e,invocationId:r.toString(),type:P.Invocation}}}_launchStreams(i,e){if(i.length!==0){e||(e=Promise.resolve());for(let t in i)i[t].subscribe({complete:()=>{e=e.then(()=>this._sendWithProtocol(this._createCompletionMessage(t)))},error:o=>{let r;o instanceof Error?r=o.message:o&&o.toString?r=o.toString():r="Unknown error",e=e.then(()=>this._sendWithProtocol(this._createCompletionMessage(t,r)))},next:o=>{e=e.then(()=>this._sendWithProtocol(this._createStreamItemMessage(t,o)))}})}}_replaceStreamingParams(i){let e=[],t=[];for(let o=0;o<i.length;o++){let r=i[o];if(this._isObservable(r)){let s=this._invocationId;this._invocationId++,e[s]=r,t.push(s.toString()),i.splice(o,1)}}return[e,t]}_isObservable(i){return i&&i.subscribe&&typeof i.subscribe=="function"}_createStreamInvocation(i,e,t){let o=this._invocationId;return this._invocationId++,t.length!==0?{target:i,arguments:e,invocationId:o.toString(),streamIds:t,type:P.StreamInvocation}:{target:i,arguments:e,invocationId:o.toString(),type:P.StreamInvocation}}_createCancelInvocation(i){return{invocationId:i,type:P.CancelInvocation}}_createStreamItemMessage(i,e){return{invocationId:i,item:e,type:P.StreamItem}}_createCompletionMessage(i,e,t){return e?{error:e,invocationId:i,type:P.Completion}:{invocationId:i,result:t,type:P.Completion}}_createCloseMessage(){return{type:P.Close}}async _trySendPingMessage(){try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}};var Fc=[0,2e3,1e4,3e4,null],zi=class{constructor(i){this._retryDelays=i!==void 0?[...i,null]:Fc}nextRetryDelayInMilliseconds(i){return this._retryDelays[i.previousRetryCount]}};var Nt=(()=>{class n{}return n.Authorization="Authorization",n.Cookie="Cookie",n})();var Bo=class extends rt{constructor(i,e){super(),this._innerClient=i,this._accessTokenFactory=e}async send(i){let e=!0;this._accessTokenFactory&&(!this._accessToken||i.url&&i.url.indexOf("/negotiate?")>0)&&(e=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(i);let t=await this._innerClient.send(i);return e&&t.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(i),await this._innerClient.send(i)):t}_setAuthorizationHeader(i){i.headers||(i.headers={}),this._accessToken?i.headers[Nt.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&i.headers[Nt.Authorization]&&delete i.headers[Nt.Authorization]}getCookieString(i){return this._innerClient.getCookieString(i)}};var te=(function(n){return n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling",n})(te||{}),ie=(function(n){return n[n.Text=1]="Text",n[n.Binary=2]="Binary",n})(ie||{});var zo=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};var Hi=class{get pollAborted(){return this._pollAbort.aborted}constructor(i,e,t){this._httpClient=i,this._logger=e,this._pollAbort=new zo,this._options=t,this._running=!1,this.onreceive=null,this.onclose=null}async connect(i,e){if(z.isRequired(i,"url"),z.isRequired(e,"transferFormat"),z.isIn(e,ie,"transferFormat"),this._url=i,this._logger.log(p.Trace,"(LongPolling transport) Connecting."),e===ie.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");let[t,o]=at(),r=D({[t]:o},this._options.headers),s={abortSignal:this._pollAbort.signal,headers:r,timeout:1e5,withCredentials:this._options.withCredentials};e===ie.Binary&&(s.responseType="arraybuffer");let a=`${i}&_=${Date.now()}`;this._logger.log(p.Trace,`(LongPolling transport) polling: ${a}.`);let d=await this._httpClient.get(a,s);d.statusCode!==200?(this._logger.log(p.Error,`(LongPolling transport) Unexpected response code: ${d.statusCode}.`),this._closeError=new Te(d.statusText||"",d.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _poll(i,e){try{for(;this._running;)try{let t=`${i}&_=${Date.now()}`;this._logger.log(p.Trace,`(LongPolling transport) polling: ${t}.`);let o=await this._httpClient.get(t,e);o.statusCode===204?(this._logger.log(p.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):o.statusCode!==200?(this._logger.log(p.Error,`(LongPolling transport) Unexpected response code: ${o.statusCode}.`),this._closeError=new Te(o.statusText||"",o.statusCode),this._running=!1):o.content?(this._logger.log(p.Trace,`(LongPolling transport) data received. ${Pt(o.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(o.content)):this._logger.log(p.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(t){this._running?t instanceof Mt?this._logger.log(p.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=t,this._running=!1):this._logger.log(p.Trace,`(LongPolling transport) Poll errored after shutdown: ${t.message}`)}}finally{this._logger.log(p.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(i){return this._running?ko(this._logger,"LongPolling",this._httpClient,this._url,i,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(p.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(p.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);let i={},[e,t]=at();i[e]=t;let o={headers:D(D({},i),this._options.headers),timeout:this._options.timeout,withCredentials:this._options.withCredentials},r;try{await this._httpClient.delete(this._url,o)}catch(s){r=s}r?r instanceof Te&&(r.statusCode===404?this._logger.log(p.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(p.Trace,`(LongPolling transport) Error sending a DELETE request: ${r}`)):this._logger.log(p.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(p.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let i="(LongPolling transport) Firing onclose event.";this._closeError&&(i+=" Error: "+this._closeError),this._logger.log(p.Trace,i),this.onclose(this._closeError)}}};var Ho=class{constructor(i,e,t,o){this._httpClient=i,this._accessToken=e,this._logger=t,this._options=o,this.onreceive=null,this.onclose=null}async connect(i,e){return z.isRequired(i,"url"),z.isRequired(e,"transferFormat"),z.isIn(e,ie,"transferFormat"),this._logger.log(p.Trace,"(SSE transport) Connecting."),this._url=i,this._accessToken&&(i+=(i.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((t,o)=>{let r=!1;if(e!==ie.Text){o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let s;if($.isBrowser||$.isWebWorker)s=new this._options.EventSource(i,{withCredentials:this._options.withCredentials});else{let a=this._httpClient.getCookieString(i),d={};d.Cookie=a;let[f,g]=at();d[f]=g,s=new this._options.EventSource(i,{withCredentials:this._options.withCredentials,headers:D(D({},d),this._options.headers)})}try{s.onmessage=a=>{if(this.onreceive)try{this._logger.log(p.Trace,`(SSE transport) data received. ${Pt(a.data,this._options.logMessageContent)}.`),this.onreceive(a.data)}catch(d){this._close(d);return}},s.onerror=a=>{r?this._close():o(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},s.onopen=()=>{this._logger.log(p.Information,`SSE connected to ${this._url}`),this._eventSource=s,r=!0,t()}}catch(a){o(a);return}})}async send(i){return this._eventSource?ko(this._logger,"SSE",this._httpClient,this._url,i,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(i){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(i))}};var $o=class{constructor(i,e,t,o,r,s){this._logger=t,this._accessTokenFactory=e,this._logMessageContent=o,this._webSocketConstructor=r,this._httpClient=i,this.onreceive=null,this.onclose=null,this._headers=s}async connect(i,e){z.isRequired(i,"url"),z.isRequired(e,"transferFormat"),z.isIn(e,ie,"transferFormat"),this._logger.log(p.Trace,"(WebSockets transport) Connecting.");let t;return this._accessTokenFactory&&(t=await this._accessTokenFactory()),new Promise((o,r)=>{i=i.replace(/^http/,"ws");let s,a=this._httpClient.getCookieString(i),d=!1;if($.isNode||$.isReactNative){let f={},[g,B]=at();f[g]=B,t&&(f[Nt.Authorization]=`Bearer ${t}`),a&&(f[Nt.Cookie]=a),s=new this._webSocketConstructor(i,void 0,{headers:D(D({},f),this._headers)})}else t&&(i+=(i.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(t)}`);s||(s=new this._webSocketConstructor(i)),e===ie.Binary&&(s.binaryType="arraybuffer"),s.onopen=f=>{this._logger.log(p.Information,`WebSocket connected to ${i}.`),this._webSocket=s,d=!0,o()},s.onerror=f=>{let g=null;typeof ErrorEvent<"u"&&f instanceof ErrorEvent?g=f.error:g="There was an error with the transport",this._logger.log(p.Information,`(WebSockets transport) ${g}.`)},s.onmessage=f=>{if(this._logger.log(p.Trace,`(WebSockets transport) data received. ${Pt(f.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(f.data)}catch(g){this._close(g);return}},s.onclose=f=>{if(d)this._close(f);else{let g=null;typeof ErrorEvent<"u"&&f instanceof ErrorEvent?g=f.error:g="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",r(new Error(g))}}})}send(i){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(p.Trace,`(WebSockets transport) sending data. ${Pt(i,this._logMessageContent)}.`),this._webSocket.send(i),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(i){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(p.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(i)&&(i.wasClean===!1||i.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${i.code} (${i.reason||"no reason given"}).`)):i instanceof Error?this.onclose(i):this.onclose())}_isCloseEvent(i){return i&&typeof i.wasClean=="boolean"&&typeof i.code=="number"}};var oa=100,Uo=class{constructor(i,e={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,z.isRequired(i,"url"),this._logger=ea(e.logger),this.baseUrl=this._resolveUrl(i),e=e||{},e.logMessageContent=e.logMessageContent===void 0?!1:e.logMessageContent,typeof e.withCredentials=="boolean"||e.withCredentials===void 0)e.withCredentials=e.withCredentials===void 0?!0:e.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");e.timeout=e.timeout===void 0?100*1e3:e.timeout;let t=null,o=null;if($.isNode&&typeof jt<"u"){let r=typeof __webpack_require__=="function"?__non_webpack_require__:jt;t=r("ws"),o=r("eventsource")}!$.isNode&&typeof WebSocket<"u"&&!e.WebSocket?e.WebSocket=WebSocket:$.isNode&&!e.WebSocket&&t&&(e.WebSocket=t),!$.isNode&&typeof EventSource<"u"&&!e.EventSource?e.EventSource=EventSource:$.isNode&&!e.EventSource&&typeof o<"u"&&(e.EventSource=o),this._httpClient=new Bo(e.httpClient||new Fo(this._logger),e.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=e,this.onreceive=null,this.onclose=null}async start(i){if(i=i||ie.Binary,z.isIn(i,ie,"transferFormat"),this._logger.log(p.Debug,`Starting connection with transfer format '${ie[i]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(i),await this._startInternalPromise,this._connectionState==="Disconnecting"){let e="Failed to start the HttpConnection before stop() was called.";return this._logger.log(p.Error,e),await this._stopPromise,Promise.reject(new ue(e))}else if(this._connectionState!=="Connected"){let e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(p.Error,e),Promise.reject(new ue(e))}this._connectionStarted=!0}send(i){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new On(this.transport)),this._sendQueue.send(i))}async stop(i){if(this._connectionState==="Disconnected")return this._logger.log(p.Debug,`Call to HttpConnection.stop(${i}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log(p.Debug,`Call to HttpConnection.stop(${i}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(e=>{this._stopPromiseResolver=e}),await this._stopInternal(i),await this._stopPromise}async _stopInternal(i){this._stopError=i;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(e){this._logger.log(p.Error,`HttpConnection.transport.stop() threw error '${e}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(p.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(i){let e=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===te.WebSockets)this.transport=this._constructTransport(te.WebSockets),await this._startTransport(e,i);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else{let t=null,o=0;do{if(t=await this._getNegotiationResponse(e),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new ue("The connection was stopped during negotiation.");if(t.error)throw new Error(t.error);if(t.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(t.url&&(e=t.url),t.accessToken){let r=t.accessToken;this._accessTokenFactory=()=>r,this._httpClient._accessToken=r,this._httpClient._accessTokenFactory=void 0}o++}while(t.url&&o<oa);if(o===oa&&t.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(e,this._options.transport,t,i)}this.transport instanceof Hi&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(p.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(t){return this._logger.log(p.Error,"Failed to start the connection: "+t),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(t)}}async _getNegotiationResponse(i){let e={},[t,o]=at();e[t]=o;let r=this._resolveNegotiateUrl(i);this._logger.log(p.Debug,`Sending negotiation request: ${r}.`);try{let s=await this._httpClient.post(r,{content:"",headers:D(D({},e),this._options.headers),timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(s.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${s.statusCode}'`));let a=JSON.parse(s.content);return(!a.negotiateVersion||a.negotiateVersion<1)&&(a.connectionToken=a.connectionId),a.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new Bi("Client didn't negotiate Stateful Reconnect but the server did.")):a}catch(s){let a="Failed to complete negotiation with the server: "+s;return s instanceof Te&&s.statusCode===404&&(a=a+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(p.Error,a),Promise.reject(new Bi(a))}}_createConnectUrl(i,e){return e?i+(i.indexOf("?")===-1?"?":"&")+`id=${e}`:i}async _createTransport(i,e,t,o){let r=this._createConnectUrl(i,t.connectionToken);if(this._isITransport(e)){this._logger.log(p.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=e,await this._startTransport(r,o),this.connectionId=t.connectionId;return}let s=[],a=t.availableTransports||[],d=t;for(let f of a){let g=this._resolveTransportOrError(f,e,o,d?.useStatefulReconnect===!0);if(g instanceof Error)s.push(`${f.transport} failed:`),s.push(g);else if(this._isITransport(g)){if(this.transport=g,!d){try{d=await this._getNegotiationResponse(i)}catch(B){return Promise.reject(B)}r=this._createConnectUrl(i,d.connectionToken)}try{await this._startTransport(r,o),this.connectionId=d.connectionId;return}catch(B){if(this._logger.log(p.Error,`Failed to start the transport '${f.transport}': ${B}`),d=void 0,s.push(new Do(`${f.transport} failed: ${B}`,te[f.transport])),this._connectionState!=="Connecting"){let De="Failed to select transport before stop() was called.";return this._logger.log(p.Debug,De),Promise.reject(new ue(De))}}}}return s.length>0?Promise.reject(new Oo(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(i){switch(i){case te.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new $o(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case te.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Ho(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case te.LongPolling:return new Hi(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${i}.`)}}_startTransport(i,e){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async t=>{let o=!1;if(this.features.reconnect)try{this.features.disconnected(),await this.transport.connect(i,e),await this.features.resend()}catch{o=!0}else{this._stopConnection(t);return}o&&this._stopConnection(t)}:this.transport.onclose=t=>this._stopConnection(t),this.transport.connect(i,e)}_resolveTransportOrError(i,e,t,o){let r=te[i.transport];if(r==null)return this._logger.log(p.Debug,`Skipping transport '${i.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${i.transport}' because it is not supported by this client.`);if(Lc(e,r))if(i.transferFormats.map(a=>ie[a]).indexOf(t)>=0){if(r===te.WebSockets&&!this._options.WebSocket||r===te.ServerSentEvents&&!this._options.EventSource)return this._logger.log(p.Debug,`Skipping transport '${te[r]}' because it is not supported in your environment.'`),new Po(`'${te[r]}' is not supported in your environment.`,r);this._logger.log(p.Debug,`Selecting transport '${te[r]}'.`);try{return this.features.reconnect=r===te.WebSockets?o:void 0,this._constructTransport(r)}catch(a){return a}}else return this._logger.log(p.Debug,`Skipping transport '${te[r]}' because it does not support the requested transfer format '${ie[t]}'.`),new Error(`'${te[r]}' does not support ${ie[t]}.`);else return this._logger.log(p.Debug,`Skipping transport '${te[r]}' because it was disabled by the client.`),new Eo(`'${te[r]}' is disabled by the client.`,r)}_isITransport(i){return i&&typeof i=="object"&&"connect"in i}_stopConnection(i){if(this._logger.log(p.Debug,`HttpConnection.stopConnection(${i}) called while in state ${this._connectionState}.`),this.transport=void 0,i=this._stopError||i,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log(p.Debug,`Call to HttpConnection.stopConnection(${i}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log(p.Warning,`Call to HttpConnection.stopConnection(${i}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${i}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),i?this._logger.log(p.Error,`Connection disconnected with error '${i}'.`):this._logger.log(p.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(e=>{this._logger.log(p.Error,`TransportSendQueue.stop() threw error '${e}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(i)}catch(e){this._logger.log(p.Error,`HttpConnection.onclose(${i}) threw error '${e}'.`)}}}_resolveUrl(i){if(i.lastIndexOf("https://",0)===0||i.lastIndexOf("http://",0)===0)return i;if(!$.isBrowser)throw new Error(`Cannot resolve '${i}'.`);let e=window.document.createElement("a");return e.href=i,this._logger.log(p.Information,`Normalizing '${i}' to '${e.href}'.`),e.href}_resolveNegotiateUrl(i){let e=new URL(i);e.pathname.endsWith("/")?e.pathname+="negotiate":e.pathname+="/negotiate";let t=new URLSearchParams(e.searchParams);return t.has("negotiateVersion")||t.append("negotiateVersion",this._negotiateVersion.toString()),t.has("useStatefulReconnect")?t.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&t.append("useStatefulReconnect","true"),e.search=t.toString(),e.toString()}};function Lc(n,i){return!n||(i&n)!==0}var On=class n{constructor(i){this._transport=i,this._buffer=[],this._executing=!0,this._sendBufferedData=new bi,this._transportResult=new bi,this._sendLoopPromise=this._sendLoop()}send(i){return this._bufferData(i),this._transportResult||(this._transportResult=new bi),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(i){if(this._buffer.length&&typeof this._buffer[0]!=typeof i)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof i}`);this._buffer.push(i),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new bi;let i=this._transportResult;this._transportResult=void 0;let e=typeof this._buffer[0]=="string"?this._buffer.join(""):n._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(e),i.resolve()}catch(t){i.reject(t)}}}static _concatBuffers(i){let e=i.map(r=>r.byteLength).reduce((r,s)=>r+s),t=new Uint8Array(e),o=0;for(let r of i)t.set(new Uint8Array(r),o),o+=r.byteLength;return t.buffer}},bi=class{constructor(){this.promise=new Promise((i,e)=>[this._resolver,this._rejecter]=[i,e])}resolve(){this._resolver()}reject(i){this._rejecter(i)}};var Nc="json",Wo=class{constructor(){this.name=Nc,this.version=2,this.transferFormat=ie.Text}parseMessages(i,e){if(typeof i!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!i)return[];e===null&&(e=st.instance);let t=ke.parse(i),o=[];for(let r of t){let s=JSON.parse(r);if(typeof s.type!="number")throw new Error("Invalid payload.");switch(s.type){case P.Invocation:this._isInvocationMessage(s);break;case P.StreamItem:this._isStreamItemMessage(s);break;case P.Completion:this._isCompletionMessage(s);break;case P.Ping:break;case P.Close:break;case P.Ack:this._isAckMessage(s);break;case P.Sequence:this._isSequenceMessage(s);break;default:e.log(p.Information,"Unknown message type '"+s.type+"' ignored.");continue}o.push(s)}return o}writeMessage(i){return ke.write(JSON.stringify(i))}_isInvocationMessage(i){this._assertNotEmptyString(i.target,"Invalid payload for Invocation message."),i.invocationId!==void 0&&this._assertNotEmptyString(i.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(i){if(this._assertNotEmptyString(i.invocationId,"Invalid payload for StreamItem message."),i.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(i){if(i.result&&i.error)throw new Error("Invalid payload for Completion message.");!i.result&&i.error&&this._assertNotEmptyString(i.error,"Invalid payload for Completion message."),this._assertNotEmptyString(i.invocationId,"Invalid payload for Completion message.")}_isAckMessage(i){if(typeof i.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(i){if(typeof i.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(i,e){if(typeof i!="string"||i==="")throw new Error(e)}};var jc={trace:p.Trace,debug:p.Debug,info:p.Information,information:p.Information,warn:p.Warning,warning:p.Warning,error:p.Error,critical:p.Critical,none:p.None};function Vc(n){let i=jc[n.toLowerCase()];if(typeof i<"u")return i;throw new Error(`Unknown log level: ${n}`)}var $i=class{configureLogging(i){if(z.isRequired(i,"logging"),Bc(i))this.logger=i;else if(typeof i=="string"){let e=Vc(i);this.logger=new Lt(e)}else this.logger=new Lt(i);return this}withUrl(i,e){return z.isRequired(i,"url"),z.isNotEmpty(i,"url"),this.url=i,typeof e=="object"?this.httpConnectionOptions=D(D({},this.httpConnectionOptions),e):this.httpConnectionOptions=xe(D({},this.httpConnectionOptions),{transport:e}),this}withHubProtocol(i){return z.isRequired(i,"protocol"),this.protocol=i,this}withAutomaticReconnect(i){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return i?Array.isArray(i)?this.reconnectPolicy=new zi(i):this.reconnectPolicy=i:this.reconnectPolicy=new zi,this}withServerTimeout(i){return z.isRequired(i,"milliseconds"),this._serverTimeoutInMilliseconds=i,this}withKeepAliveInterval(i){return z.isRequired(i,"milliseconds"),this._keepAliveIntervalInMilliseconds=i,this}withStatefulReconnect(i){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=i?.bufferSize,this}build(){let i=this.httpConnectionOptions||{};if(i.logger===void 0&&(i.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");let e=new Uo(this.url,i);return Vo.create(e,this.logger||st.instance,this.protocol||new Wo,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}};function Bc(n){return n.log!==void 0}var na="https://localhost:7113",Hc="https://localhost:7113/api";function ra(){return`${Hc}/Mosaic/PolygonTriangulationMesh`}var qo=class n{getVertices(){return[this.a,this.b,this.c]}static restore(i){Object.setPrototypeOf(i,n.prototype),i.getVertices().forEach(e=>j.restore(e))}};var Go=class{static restore(i){i.parts.forEach(e=>Ui.restore(e))}},Ui=class{static restore(i){i.triangles.forEach(e=>qo.restore(e)),i.contour.forEach(e=>j.restore(e))}};var sa=(()=>{class n{constructor(){this.sectionsMeshReceivedSub=new S,this.sectionsMeshReceived$=this.sectionsMeshReceivedSub.asObservable(),this.sectionGeneratedSub=new S,this.sectionGenerated$=this.sectionGeneratedSub.asObservable(),this.generationFinishedSub=new S,this.generationFinished$=this.generationFinishedSub.asObservable(),this.generationAbortedWithErrorSub=new S,this.generationAbortedWithError$=this.generationAbortedWithErrorSub.asObservable(),this.isClosed=!1,this.hubConnection=new $i().withUrl(`${na}/process-hub`,{skipNegotiation:!0,transport:te.WebSockets}).build(),this.subscribeOnSectionGenerated(),this.subscribeOnFinishGeneration(),this.subscribeOnSectionsMeshReceived(),this.subscribeOnAbortGenerationInErrorCase()}subscribeOnSectionGenerated(){this.hubConnection.on("ReceiveMosaicSectionTiles",e=>this.sectionGeneratedSub.next(e))}subscribeOnFinishGeneration(){this.hubConnection.on("ReceiveFinishNotification",()=>this.generationFinishedSub.next())}subscribeOnAbortGenerationInErrorCase(){this.hubConnection.on("AbortGenerationInErrorCase",()=>this.generationAbortedWithErrorSub.next())}subscribeOnSectionsMeshReceived(){this.hubConnection.on("ReceiveMosaicSectorsMesh",e=>{e.forEach(t=>Go.restore(t)),this.sectionsMeshReceivedSub.next(e)})}startLongRunningTask(e){return this.hubConnection.invoke("StartMosaicGeneration",e).catch(t=>{if(!this.isClosed)throw t})}initMosaicTriangulation(e){return this.hubConnection.invoke("InitMosaicTriangulation",e).catch(t=>{if(!this.isClosed)throw t})}startConnection(){return this.hubConnection.start()}stopConnection(){return this.isClosed=!0,this.hubConnection.stop()}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Qo=class{constructor(i){this.visualObjects=[],this.sections=[],this.tilesSub=new Ge([]),this.tiles$=this.tilesSub.asObservable(),this.areTilesVisible=!0,this.schema=i}addSection(i){this.sections.push(i),i.tiles.forEach(e=>e.tileObject.setVisibility(this.areTilesVisible)),this.tilesSub.next(this.sections.flatMap(e=>e.tiles))}setSectorMeshVisibility(i){for(let e of this.visualObjects)e.setVisibility(i)}setSectorVisualObjects(i){this.visualObjects.forEach(e=>e.removeObject()),this.visualObjects=i}setTilesVisibility(i){this.areTilesVisible=i;let e=this.tilesSub.value;e.length&&(e.forEach(t=>t.tileObject.setVisibility(this.areTilesVisible)),e[0].tileObject.parentCanvas.redraw())}};var Wi=(()=>{class n{constructor(){this.sectorsInfo=new Map,this.sectorsSub=new S,this.sectors$=this.sectorsSub.asObservable()}buildInitMosaicRequest(e,t,o){return{base64Image:e,mosaicWidth:t.width,sectorsGenerationParams:o.map(r=>({id:r.id,tileMargin:r.properties.tilesMargin,tileMinRadius:r.properties.minTileRadius,tileMaxRadius:r.properties.maxTileRadius,triangulationData:{polygonVertices:r.vertices,sectionMaxArea:r.properties.sectionMaxArea,sectionMinAngle:r.properties.sectionMinAngle},evaluationParams:r.properties.evaluationParams,populationParams:r.properties.populationParams}))}}initGeneratedSectorsData(e){for(let t of e)this.sectorsInfo.set(t.id,new Qo(t));this.sectorsSub.next(Array.from(this.sectorsInfo.values()))}fillSectorsGenerationInfo(e){for(let t of e){let o=this.sectorsInfo.get(t.sectorId);o.countOfSections=t.parts.flatMap(r=>r.triangles).length}this.sectorsSub.next(Array.from(this.sectorsInfo.values()))}addSectionTilesObjects(e,t){this.sectorsInfo.get(e).addSection({tiles:t})}getSectorById(e){return this.sectorsInfo.get(e)}getSectors(){return Array.from(this.sectorsInfo.values())}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();function $c(n,i){if(n&1&&(h(0,"div",7)(1,"span",9),u(2),m()()),n&2){let e=i.$implicit;c(2),E(" ",e.tileTransform.tileId," ")}}function Uc(n,i){n&1&&(h(0,"span",8),u(1),_(2,"translate"),m()),n&2&&(c(),v(b(2,1,"tool.generation.sectorList.noTiles")))}var aa=(()=>{class n{constructor(){this.sector=me.required(),this.isOpen=O(!1),this.items$=de(()=>this.sector().tiles$),this.areTilesVisible=O(!0),this.translate=l(J)}toggleTilesList(){this.isOpen.update(e=>!e)}toggleTilesVisibility(){this.areTilesVisible.update(e=>!e),this.sector().setTilesVisibility(this.areTilesVisible())}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-sector-list-elem"]],inputs:{sector:[1,"sector"]},decls:15,vars:8,consts:[[1,"parent-elem"],[1,"sector-actions"],["mat-icon-button","",1,"sector-action",3,"click"],[1,"visibility-icon","material-symbols-outlined"],["mat-icon-button","",1,"sector-action","toggle-action",3,"click"],[1,"chevron"],[1,"panel",3,"isOpen"],[1,"tile"],[1,"empty"],[1,"label"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"span"),u(2),m(),h(3,"div",1)(4,"button",2),x("click",function(){return o.toggleTilesVisibility()}),h(5,"mat-icon",3),u(6),m()(),h(7,"button",4),x("click",function(){return o.toggleTilesList()}),h(8,"mat-icon",5),u(9," keyboard_arrow_up "),m()()()(),h(10,"app-expandable-panel",6),Se(11,$c,3,1,"div",7,vt,!1,Uc,3,3,"span",8),_(14,"async"),m()),t&2&&(c(2),v(o.sector().schema.name),c(4),E(" ",o.areTilesVisible()?"visibility":"visibility_off"," "),c(2),F("chevron--closed",!o.isOpen()),c(2),y("isOpen",o.isOpen()),c(),we(b(14,6,o.items$())))},dependencies:[Ne,Le,V,Ve,pi,K,to,ee],styles:["[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}[_nghost-%COMP%]   .parent-elem.selected[_ngcontent-%COMP%]{background:var(--irr-contrast-light)}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:12px}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .visibility-icon[_ngcontent-%COMP%]{font-weight:300;color:var(--irr-contrast-medium)}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .sector-action[_ngcontent-%COMP%]     .mat-icon{width:24px;height:24px;font-size:24px}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .sector-action[_ngcontent-%COMP%]    {--mat-icon-button-state-layer-size: 32px;padding:4px}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .sector-action[_ngcontent-%COMP%]     .mat-mdc-button-touch-target{width:var(--mat-icon-button-state-layer-size);height:var(--mat-icon-button-state-layer-size)}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .sector-action[_ngcontent-%COMP%]{margin:-6px}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .toggle-action[_ngcontent-%COMP%]{color:var(--irr-contrast-medium)}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .toggle-action[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:all .25s ease}[_nghost-%COMP%]   .parent-elem[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]   .toggle-action[_ngcontent-%COMP%]   .chevron--closed[_ngcontent-%COMP%]{transform:rotate(180deg)}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{overflow:hidden;display:flex;flex-direction:column;gap:6px}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]   .tile.selected[_ngcontent-%COMP%]{background:var(--irr-contrast-light)}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap;font-size:12px}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{align-self:center;color:var(--irr-contrast-light)}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{margin-top:6px}"],changeDetection:0})}}return n})();function Wc(n,i){if(n&1&&w(0,"app-sector-list-elem",1),n&2){let e=i.$implicit;y("sector",e)}}var la=(()=>{class n{constructor(){this.service=l(Wi)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-mosaic-hierarchy"]],decls:4,vars:2,consts:[[1,"sectors"],[3,"sector"]],template:function(t,o){t&1&&(h(0,"div",0),Se(1,Wc,1,1,"app-sector-list-elem",1,vt),_(3,"async"),m()),t&2&&(c(),we(b(3,0,o.service.sectors$)))},dependencies:[aa,to],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .sectors[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}"],changeDetection:0})}}return n})();function qc(n,i){if(n&1&&(lt(0,"span",0),u(1),ct(),lt(2,"span",1),u(3),ct()),n&2){M();let e=sn(0);c(),v(e.sector),c(2),E("",e.percent,"%")}}function Gc(n,i){if(n&1&&(lt(0,"span",0),u(1),ct()),n&2){M();let e=sn(0);c(),v(e.message)}}var ca=(()=>{class n{constructor(){this.infoState=me.required()}isProgressInfo(e){return e.type==="progress"}isInitInfo(e){return e.type==="init"}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-progress-info"]],inputs:{infoState:[1,"infoState"]},decls:3,vars:2,consts:[[1,"loading"],[1,"right"]],template:function(t,o){if(t&1&&(ar(0),R(1,qc,4,2)(2,Gc,2,1,"span",0)),t&2){let r=lr(o.infoState());c(),A(o.isProgressInfo(r)?1:o.isInitInfo(r)?2:-1)}},styles:['.loading[_ngcontent-%COMP%]:after{content:"";animation:_ngcontent-%COMP%_dots 2s linear infinite}@keyframes _ngcontent-%COMP%_dots{0%,20%{content:"."}40%{content:".."}60%{content:"..."}90%,to{content:""}}[_nghost-%COMP%]{display:flex;width:200px;height:auto;font-size:14px;border:1px solid;padding:12px;border-radius:4px;border-color:transparent;background:#ccc;opacity:.75;color:#141414;box-shadow:0 3px 5px -1px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}[_nghost-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:auto}'],changeDetection:0})}}return n})();function Qc(n,i){if(n&1&&w(0,"app-progress-info",0),n&2){let e=M();y("infoState",e.progressState())}}var da=(()=>{class n{constructor(){this.toolService=l(Ee),this.isImageVisible=O(!1),this.isMeshVisible=O(!0),this.showMesh$=new Ge(!0),this.progressState=O(null),this.ribbonActions=[{iconName:"crop",visibility:O("on"),onClick:()=>this.toolService.openTakeSnapshotDialog(this.activeCanvas,"generating_snapshot.png")},{iconName:"recenter",visibility:O("on"),onClick:()=>{this.focusOnImage(),this.activeCanvas.redraw()}},{iconName:"graph_3",onClick:()=>this.toggleMeshVisibility(),visibility:de(()=>this.isMeshVisible()?"on":"off")},{iconName:"image",onClick:()=>this.toggleImageVisibility(),visibility:de(()=>this.isImageVisible()?"on":"off")}],this.store=l(N),this.translate=l(J),this.destroyRef=l(G),this.snackBar=l(nt),this.signalRService=l(sa),this.service=l(Wi)}ngOnInit(){this.subscribeOnGenerationProgress(),this.subscribeOnSectorsMeshReceived(),this.subscribeOnMeshGenerationFinished(),this.subscribeOnMeshVisibilityChange(),this.destroyRef.onDestroy(()=>this.signalRService.stopConnection())}async onCanvasReady(e){let t=this.store.selectSignal(Je)();this.imageObject=await Ee.createImageObject(t),this.imageObject.setVisibility(this.isImageVisible()),this.activeCanvas.addCanvasObject(this.imageObject),e&&this.focusOnImage(),this.activeCanvas.redraw(),this.initSectors(),this.initGeneration(t.base64Image,this.imageObject.size)}initGeneration(e,t){this.signalRService.startConnection().then(()=>{let o=this.store.selectSignal(be)(),r=this.service.buildInitMosaicRequest(e,t,o);this.availableTiles=this.getAvailableTiles(),this.progressState.set({type:"init",message:this.translate.instant("tool.generation.message.sectorsMeshGeneration")}),this.signalRService.initMosaicTriangulation(r).catch(()=>this.setError(this.translate.instant("tool.generation.message.errorOnSectorsMeshGeneration")))}).catch(()=>this.setError(this.translate.instant("tool.generation.message.errorOnServerConnection")))}subscribeOnGenerationProgress(){this.signalRService.sectionGenerated$.pipe(H(this.destroyRef)).subscribe(e=>{let t=[];for(let r of e.tilesTransforms){let s=this.availableTiles.find(f=>f.id===r.tileId),a=yo(s.vertices,r.position,r.angle),d=new mi(a,s.color);this.activeCanvas.addCanvasObject(d),t.push({tileObject:d,tileTransform:r})}let o=this.service.getSectorById(e.sectorId);this.service.addSectionTilesObjects(e.sectorId,t),this.progressState.set({type:"progress",sector:o.schema.name,percent:Math.floor(o.sections.length/o.countOfSections*100)}),this.activeCanvas.redraw()})}subscribeOnSectorsMeshReceived(){this.signalRService.sectionsMeshReceived$.pipe(H(this.destroyRef)).subscribe(e=>{let t=this.store.selectSignal(be)();this.createSectorsMeshCanvasObjects(e,t),this.service.fillSectorsGenerationInfo(e);let o=this.availableTiles.map(r=>({color:r.color,id:r.id,vertices:r.vertices}));this.signalRService.startLongRunningTask(o).catch(()=>this.showMessage(this.translate.instant("tool.generation.message.errorOnStartingMosaicGeneration")))})}subscribeOnMeshGenerationFinished(){this.signalRService.generationFinished$.pipe(H(this.destroyRef)).subscribe(()=>{this.progressState.set(null),this.showMessage(this.translate.instant("tool.generation.message.generationCompleted"))})}subscribeOnMeshVisibilityChange(){this.showMesh$.pipe(H(this.destroyRef)).subscribe(e=>{for(let t of this.service.getSectors())t.setSectorMeshVisibility(e);this.activeCanvas.redraw()})}createSectorsMeshCanvasObjects(e,t){for(let o=0;o<t.length;++o){let r=t[o],s=this.service.getSectorById(r.id),a=[];for(let d of e[o].parts){let f=this.createSectorMeshObject(r,d,o);this.activeCanvas.addCanvasObject(f),a.push(f)}s.setSectorVisualObjects(a)}this.activeCanvas.redraw()}initSectors(){let e=this.store.selectSignal(be)();this.service.initGeneratedSectorsData(e),this.initSectorsMeshes(e)}initSectorsMeshes(e){for(let t=0;t<e.length;++t){let o=this.service.getSectorById(e[t].id),r=this.createSectorContourObject(e[t],t);this.activeCanvas.addCanvasObject(r),o.visualObjects.push(r)}this.activeCanvas.redraw()}createSectorMeshObject(e,t,o){return new fi(t.triangles,t.contour,e.color,10+o)}createSectorContourObject(e,t){return new gi([...e.vertices],e.color,10+t)}getAvailableTiles(){return this.store.selectSignal(et)().flatMap(t=>t.tiles)}toggleMeshVisibility(){let e=!this.isMeshVisible();this.showMesh$.next(e),this.isMeshVisible.set(e)}toggleImageVisibility(){let e=!this.isImageVisible();this.imageObject.setVisibility(e),this.activeCanvas.redraw(),this.isImageVisible.set(e)}setError(e){this.progressState.set(null),this.showMessage(e)}showMessage(e){this.snackBar.open(e,this.translate.instant("common.ok"),{duration:3e3})}sectionEntered(e,t){return this.activeCanvas=e,this.onCanvasReady(t),{ribbon:this.ribbonActions}}focusOnImage(){let e=Ee.calculateZoomForImage(this.imageObject.size,this.activeCanvas.viewport);this.activeCanvas.setViewport(e,j.zero)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-mosaic-generation"]],features:[ce([Wi])],decls:2,vars:1,consts:[[1,"info",3,"infoState"]],template:function(t,o){t&1&&(w(0,"app-mosaic-hierarchy"),R(1,Qc,1,1,"app-progress-info",0)),t&2&&(c(),A(o.progressState()?1:-1))},dependencies:[la,ca],styles:["[_nghost-%COMP%]{display:block;box-sizing:border-box;height:100%;padding:20px 10px;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .info[_ngcontent-%COMP%]{position:absolute;left:-250px;bottom:30px}"],changeDetection:0})}}return n})();var ma=()=>l(N).selectSignal(be)().length?!0:(l(X).navigate([xo]),!1);function In(n){let i=n.cloneNode(!0),e=i.querySelectorAll("[id]"),t=n.nodeName.toLowerCase();i.removeAttribute("id");for(let o=0;o<e.length;o++)e[o].removeAttribute("id");return t==="canvas"?ua(n,i):(t==="input"||t==="select"||t==="textarea")&&pa(n,i),ha("canvas",n,i,ua),ha("input, textarea, select",n,i,pa),i}function ha(n,i,e,t){let o=i.querySelectorAll(n);if(o.length){let r=e.querySelectorAll(n);for(let s=0;s<o.length;s++)t(o[s],r[s])}}var Kc=0;function pa(n,i){i.type!=="file"&&(i.value=n.value),i.type==="radio"&&i.name&&(i.name=`mat-clone-${i.name}-${Kc++}`)}function ua(n,i){let e=i.getContext("2d");if(e)try{e.drawImage(n,0,0)}catch{}}function jn(n){let i=n.getBoundingClientRect();return{top:i.top,right:i.right,bottom:i.bottom,left:i.left,width:i.width,height:i.height,x:i.x,y:i.y}}function Rn(n,i,e){let{top:t,bottom:o,left:r,right:s}=n;return e>=t&&e<=o&&i>=r&&i<=s}function Zc(n,i){let e=i.left<n.left,t=i.left+i.width>n.right,o=i.top<n.top,r=i.top+i.height>n.bottom;return e||t||o||r}function Qi(n,i,e){n.top+=i,n.bottom=n.top+n.height,n.left+=e,n.right=n.left+n.width}function fa(n,i,e,t){let{top:o,right:r,bottom:s,left:a,width:d,height:f}=n,g=d*i,B=f*i;return t>o-B&&t<s+B&&e>a-g&&e<r+g}var Ko=class{_document;positions=new Map;constructor(i){this._document=i}clear(){this.positions.clear()}cache(i){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),i.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:jn(e)})})}handleScroll(i){let e=At(i),t=this.positions.get(e);if(!t)return null;let o=t.scrollPosition,r,s;if(e===this._document){let f=this.getViewportScrollPosition();r=f.top,s=f.left}else r=e.scrollTop,s=e.scrollLeft;let a=o.top-r,d=o.left-s;return this.positions.forEach((f,g)=>{f.clientRect&&e!==g&&e.contains(g)&&Qi(f.clientRect,a,d)}),o.top=r,o.left=s,{top:a,left:d}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function Da(n,i){let e=n.rootNodes;if(e.length===1&&e[0].nodeType===i.ELEMENT_NODE)return e[0];let t=i.createElement("div");return e.forEach(o=>t.appendChild(o)),t}function Vn(n,i,e){for(let t in i)if(i.hasOwnProperty(t)){let o=i[t];o?n.setProperty(t,o,e?.has(t)?"important":""):n.removeProperty(t)}return n}function vi(n,i){let e=i?"":"none";Vn(n.style,{"touch-action":i?"":"none","-webkit-user-drag":i?"":"none","-webkit-tap-highlight-color":i?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function ga(n,i,e){Vn(n.style,{position:i?"":"fixed",top:i?"":"0",opacity:i?"":"0",left:i?"":"-999em"},e)}function Zo(n,i){return i&&i!="none"?n+" "+i:n}function _a(n,i){n.style.width=`${i.width}px`,n.style.height=`${i.height}px`,n.style.transform=Ki(i.left,i.top)}function Ki(n,i){return`translate3d(${Math.round(n)}px, ${Math.round(i)}px, 0)`}function ba(n){let i=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*i}function Yc(n){let i=getComputedStyle(n),e=Tn(i,"transition-property"),t=e.find(a=>a==="transform"||a==="all");if(!t)return 0;let o=e.indexOf(t),r=Tn(i,"transition-duration"),s=Tn(i,"transition-delay");return ba(r[o])+ba(s[o])}function Tn(n,i){return n.getPropertyValue(i).split(",").map(t=>t.trim())}var Xc=new Set(["position"]),An=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(i,e,t,o,r,s,a,d,f,g){this._document=i,this._rootElement=e,this._direction=t,this._initialDomRect=o,this._previewTemplate=r,this._previewClass=s,this._pickupPositionOnPage=a,this._initialTransform=d,this._zIndex=f,this._renderer=g}attach(i){this._preview=this._createPreview(),i.appendChild(this._preview),va(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(i){this._preview.style.transform=i}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(i){this._preview.classList.add(i)}getTransitionDuration(){return Yc(this._preview)}addEventListener(i,e){return this._renderer.listen(this._preview,i,e)}_createPreview(){let i=this._previewTemplate,e=this._previewClass,t=i?i.template:null,o;if(t&&i){let r=i.matchSize?this._initialDomRect:null,s=i.viewContainer.createEmbeddedView(t,i.context);s.detectChanges(),o=Da(s,this._document),this._previewEmbeddedView=s,i.matchSize?_a(o,r):o.style.transform=Ki(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else o=In(this._rootElement),_a(o,this._initialDomRect),this._initialTransform&&(o.style.transform=this._initialTransform);return Vn(o.style,{"pointer-events":"none",margin:va(o)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Xc),vi(o,!1),o.classList.add("cdk-drag-preview"),o.setAttribute("popover","manual"),o.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(r=>o.classList.add(r)):o.classList.add(e)),o}};function va(n){return"showPopover"in n}var Jc={passive:!0},ya={passive:!1},ed={passive:!1,capture:!0},td=800,xa="cdk-drag-placeholder",Ca=new Set(["position"]),Fn=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=O(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new S;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=Re.EMPTY;_pointerUpSubscription=Re.EMPTY;_scrollSubscription=Re.EMPTY;_resizeSubscription=Re.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(i){i!==this._disabled&&(this._disabled=i,this._toggleNativeDragInteractions(),this._handles.forEach(e=>vi(e,i)))}_disabled=!1;beforeStarted=new S;started=new S;released=new S;ended=new S;entered=new S;exited=new S;dropped=new S;moved=this._moveEvents;data;constrainPosition;constructor(i,e,t,o,r,s,a){this._config=e,this._document=t,this._ngZone=o,this._viewportRuler=r,this._dragDropRegistry=s,this._renderer=a,this.withRootElement(i).withParent(e.parentDragRef||null),this._parentPositions=new Ko(t),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(i){this._handles=i.map(t=>je(t)),this._handles.forEach(t=>vi(t,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(t=>{this._handles.indexOf(t)>-1&&e.add(t)}),this._disabledHandles=e,this}withPreviewTemplate(i){return this._previewTemplate=i,this}withPlaceholderTemplate(i){return this._placeholderTemplate=i,this}withRootElement(i){let e=je(i);if(e!==this._rootElement){this._removeRootElementListeners();let t=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[t.listen(e,"mousedown",this._pointerDown,ya),t.listen(e,"touchstart",this._pointerDown,Jc),t.listen(e,"dragstart",this._nativeDragStart,ya)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(i){return this._boundaryElement=i?je(i):null,this._resizeSubscription.unsubscribe(),i&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(i){return this._parentDragRef=i,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&Zc(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let i=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect(),t=0,o=0;e.left<i.left?t=i.left-e.left:e.right>i.right&&(t=i.right-e.right),e.top<i.top?o=i.top-e.top:e.bottom>i.bottom&&(o=i.bottom-e.bottom);let r=this._activeTransform.x,s=this._activeTransform.y,a=r+t,d=s+o;this._rootElement.style.transform=Ki(a,d),this._activeTransform={x:a,y:d},this._passiveTransform={x:a,y:d}}}disableHandle(i){!this._disabledHandles.has(i)&&this._handles.indexOf(i)>-1&&(this._disabledHandles.add(i),vi(i,!0))}enableHandle(i){this._disabledHandles.has(i)&&(this._disabledHandles.delete(i),vi(i,this.disabled))}withDirection(i){return this._direction=i,this}_withDropContainer(i){this._dropContainer=i}getFreeDragPosition(){let i=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:i.x,y:i.y}}setFreeDragPosition(i){return this._activeTransform={x:0,y:0},this._passiveTransform.x=i.x,this._passiveTransform.y=i.y,this._dropContainer||this._applyRootElementTransform(i.x,i.y),this}withPreviewContainer(i){return this._previewContainer=i,this}_sortFromLastPointerPosition(){let i=this._lastKnownPointerPosition;i&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(i),i)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=i=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(i);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,i)}else this.disabled||this._initializeDragSequence(this._rootElement,i)};_pointerMove=i=>{let e=this._getPointerPositionOnPage(i);if(!this._hasStartedDragging()){let o=Math.abs(e.x-this._pickupPositionOnPage.x),r=Math.abs(e.y-this._pickupPositionOnPage.y);if(o+r>=this._config.dragStartThreshold){let a=Date.now()>=this._dragStartTime+this._getDragStartDelay(i),d=this._dropContainer;if(!a){this._endDragSequence(i);return}(!d||!d.isDragging()&&!d.isReceiving())&&(i.cancelable&&i.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(i)))}return}i.cancelable&&i.preventDefault();let t=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(t),this._dropContainer)this._updateActiveDropContainer(t,e);else{let o=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,r=this._activeTransform;r.x=t.x-o.x+this._passiveTransform.x,r.y=t.y-o.y+this._passiveTransform.y,this._applyRootElementTransform(r.x,r.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:t,event:i,distance:this._getDragDistance(t),delta:this._pointerDirectionDelta})})};_pointerUp=i=>{this._endDragSequence(i)};_endDragSequence(i){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:i}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(i),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(i);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:i})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(i){qi(i)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),t=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",id,ed)}),t){let o=this._rootElement,r=o.parentNode,s=this._placeholder=this._createPlaceholderElement(),a=this._marker=this._marker||this._document.createComment("");r.insertBefore(a,o),this._initialTransform=o.style.transform||"",this._preview=new An(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(r,e)),ga(o,!1,Ca),this._document.body.appendChild(r.replaceChild(s,o)),this.started.next({source:this,event:i}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:i}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(i,e){this._parentDragRef&&e.stopPropagation();let t=this.isDragging(),o=qi(e),r=!o&&e.button!==0,s=this._rootElement,a=At(e),d=!o&&this._lastTouchEventTime&&this._lastTouchEventTime+td>Date.now(),f=o?br(e):_r(e);if(a&&a.draggable&&e.type==="mousedown"&&e.preventDefault(),t||r||d||f)return;if(this._handles.length){let De=s.style;this._rootElementTapHighlight=De.webkitTapHighlightColor||"",De.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(De=>this._updateOnScroll(De)),this._boundaryElement&&(this._boundaryRect=jn(this._boundaryElement));let g=this._previewTemplate;this._pickupPositionInElement=g&&g.template&&!g.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,i,e);let B=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:B.x,y:B.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(i){ga(this._rootElement,!0,Ca),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,t=e.getItemIndex(this),o=this._getPointerPositionOnPage(i),r=this._getDragDistance(o),s=e._isOverContainer(o.x,o.y);this.ended.next({source:this,distance:r,dropPoint:o,event:i}),this.dropped.next({item:this,currentIndex:t,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:r,dropPoint:o,event:i}),e.drop(this,t,this._initialIndex,this._initialContainer,s,r,o,i),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:i,y:e},{x:t,y:o}){let r=this._initialContainer._getSiblingContainerFromPosition(this,i,e);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(i,e)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),a=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(r,this._dropContainer,a),this._dropContainer=r,this._dropContainer.enter(this,i,e,r===this._initialContainer&&r.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:r,currentIndex:r.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(t,o),this._dropContainer._sortItem(this,i,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(i,e):this._applyPreviewTransform(i-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let i=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(i.left,i.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{let o=a=>{(!a||this._preview&&At(a)===this._preview.element&&a.propertyName==="transform")&&(s(),t(),clearTimeout(r))},r=setTimeout(o,e*1.5),s=this._preview.addEventListener("transitionend",o)}))}_createPlaceholderElement(){let i=this._placeholderTemplate,e=i?i.template:null,t;return e?(this._placeholderRef=i.viewContainer.createEmbeddedView(e,i.context),this._placeholderRef.detectChanges(),t=Da(this._placeholderRef,this._document)):t=In(this._rootElement),t.style.pointerEvents="none",t.classList.add(xa),t}_getPointerPositionInElement(i,e,t){let o=e===this._rootElement?null:e,r=o?o.getBoundingClientRect():i,s=qi(t)?t.targetTouches[0]:t,a=this._getViewportScrollPosition(),d=s.pageX-r.left-a.left,f=s.pageY-r.top-a.top;return{x:r.left-i.left+d,y:r.top-i.top+f}}_getPointerPositionOnPage(i){let e=this._getViewportScrollPosition(),t=qi(i)?i.touches[0]||i.changedTouches[0]||{pageX:0,pageY:0}:i,o=t.pageX-e.left,r=t.pageY-e.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let a=this._ownerSVGElement.createSVGPoint();return a.x=o,a.y=r,a.matrixTransform(s.inverse())}}return{x:o,y:r}}_getConstrainedPointerPosition(i){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:t,y:o}=this.constrainPosition?this.constrainPosition(i,this,this._initialDomRect,this._pickupPositionInElement):i;if(this.lockAxis==="x"||e==="x"?o=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(t=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:r,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:d,height:f}=this._getPreviewRect(),g=a.top+s,B=a.bottom-(f-s),De=a.left+r,yi=a.right-(d-r);t=Sa(t,De,yi),o=Sa(o,g,B)}return{x:t,y:o}}_updatePointerDirectionDelta(i){let{x:e,y:t}=i,o=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,s=Math.abs(e-r.x),a=Math.abs(t-r.y);return s>this._config.pointerDirectionChangeThreshold&&(o.x=e>r.x?1:-1,r.x=e),a>this._config.pointerDirectionChangeThreshold&&(o.y=t>r.y?1:-1,r.y=t),o}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let i=this._handles.length>0||!this.isDragging();i!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=i,vi(this._rootElement,i))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(i=>i()),this._rootElementCleanups=void 0}_applyRootElementTransform(i,e){let t=1/this.scale,o=Ki(i*t,e*t),r=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=r.transform&&r.transform!="none"?r.transform:""),r.transform=Zo(o,this._initialTransform)}_applyPreviewTransform(i,e){let t=this._previewTemplate?.template?void 0:this._initialTransform,o=Ki(i,e);this._preview.setTransform(Zo(o,t))}_getDragDistance(i){let e=this._pickupPositionOnPage;return e?{x:i.x-e.x,y:i.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:i,y:e}=this._passiveTransform;if(i===0&&e===0||this.isDragging()||!this._boundaryElement)return;let t=this._rootElement.getBoundingClientRect(),o=this._boundaryElement.getBoundingClientRect();if(o.width===0&&o.height===0||t.width===0&&t.height===0)return;let r=o.left-t.left,s=t.right-o.right,a=o.top-t.top,d=t.bottom-o.bottom;o.width>t.width?(r>0&&(i+=r),s>0&&(i-=s)):i=0,o.height>t.height?(a>0&&(e+=a),d>0&&(e-=d)):e=0,(i!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:i})}_getDragStartDelay(i){let e=this.dragStartDelay;return typeof e=="number"?e:qi(i)?e.touch:e?e.mouse:0}_updateOnScroll(i){let e=this._parentPositions.handleScroll(i);if(e){let t=At(i);this._boundaryRect&&t!==this._boundaryElement&&t.contains(this._boundaryElement)&&Qi(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=io(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(i,e){let t=this._previewContainer||"global";if(t==="parent")return i;if(t==="global"){let o=this._document;return e||o.fullscreenElement||o.webkitFullscreenElement||o.mozFullScreenElement||o.msFullscreenElement||o.body}return je(t)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=i=>{if(this._handles.length){let e=this._getTargetHandle(i);e&&!this._disabledHandles.has(e)&&!this.disabled&&i.preventDefault()}else this.disabled||i.preventDefault()};_getTargetHandle(i){return this._handles.find(e=>i.target&&(i.target===e||e.contains(i.target)))}_conditionallyInsertAnchor(i,e,t){if(i===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){let o=this._anchor??=In(this._placeholder);o.classList.remove(xa),o.classList.add("cdk-drag-anchor"),o.style.transform="",t?t.before(o):je(e.element).appendChild(o)}}};function Sa(n,i,e){return Math.max(i,Math.min(e,n))}function qi(n){return n.type[0]==="t"}function id(n){n.preventDefault()}function Xo(n,i,e){let t=wa(i,n.length-1),o=wa(e,n.length-1);if(t===o)return;let r=n[t],s=o<t?-1:1;for(let a=t;a!==o;a+=s)n[a]=n[a+s];n[o]=r}function wa(n,i){return Math.max(0,Math.min(i,n))}var Yo=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(i){this._dragDropRegistry=i}_previousSwap={drag:null,delta:0,overlaps:!1};start(i){this.withItems(i)}sort(i,e,t,o){let r=this._itemPositions,s=this._getItemIndexFromPointerPosition(i,e,t,o);if(s===-1&&r.length>0)return null;let a=this.orientation==="horizontal",d=r.findIndex(Ie=>Ie.drag===i),f=r[s],g=r[d].clientRect,B=f.clientRect,De=d>s?1:-1,yi=this._getItemOffsetPx(g,B,De),on=this._getSiblingOffsetPx(d,r,De),nn=r.slice();return Xo(r,d,s),r.forEach((Ie,Ha)=>{if(nn[Ha]===Ie)return;let zn=Ie.drag===i,rn=zn?yi:on,Hn=zn?i.getPlaceholderElement():Ie.drag.getRootElement();Ie.offset+=rn;let $n=Math.round(Ie.offset*(1/Ie.drag.scale));a?(Hn.style.transform=Zo(`translate3d(${$n}px, 0, 0)`,Ie.initialTransform),Qi(Ie.clientRect,0,rn)):(Hn.style.transform=Zo(`translate3d(0, ${$n}px, 0)`,Ie.initialTransform),Qi(Ie.clientRect,rn,0))}),this._previousSwap.overlaps=Rn(B,e,t),this._previousSwap.drag=f.drag,this._previousSwap.delta=a?o.x:o.y,{previousIndex:d,currentIndex:s}}enter(i,e,t,o){let r=o==null||o<0?this._getItemIndexFromPointerPosition(i,e,t):o,s=this._activeDraggables,a=s.indexOf(i),d=i.getPlaceholderElement(),f=s[r];if(f===i&&(f=s[r+1]),!f&&(r==null||r===-1||r<s.length-1)&&this._shouldEnterAsFirstChild(e,t)&&(f=s[0]),a>-1&&s.splice(a,1),f&&!this._dragDropRegistry.isDragging(f)){let g=f.getRootElement();g.parentElement.insertBefore(d,g),s.splice(r,0,i)}else this._element.appendChild(d),s.push(i);d.style.transform="",this._cacheItemPositions()}withItems(i){this._activeDraggables=i.slice(),this._cacheItemPositions()}withSortPredicate(i){this._sortPredicate=i}reset(){this._activeDraggables?.forEach(i=>{let e=i.getRootElement();if(e){let t=this._itemPositions.find(o=>o.drag===i)?.initialTransform;e.style.transform=t||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(i){return this._getVisualItemPositions().findIndex(e=>e.drag===i)}getItemAtIndex(i){return this._getVisualItemPositions()[i]?.drag||null}updateOnScroll(i,e){this._itemPositions.forEach(({clientRect:t})=>{Qi(t,i,e)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(i){this._element=i}_cacheItemPositions(){let i=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let t=e.getVisibleElement();return{drag:e,offset:0,initialTransform:t.style.transform||"",clientRect:jn(t)}}).sort((e,t)=>i?e.clientRect.left-t.clientRect.left:e.clientRect.top-t.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(i,e,t){let o=this.orientation==="horizontal",r=o?e.left-i.left:e.top-i.top;return t===-1&&(r+=o?e.width-i.width:e.height-i.height),r}_getSiblingOffsetPx(i,e,t){let o=this.orientation==="horizontal",r=e[i].clientRect,s=e[i+t*-1],a=r[o?"width":"height"]*t;if(s){let d=o?"left":"top",f=o?"right":"bottom";t===-1?a-=s.clientRect[d]-r[f]:a+=r[d]-s.clientRect[f]}return a}_shouldEnterAsFirstChild(i,e){if(!this._activeDraggables.length)return!1;let t=this._itemPositions,o=this.orientation==="horizontal";if(t[0].drag!==this._activeDraggables[0]){let s=t[t.length-1].clientRect;return o?i>=s.right:e>=s.bottom}else{let s=t[0].clientRect;return o?i<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(i,e,t,o){let r=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:a,clientRect:d})=>{if(a===i)return!1;if(o){let f=r?o.x:o.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&f===this._previousSwap.delta)return!1}return r?e>=Math.floor(d.left)&&e<Math.floor(d.right):t>=Math.floor(d.top)&&t<Math.floor(d.bottom)});return s===-1||!this._sortPredicate(s,i)?-1:s}},Ln=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(i,e){this._document=i,this._dragDropRegistry=e}start(i){let e=this._element.childNodes;this._relatedNodes=[];for(let t=0;t<e.length;t++){let o=e[t];this._relatedNodes.push([o,o.nextSibling])}this.withItems(i)}sort(i,e,t,o){let r=this._getItemIndexFromPointerPosition(i,e,t),s=this._previousSwap;if(r===-1||this._activeItems[r]===i)return null;let a=this._activeItems[r];if(s.drag===a&&s.overlaps&&s.deltaX===o.x&&s.deltaY===o.y)return null;let d=this.getItemIndex(i),f=i.getPlaceholderElement(),g=a.getRootElement();r>d?g.after(f):g.before(f),Xo(this._activeItems,d,r);let B=this._getRootNode().elementFromPoint(e,t);return s.deltaX=o.x,s.deltaY=o.y,s.drag=a,s.overlaps=g===B||g.contains(B),{previousIndex:d,currentIndex:r}}enter(i,e,t,o){let r=this._activeItems.indexOf(i);r>-1&&this._activeItems.splice(r,1);let s=o==null||o<0?this._getItemIndexFromPointerPosition(i,e,t):o;s===-1&&(s=this._getClosestItemIndexToPointer(i,e,t));let a=this._activeItems[s];a&&!this._dragDropRegistry.isDragging(a)?(this._activeItems.splice(s,0,i),a.getRootElement().before(i.getPlaceholderElement())):(this._activeItems.push(i),this._element.appendChild(i.getPlaceholderElement()))}withItems(i){this._activeItems=i.slice()}withSortPredicate(i){this._sortPredicate=i}reset(){let i=this._element,e=this._previousSwap;for(let t=this._relatedNodes.length-1;t>-1;t--){let[o,r]=this._relatedNodes[t];o.parentNode===i&&o.nextSibling!==r&&(r===null?i.appendChild(o):r.parentNode===i&&i.insertBefore(o,r))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(i){return this._activeItems.indexOf(i)}getItemAtIndex(i){return this._activeItems[i]||null}updateOnScroll(){this._activeItems.forEach(i=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(i){i!==this._element&&(this._element=i,this._rootNode=void 0)}_getItemIndexFromPointerPosition(i,e,t){let o=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(t)),r=o?this._activeItems.findIndex(s=>{let a=s.getRootElement();return o===a||a.contains(o)}):-1;return r===-1||!this._sortPredicate(r,i)?-1:r}_getRootNode(){return this._rootNode||(this._rootNode=io(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(i,e,t){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let o=1/0,r=-1;for(let s=0;s<this._activeItems.length;s++){let a=this._activeItems[s];if(a!==i){let{x:d,y:f}=a.getRootElement().getBoundingClientRect(),g=Math.hypot(e-d,t-f);g<o&&(o=g,r=s)}}return r}},Ma=.05,Oa=.05,He=(function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n})(He||{}),ye=(function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n})(ye||{}),Nn=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new S;entered=new S;exited=new S;dropped=new S;sorted=new S;receivingStarted=new S;receivingStopped=new S;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Re.EMPTY;_verticalScrollDirection=He.NONE;_horizontalScrollDirection=ye.NONE;_scrollNode;_stopScrollTimers=new S;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(i,e,t,o,r){this._dragDropRegistry=e,this._ngZone=o,this._viewportRuler=r;let s=this.element=je(i);this._document=t,this.withOrientation("vertical").withElementContainer(s),e.registerDropContainer(this),this._parentPositions=new Ko(t)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(i,e,t,o){this._draggingStarted(),o==null&&this.sortingDisabled&&(o=this._draggables.indexOf(i)),this._sortStrategy.enter(i,e,t,o),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:i,container:this,currentIndex:this.getItemIndex(i)})}exit(i){this._reset(),this.exited.next({item:i,container:this})}drop(i,e,t,o,r,s,a,d={}){this._reset(),this.dropped.next({item:i,currentIndex:e,previousIndex:t,container:this,previousContainer:o,isPointerOverContainer:r,distance:s,dropPoint:a,event:d})}withItems(i){let e=this._draggables;return this._draggables=i,i.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(o=>o.isDragging()).every(o=>i.indexOf(o)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(i){return this._direction=i,this._sortStrategy instanceof Yo&&(this._sortStrategy.direction=i),this}connectedTo(i){return this._siblings=i.slice(),this}withOrientation(i){if(i==="mixed")this._sortStrategy=new Ln(this._document,this._dragDropRegistry);else{let e=new Yo(this._dragDropRegistry);e.direction=this._direction,e.orientation=i,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,t)=>this.sortPredicate(e,t,this)),this}withScrollableParents(i){let e=this._container;return this._scrollableElements=i.indexOf(e)===-1?[e,...i]:i.slice(),this}withElementContainer(i){if(i===this._container)return this;let e=je(this.element),t=this._scrollableElements.indexOf(this._container),o=this._scrollableElements.indexOf(i);return t>-1&&this._scrollableElements.splice(t,1),o>-1&&this._scrollableElements.splice(o,1),this._sortStrategy&&this._sortStrategy.withElementContainer(i),this._cachedShadowRoot=null,this._scrollableElements.unshift(i),this._container=i,this}getScrollableParents(){return this._scrollableElements}getItemIndex(i){return this._isDragging?this._sortStrategy.getItemIndex(i):this._draggables.indexOf(i)}getItemAtIndex(i){return this._isDragging?this._sortStrategy.getItemAtIndex(i):this._draggables[i]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(i,e,t,o){if(this.sortingDisabled||!this._domRect||!fa(this._domRect,Ma,e,t))return;let r=this._sortStrategy.sort(i,e,t,o);r&&this.sorted.next({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:i})}_startScrollingIfNecessary(i,e){if(this.autoScrollDisabled)return;let t,o=He.NONE,r=ye.NONE;if(this._parentPositions.positions.forEach((s,a)=>{a===this._document||!s.clientRect||t||fa(s.clientRect,Ma,i,e)&&([o,r]=od(a,s.clientRect,this._direction,i,e),(o||r)&&(t=a))}),!o&&!r){let{width:s,height:a}=this._viewportRuler.getViewportSize(),d={width:s,height:a,top:0,right:s,bottom:a,left:0};o=Ta(d,e),r=ka(d,i),t=window}t&&(o!==this._verticalScrollDirection||r!==this._horizontalScrollDirection||t!==this._scrollNode)&&(this._verticalScrollDirection=o,this._horizontalScrollDirection=r,this._scrollNode=t,(o||r)&&t?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let i=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=i.msScrollSnapType||i.scrollSnapType||"",i.scrollSnapType=i.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let i=this._container.style;i.scrollSnapType=i.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Gn(0,Un).pipe($e(this._stopScrollTimers)).subscribe(()=>{let i=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===He.UP?i.scrollBy(0,-e):this._verticalScrollDirection===He.DOWN&&i.scrollBy(0,e),this._horizontalScrollDirection===ye.LEFT?i.scrollBy(-e,0):this._horizontalScrollDirection===ye.RIGHT&&i.scrollBy(e,0)})};_isOverContainer(i,e){return this._domRect!=null&&Rn(this._domRect,i,e)}_getSiblingContainerFromPosition(i,e,t){return this._siblings.find(o=>o._canReceive(i,e,t))}_canReceive(i,e,t){if(!this._domRect||!Rn(this._domRect,e,t)||!this.enterPredicate(i,this))return!1;let o=this._getShadowRoot().elementFromPoint(e,t);return o?o===this._container||this._container.contains(o):!1}_startReceiving(i,e){let t=this._activeSiblings;!t.has(i)&&e.every(o=>this.enterPredicate(o,this)||this._draggables.indexOf(o)>-1)&&(t.add(i),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:i,receiver:this,items:e}))}_stopReceiving(i){this._activeSiblings.delete(i),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:i,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(i=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(i);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let i=io(this._container);this._cachedShadowRoot=i||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let i=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,i))}};function Ta(n,i){let{top:e,bottom:t,height:o}=n,r=o*Oa;return i>=e-r&&i<=e+r?He.UP:i>=t-r&&i<=t+r?He.DOWN:He.NONE}function ka(n,i){let{left:e,right:t,width:o}=n,r=o*Oa;return i>=e-r&&i<=e+r?ye.LEFT:i>=t-r&&i<=t+r?ye.RIGHT:ye.NONE}function od(n,i,e,t,o){let r=Ta(i,o),s=ka(i,t),a=He.NONE,d=ye.NONE;if(r){let f=n.scrollTop;r===He.UP?f>0&&(a=He.UP):n.scrollHeight-f>n.clientHeight&&(a=He.DOWN)}if(s){let f=n.scrollLeft;e==="rtl"?s===ye.RIGHT?f<0&&(d=ye.RIGHT):n.scrollWidth+f>n.clientWidth&&(d=ye.LEFT):s===ye.LEFT?f>0&&(d=ye.LEFT):n.scrollWidth-f>n.clientWidth&&(d=ye.RIGHT)}return[a,d]}var Gi={capture:!0},kn={passive:!1,capture:!0},nd=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(t,o){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return n})(),Ia=(()=>{class n{_ngZone=l(le);_document=l(Ht);_styleLoader=l(Kt);_renderer=l(Si).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new S;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=O([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new S;pointerUp=new S;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,kn)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,t){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(nd),this._activeDragInstances.update(o=>[...o,e]),this._activeDragInstances().length===1)){let o=t.type.startsWith("touch"),r=a=>this.pointerUp.next(a),s=[["scroll",a=>this._scroll.next(a),Gi],["selectstart",this._preventDefaultWhileDragging,kn]];o?s.push(["touchend",r,Gi],["touchcancel",r,Gi]):s.push(["mouseup",r,Gi]),o||s.push(["mousemove",a=>this.pointerMove.next(a),kn]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([a,d,f])=>this._renderer.listen(this._document,a,d,f))})}}stopDragging(e){this._activeDragInstances.update(t=>{let o=t.indexOf(e);return o>-1?(t.splice(o,1),[...t]):t}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let t=[this._scroll];return e&&e!==this._document&&t.push(new _t(o=>this._ngZone.runOutsideAngular(()=>{let r=this._renderer.listen(e,"scroll",s=>{this._activeDragInstances().length&&o.next(s)},Gi);return()=>{r()}}))),Qe(...t)}registerDirectiveNode(e,t){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,t)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),rd={dragStartThreshold:5,pointerDirectionChangeThreshold:5},Ra=(()=>{class n{_document=l(Ht);_ngZone=l(le);_viewportRuler=l(ao);_dragDropRegistry=l(Ia);_renderer=l(Si).createRenderer(null,null);constructor(){}createDrag(e,t=rd){return new Fn(e,t,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(e){return new Nn(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pa=new U("CDK_DRAG_PARENT");var sd=new U("CdkDragHandle");var Aa=new U("CDK_DRAG_CONFIG"),Fa=new U("CdkDropList"),Jo=(()=>{class n{element=l(oe);dropContainer=l(Fa,{optional:!0,skipSelf:!0});_ngZone=l(le);_viewContainerRef=l(Xi);_dir=l(Rt,{optional:!0});_changeDetectorRef=l(Me);_selfHandle=l(sd,{optional:!0,self:!0});_parentDrag=l(Pa,{optional:!0,skipSelf:!0});_dragDropRegistry=l(Ia);_destroyed=new S;_handles=new Ge([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new ae;released=new ae;ended=new ae;entered=new ae;exited=new ae;dropped=new ae;moved=new _t(e=>{let t=this._dragRef.moved.pipe(Vt(o=>({source:this,pointerPosition:o.pointerPosition,event:o.event,delta:o.delta,distance:o.distance}))).subscribe(e);return()=>{t.unsubscribe()}});_injector=l(Ke);constructor(){let e=this.dropContainer,t=l(Aa,{optional:!0}),o=l(Ra);this._dragRef=o.createDrag(this.element,{dragStartThreshold:t&&t.dragStartThreshold!=null?t.dragStartThreshold:5,pointerDirectionChangeThreshold:t&&t.pointerDirectionChangeThreshold!=null?t.pointerDirectionChangeThreshold:5,zIndex:t?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),t&&this._assignDefaults(t),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe($e(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){Ot(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let t=e.rootElementSelector,o=e.freeDragPosition;t&&!t.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,o&&!o.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let t=this._handles.getValue();t.push(e),this._handles.next(t)}_removeHandle(e){let t=this._handles.getValue(),o=t.indexOf(e);o>-1&&(t.splice(o,1),this._handles.next(t))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,t=e;this.rootElementSelector&&(t=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(t||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):je(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let t=this._dir,o=this.dragStartDelay,r=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof o=="object"&&o?o:oo(o),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),t&&e.withDirection(t.value)}}),e.beforeStarted.pipe(Zi(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let t=this.element.nativeElement.parentElement;for(;t;){let o=this._dragDropRegistry.getDragDirectiveForNode(t);if(o){e.withParent(o._dragRef);break}t=t.parentElement}})}_handleEvents(e){e.started.subscribe(t=>{this.started.emit({source:this,event:t.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(t=>{this.released.emit({source:this,event:t.event})}),e.ended.subscribe(t=>{this.ended.emit({source:this,distance:t.distance,dropPoint:t.dropPoint,event:t.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(t=>{this.entered.emit({container:t.container.data,item:this,currentIndex:t.currentIndex})}),e.exited.subscribe(t=>{this.exited.emit({container:t.container.data,item:this})}),e.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,isPointerOverContainer:t.isPointerOverContainer,item:this,distance:t.distance,dropPoint:t.dropPoint,event:t.event})})}_assignDefaults(e){let{lockAxis:t,dragStartDelay:o,constrainPosition:r,previewClass:s,boundaryElement:a,draggingDisabled:d,rootElementSelector:f,previewContainer:g}=e;this.disabled=d??!1,this.dragStartDelay=o||0,this.lockAxis=t||null,r&&(this.constrainPosition=r),s&&(this.previewClass=s),a&&(this.boundaryElement=a),f&&(this.rootElementSelector=f),g&&(this.previewContainer=g)}_setupHandlesListener(){this._handles.pipe(zt(e=>{let t=e.map(o=>o.element);this._selfHandle&&this.rootElementSelector&&t.push(this.element),this._dragRef.withHandles(t)}),Bt(e=>Qe(...e.map(t=>t._stateChanges.pipe(Dt(t))))),$e(this._destroyed)).subscribe(e=>{let t=this._dragRef,o=e.element.nativeElement;e.disabled?t.disableHandle(o):t.enableHandle(o)})}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,o){t&2&&F("cdk-drag-disabled",o.disabled)("cdk-drag-dragging",o._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",pe],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",mr]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[ce([{provide:Pa,useExisting:n}]),Ut]})}return n})(),Ea=new U("CdkDropListGroup");var en=(()=>{class n{element=l(oe);_changeDetectorRef=l(Me);_scrollDispatcher=l(Sr);_dir=l(Rt,{optional:!0});_group=l(Ea,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new S;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=l(Pe).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new ae;entered=new ae;exited=new ae;sorted=new ae;_unsortedItems=new Set;constructor(){let e=l(Ra),t=l(Aa,{optional:!0});this._dropListRef=e.createDropList(this.element),this._dropListRef.data=this,t&&this._assignDefaults(t),this._dropListRef.enterPredicate=(o,r)=>this.enterPredicate(o.data,r.data),this._dropListRef.sortPredicate=(o,r,s)=>this.sortPredicate(o,r.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),n._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(t=>t._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){let t=this._latestSortedRefs.indexOf(e._dragRef);t>-1&&(this._latestSortedRefs.splice(t,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,t)=>e._dragRef.getVisibleElement().compareDocumentPosition(t._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=n._dropLists.indexOf(this);e>-1&&n._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(Dt(this._dir.value),$e(this._destroyed)).subscribe(t=>e.withDirection(t)),e.beforeStarted.subscribe(()=>{let t=no(this.connectedTo).map(o=>{if(typeof o=="string"){let r=n._dropLists.find(s=>s.id===o);return r}return o});if(this._group&&this._group._items.forEach(o=>{t.indexOf(o)===-1&&t.push(o)}),!this._scrollableParentsResolved){let o=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(r=>r.getElementRef().nativeElement);this._dropListRef.withScrollableParents(o),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let o=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(o)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=oo(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(t.filter(o=>o&&o!==this).map(o=>o._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(t=>t._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(t=>{this.entered.emit({container:this,item:t.item.data,currentIndex:t.currentIndex})}),e.exited.subscribe(t=>{this.exited.emit({container:this,item:t.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(t=>{this.sorted.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,container:this,item:t.item.data})}),e.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,item:t.item.data,isPointerOverContainer:t.isPointerOverContainer,distance:t.distance,dropPoint:t.dropPoint,event:t.event}),this._changeDetectorRef.markForCheck()}),Qe(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:t,draggingDisabled:o,sortingDisabled:r,listAutoScrollDisabled:s,listOrientation:a}=e;this.disabled=o??!1,this.sortingDisabled=r??!1,this.autoScrollDisabled=s??!1,this.orientation=a||"vertical",this.lockAxis=t||null}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=ne({type:n,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,o){t&2&&(Ce("id",o.id),F("cdk-drop-list-disabled",o.disabled)("cdk-drop-list-dragging",o._dropListRef.isDragging())("cdk-drop-list-receiving",o._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",pe],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",pe],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",pe],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",pe]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[ce([{provide:Ea,useValue:void 0},{provide:Fa,useExisting:n}])]})}return n})();function ad(n,i){if(n&1){let e=Q();h(0,"div",7),x("mousedown",function(){let o=k(e).$implicit,r=M(2);return I(r.onSectorSelected(o))}),u(1),h(2,"button",8),x("mousedown",function(o){return k(e),I(o.stopPropagation())}),h(3,"mat-icon",9),u(4,"more_vert"),m()(),h(5,"mat-menu",10,0)(7,"button",11),x("click",function(){let o=k(e).$implicit,r=M(2);return I(r.navigateToContourPanel(o))}),h(8,"mat-icon",12),u(9,"draw"),m(),u(10),_(11,"translate"),m(),h(12,"button",11),x("click",function(){let o=k(e).$implicit,r=M(2);return I(r.navigateToPropertyPanel(o))}),h(13,"mat-icon",12),u(14,"settings_input_composite"),m(),u(15),_(16,"translate"),m(),h(17,"button",11),x("click",function(){let o=k(e).$implicit,r=M(2);return I(r.openRemoveSectorDialog(o))}),h(18,"mat-icon",12),u(19,"delete"),m(),u(20),_(21,"translate"),m()()()}if(n&2){let e=i.$implicit,t=_e(6),o=M(2);F("selected",e===o.selectedSector),c(),E(" ",e.name," "),c(),y("matMenuTriggerFor",t),c(8),E(" ",b(11,7,"tool.sectors.contourList.editContour")," "),c(5),E(" ",b(16,9,"tool.sectors.contourList.editProperties")," "),c(5),E(" ",b(21,11,"tool.sectors.contourList.removeSector")," ")}}function ld(n,i){if(n&1){let e=Q();h(0,"div",5),x("cdkDropListDropped",function(o){k(e);let r=M();return I(r.dropSectorBox(o))}),Se(1,ad,22,13,"div",6,Wt),m()}if(n&2){let e=M();c(),we(e.sectors())}}function cd(n,i){n&1&&(h(0,"div",4),u(1),_(2,"translate"),m()),n&2&&(c(),v(b(2,1,"tool.sectors.contourList.noSectors")))}var La=(()=>{class n{constructor(){this.store=l(N),this.translate=l(J),this.dialog=l(oi),this.router=l(X),this.destroyRef=l(G),this.sectors=this.store.selectSignal(be),this.sectorsContoursService=l(ft)}openRemoveSectorDialog(e){let t={title:this.translate.instant("tool.sectors.contourList.removeSector"),message:this.translate.instant("tool.sectors.contourList.removeSectorMessage")};this.dialog.open(li,{data:t}).afterClosed().pipe(H(this.destroyRef)).subscribe(o=>{o&&(this.store.dispatch(ve.sectorRemoved({sector:e})),this.selectedSector===e&&this.resetSelectedSector(),this.sectorsContoursService.emitSectorListChanged({selectedSector:this.selectedSector}))})}emitSectorToEditContour(e){this.sectorsContoursService.emitEditedSectorContour({sector:xe(D({},e),{vertices:[...e.vertices]}),selectedVertex:e.vertices.at(-1)})}navigateToNewSectorPanel(){this.router.navigate(["/tool/sectors/contour"])}navigateToContourPanel(e){this.router.navigate([`/tool/sectors/${e.id}/contour`])}navigateToPropertyPanel(e){this.router.navigate([`/tool/sectors/${e.id}/property`])}emitSectorToEditProperty(e){this.sectorsContoursService.emitEditedSectorProperty({sector:e,mesh:null,contour:null})}onSectorSelected(e){this.selectedSector=e,this.sectorsContoursService.emitSectorListChanged({selectedSector:e})}dropSectorBox(e){this.store.dispatch(ve.sectorShifted({prevIndex:e.previousIndex,newIndex:e.currentIndex})),this.sectorsContoursService.emitSectorListChanged({selectedSector:this.selectedSector})}resetSelectedSector(){let e=this.sectors();this.selectedSector=e.length?e[0]:null}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-sectors-contours-list"]],decls:6,vars:4,consts:[["menu","matMenu"],[1,"actions"],["mat-flat-button","","color","accent",3,"click"],["cdkDropList","",1,"sectors-list"],[1,"no-sectors"],["cdkDropList","",1,"sectors-list",3,"cdkDropListDropped"],["cdkDrag","",1,"sector-box",3,"selected"],["cdkDrag","",1,"sector-box",3,"mousedown"],["mat-icon-button","",1,"sector-actions",3,"mousedown","matMenuTriggerFor"],["matListIcon",""],["classList","paddingless"],["mat-menu-item","",3,"click"],["matListIcon","",1,"material-symbols-outlined"]],template:function(t,o){t&1&&(h(0,"div",1)(1,"button",2),x("click",function(){return o.navigateToNewSectorPanel()}),u(2),_(3,"translate"),m()(),R(4,ld,3,0,"div",3)(5,cd,3,3,"div",4)),t&2&&(c(2),E(" ",b(3,2,"tool.sectors.contourList.addSector")," "),c(2),A(o.sectors().length?4:5))},dependencies:[V,se,Ve,Ne,Le,ai,ri,ni,si,en,Jo,K,ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:20px;height:100%}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .no-sectors[_ngcontent-%COMP%]{color:var(--irr-contrast-light);margin:auto}.sectors-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.sectors-list[_ngcontent-%COMP%]   .sector-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}.sectors-list[_ngcontent-%COMP%]   .sector-box.selected[_ngcontent-%COMP%]{background:var(--irr-contrast-light)}.sectors-list[_ngcontent-%COMP%]   .sector-box[_ngcontent-%COMP%]{cursor:move}.sectors-list[_ngcontent-%COMP%]   .sector-box[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]     .mat-icon{width:24px;height:24px;font-size:24px}.sectors-list[_ngcontent-%COMP%]   .sector-box[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]    {--mat-icon-button-state-layer-size: 32px;padding:4px}.sectors-list[_ngcontent-%COMP%]   .sector-box[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]     .mat-mdc-button-touch-target{width:var(--mat-icon-button-state-layer-size);height:var(--mat-icon-button-state-layer-size)}.sectors-list[_ngcontent-%COMP%]   .sector-box[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]{margin:-6px;color:var(--irr-contrast-medium)}.sectors-list[_ngcontent-%COMP%]   .sector-box.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.sectors-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}.cdk-drag-preview.selected[_ngcontent-%COMP%]{background:var(--irr-contrast-light)}.cdk-drag-preview[_ngcontent-%COMP%]{cursor:grab}.cdk-drag-preview[_ngcontent-%COMP%]   .sector-actions[_ngcontent-%COMP%]{display:none}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0})}}return n})();var dd=["*"],Na=(()=>{class n{constructor(){this.label=me.required(),this.shouldBeOpen=me(!0),this.isOpen=O(!0)}ngOnInit(){this.isOpen.set(this.shouldBeOpen())}toggle(){this.isOpen.update(e=>!e)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-extended-panel"]],inputs:{label:[1,"label"],shouldBeOpen:[1,"shouldBeOpen"]},ngContentSelectors:dd,decls:8,vars:4,consts:[[1,"label"],[1,"label-content"],["mat-icon-button","",1,"toggle-button",3,"click"],[1,"chevron"],[1,"panel",3,"isOpen"]],template:function(t,o){t&1&&(Ue(),h(0,"div",0)(1,"span",1),u(2),m(),h(3,"button",2),x("click",function(){return o.toggle()}),h(4,"mat-icon",3),u(5," keyboard_arrow_up "),m()()(),h(6,"app-expandable-panel",4),re(7),m()),t&2&&(c(2),v(o.label()),c(2),F("chevron--closed",!o.isOpen()),c(2),y("isOpen",o.isOpen()))},dependencies:[Ne,Le,V,Ve,pi],styles:["[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]   .label-content[_ngcontent-%COMP%]{margin-left:15px;font-weight:500}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{margin-left:auto}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]     .mat-icon{width:24px;height:24px;font-size:24px}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]    {--mat-icon-button-state-layer-size: 32px;padding:4px}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]     .mat-mdc-button-touch-target{width:var(--mat-icon-button-state-layer-size);height:var(--mat-icon-button-state-layer-size)}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:all .25s ease}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]   .chevron--closed[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0})}}return n})();var ja=(()=>{class n{constructor(){this.http=l(fr)}getPolygonTriangulationMesh(e){let t={headers:new ur({"Content-Type":"application/json","Access-Control-Allow-Origin":"*"})};return this.http.post(ra(),e,t).pipe(zt(o=>Ui.restore(o)))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Va=(()=>{class n{constructor(){this.fb=l(ti),this.store=l(N),this.dataService=l(ja),this.snackBar=l(nt),this.service=l(ft),this.translate=l(J),this.route=l(Gt),this.router=l(X),this.destroyRef=l(G)}ngOnInit(){this.prepareSector(),this.sectorPropertyForm=this.generateForm(this.sector.properties),this.getTriangulationMesh()}prepareSector(){let e=this.route.snapshot.paramMap.get("id");e&&(this.sector=this.store.selectSignal(be)().find(t=>t.id===e))}generateForm(e){return this.fb.group({sectionMaxArea:[e.sectionMaxArea,[L.required,L.min(.1)]],sectionMinAngle:[e.sectionMinAngle,[L.required,L.min(10),L.max(90)]],minTileRadius:[e.minTileRadius,[L.min(0)]],maxTileRadius:[e.maxTileRadius,[L.min(0)]],tileMargin:[e.tilesMargin,[L.required]],populationParams:this.generatePopulationParamsForm(e.populationParams),evaluationParams:this.generateEvaluationParamsForm(e.evaluationParams)})}generatePopulationParamsForm(e){return this.fb.group({initialPopulationSize:[e.initialPopulationSize,[L.required]],countOfTriesToInsertTile:[e.countOfTriesToInsertTile,[L.required]],countOfTrianglePositionDraws:[e.countOfTrianglePositionDraws,[L.required]],countOfColorMatchingAttempts:[e.countOfColorMatchingAttempts,[L.required]],iterationsCount:[e.iterationsCount,[L.required]],populationSize:[e.populationSize,[L.required]]})}generateEvaluationParamsForm(e){return this.fb.group({singleSectionPopulation:[e.singleSectionPopulation,[L.required]],overlappingAreaOutsideSector:[e.overlappingAreaOutsideSector,[L.required]],additionalPopulationOfNeighboringSectors:[e.additionalPopulationOfNeighboringSectors,[L.required]],overlappingNotPopulatedSections:[e.overlappingNotPopulatedSections,[L.required]],tileColorMismatch:[e.tileColorMismatch,[L.required]]})}navigateToSectorList(){this.router.navigate(["/tool/sectors"])}cancel(){this.service.emitEditedSectorProperty(null),this.navigateToSectorList()}save(){if(this.sectorPropertyForm.valid){let e=this.getFormData();this.store.dispatch(ve.sectorModified({modifiedSector:xe(D({},this.sector),{properties:e})})),this.service.emitEditedSectorProperty(null),this.navigateToSectorList()}}getFormData(){return{sectionMaxArea:this.sectorPropertyForm.controls.sectionMaxArea.value,sectionMinAngle:this.sectorPropertyForm.controls.sectionMinAngle.value,minTileRadius:this.sectorPropertyForm.controls.minTileRadius.value,maxTileRadius:this.sectorPropertyForm.controls.maxTileRadius.value,tilesMargin:this.sectorPropertyForm.controls.tileMargin.value,evaluationParams:this.getFormEvaluationParams(),populationParams:this.getFormPopulationParams()}}getFormPopulationParams(){let e=this.sectorPropertyForm.controls.populationParams.controls;return{initialPopulationSize:e.initialPopulationSize.value,countOfTriesToInsertTile:e.countOfTriesToInsertTile.value,countOfTrianglePositionDraws:e.countOfTrianglePositionDraws.value,countOfColorMatchingAttempts:e.countOfColorMatchingAttempts.value,iterationsCount:e.iterationsCount.value,populationSize:e.populationSize.value}}getFormEvaluationParams(){let e=this.sectorPropertyForm.controls.evaluationParams.controls;return{singleSectionPopulation:e.singleSectionPopulation.value,overlappingAreaOutsideSector:e.overlappingAreaOutsideSector.value,additionalPopulationOfNeighboringSectors:e.additionalPopulationOfNeighboringSectors.value,overlappingNotPopulatedSections:e.overlappingNotPopulatedSections.value,tileColorMismatch:e.tileColorMismatch.value}}getTriangulationMesh(){let e={polygonVertices:this.sector.vertices,sectionMaxArea:this.sectorPropertyForm.controls.sectionMaxArea.value,sectionMinAngle:this.sectorPropertyForm.controls.sectionMinAngle.value};this.dataService.getPolygonTriangulationMesh(e).pipe(H(this.destroyRef)).subscribe({next:t=>this.service.emitEditedSectorProperty({sector:this.sector,mesh:t.triangles,contour:t.contour}),error:()=>this.showPolygonTriangulationError()})}showPolygonTriangulationError(){this.snackBar.open(this.translate.instant("tool.sectors.sectorProperty.errorOnSectorMeshRequesting"),this.translate.instant("common.ok"),{duration:2e3})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-sector-property-editor"]],decls:96,vars:77,consts:[[1,"actions"],["mat-flat-button","",3,"click"],["mat-flat-button","","color","accent",3,"click"],[1,"sector-property-form",3,"formGroup"],[3,"label"],[1,"form-group"],["appearance","outline","matTooltipPosition","left",1,"density-3","no-hint",3,"matTooltip"],["matInput","","formControlName","sectionMaxArea","type","number",3,"change"],["matInput","","formControlName","sectionMinAngle","type","number",3,"change"],["matInput","","formControlName","minTileRadius","type","number"],["matInput","","formControlName","maxTileRadius","type","number"],["matInput","","formControlName","tileMargin","type","number","min","0"],[3,"label","shouldBeOpen"],["formGroupName","populationParams",1,"form-group"],["matInput","","formControlName","initialPopulationSize","type","number"],["matInput","","formControlName","populationSize","type","number"],["matInput","","formControlName","iterationsCount","type","number"],["matInput","","formControlName","countOfTrianglePositionDraws","type","number"],["matInput","","formControlName","countOfTriesToInsertTile","type","number"],["matInput","","formControlName","countOfColorMatchingAttempts","type","number"],["formGroupName","evaluationParams",1,"form-group"],["matInput","","formControlName","singleSectionPopulation","type","number"],["matInput","","formControlName","overlappingAreaOutsideSector","type","number"],["matInput","","formControlName","additionalPopulationOfNeighboringSectors","type","number"],["matInput","","formControlName","overlappingNotPopulatedSections","type","number"],["matInput","","formControlName","tileColorMismatch","type","number"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"button",1),x("click",function(){return o.cancel()}),u(2),_(3,"translate"),m(),h(4,"button",2),x("click",function(){return o.save()}),u(5),_(6,"translate"),m()(),h(7,"form",3)(8,"app-extended-panel",4)(9,"div",5)(10,"mat-form-field",6)(11,"mat-label"),u(12),_(13,"translate"),m(),h(14,"input",7),x("change",function(){return o.getTriangulationMesh()}),m()(),h(15,"mat-form-field",6)(16,"mat-label"),u(17),_(18,"translate"),m(),h(19,"input",8),x("change",function(){return o.getTriangulationMesh()}),m()()()(),h(20,"app-extended-panel",4)(21,"div",5)(22,"mat-form-field",6)(23,"mat-label"),u(24),_(25,"translate"),m(),w(26,"input",9),m(),h(27,"mat-form-field",6)(28,"mat-label"),u(29),_(30,"translate"),m(),w(31,"input",10),m(),h(32,"mat-form-field",6)(33,"mat-label"),u(34),_(35,"translate"),m(),w(36,"input",11),m()()(),h(37,"app-extended-panel",12)(38,"div",13)(39,"mat-form-field",6)(40,"mat-label"),u(41),_(42,"translate"),m(),w(43,"input",14),m(),h(44,"mat-form-field",6)(45,"mat-label"),u(46),_(47,"translate"),m(),w(48,"input",15),m(),h(49,"mat-form-field",6)(50,"mat-label"),u(51),_(52,"translate"),m(),w(53,"input",16),m(),h(54,"mat-form-field",6)(55,"mat-label"),u(56),_(57,"translate"),m(),w(58,"input",17),m(),h(59,"mat-form-field",6)(60,"mat-label"),u(61),_(62,"translate"),m(),w(63,"input",18),m(),h(64,"mat-form-field",6)(65,"mat-label"),u(66),_(67,"translate"),m(),w(68,"input",19),m()()(),h(69,"app-extended-panel",12)(70,"div",20)(71,"mat-form-field",6)(72,"mat-label"),u(73),_(74,"translate"),m(),w(75,"input",21),m(),h(76,"mat-form-field",6)(77,"mat-label"),u(78),_(79,"translate"),m(),w(80,"input",22),m(),h(81,"mat-form-field",6)(82,"mat-label"),u(83),_(84,"translate"),m(),w(85,"input",23),m(),h(86,"mat-form-field",6)(87,"mat-label"),u(88),_(89,"translate"),m(),w(90,"input",24),m(),h(91,"mat-form-field",6)(92,"mat-label"),u(93),_(94,"translate"),m(),w(95,"input",25),m()()()()),t&2&&(c(2),E(" ",b(3,41,"common.cancel")," "),c(3),E(" ",b(6,43,"common.confirm")," "),c(2),y("formGroup",o.sectorPropertyForm),c(),y("label",o.translate.instant("tool.sectors.sectorProperty.sectorsSize")),c(2),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.maxAreaHint")),c(2),v(b(13,45,"tool.sectors.sectorProperty.maxArea")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.minAngleHint")),c(2),v(b(18,47,"tool.sectors.sectorProperty.minAngle")),c(3),y("label",o.translate.instant("tool.sectors.sectorProperty.tilesLimitations")),c(2),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.minRadiusHint")),c(2),v(b(25,49,"tool.sectors.sectorProperty.minRadius")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.maxRadiusHint")),c(2),v(b(30,51,"tool.sectors.sectorProperty.maxRadius")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.minMarginHint")),c(2),v(b(35,53,"tool.sectors.sectorProperty.minMargin")),c(3),y("label",o.translate.instant("tool.sectors.sectorProperty.populationParams"))("shouldBeOpen",!1),c(2),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.initialPopulationSizeHint")),c(2),v(b(42,55,"tool.sectors.sectorProperty.initialPopulationSize")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.populationSizeHint")),c(2),v(b(47,57,"tool.sectors.sectorProperty.populationSize")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.iterationsCountHint")),c(2),v(b(52,59,"tool.sectors.sectorProperty.iterationsCount")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.countOfTrianglePositionDrawsHint")),c(2),v(b(57,61,"tool.sectors.sectorProperty.countOfTrianglePositionDraws")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.countOfTriesToInsertTileHint")),c(2),v(b(62,63,"tool.sectors.sectorProperty.countOfTriesToInsertTile")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.countOfColorMatchingAttemptsHint")),c(2),v(b(67,65,"tool.sectors.sectorProperty.countOfColorMatchingAttempts")),c(3),y("label",o.translate.instant("tool.sectors.sectorProperty.evaluationParams"))("shouldBeOpen",!1),c(2),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.singleSectionPopulationHint")),c(2),v(b(74,67,"tool.sectors.sectorProperty.singleSectionPopulation")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.overlappingAreaOutsideSectorHint")),c(2),v(b(79,69,"tool.sectors.sectorProperty.overlappingAreaOutsideSector")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.overlappingAreaOutsideSectorHint")),c(2),v(b(84,71,"tool.sectors.sectorProperty.additionalPopulationOfNeighboringSectors")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.overlappingNotPopulatedSectionsHint")),c(2),v(b(89,73,"tool.sectors.sectorProperty.overlappingNotPopulatedSections")),c(3),y("matTooltip",o.translate.instant("tool.sectors.sectorProperty.tileColorMismatchHint")),c(2),v(b(94,75,"tool.sectors.sectorProperty.tileColorMismatch")))},dependencies:[V,se,We,ze,Oe,ot,it,kr,Tr,ii,Jt,Ct,fo,Xe,Xt,Nr,St,ei,Lr,Na,K,ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:20px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1 1 0}[_nghost-%COMP%]   .sector-property-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;width:100%}[_nghost-%COMP%]   .sector-property-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:18px;margin-top:12px}"],changeDetection:0})}}return n})();function Ba(n){return i=>{let e=i.value;return n.includes(e)?{nonUnique:!0}:null}}var tn=class{static isPointInsidePolygon(i,e){if(i.length<3)return!1;let t=new j(Number.MAX_VALUE,e.y),o=new gt(e,t),r=0,s=0;do{let a=new gt(i[s],i[(s+1)%i.length]);if(this.areLineIntersecting(a,o)){if(this.getDirection(a.start,e,a.end)==0)return this.isPointOnLine(a,e);r++}s=(s+1)%i.length}while(s!=0);return(r&1)==1}static areLineIntersecting(i,e){let t=this.getDirection(i.start,i.end,e.start),o=this.getDirection(i.start,i.end,e.end),r=this.getDirection(e.start,e.end,i.start),s=this.getDirection(e.start,e.end,i.end);return!!(t!=o&&r!=s||t==0&&this.isPointOnLine(i,e.start)||o==0&&this.isPointOnLine(i,e.end)||r==0&&this.isPointOnLine(e,i.start)||s==0&&this.isPointOnLine(e,i.end))}static isPointOnLine(i,e){return e.x<=Math.max(i.start.x,i.end.x)&&e.x>=Math.min(i.start.x,i.end.x)&&e.y<=Math.max(i.start.y,i.end.y)&&e.y>=Math.min(i.start.y,i.end.y)}static getDirection(i,e,t){let o=(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y);return o==0?0:o<0?2:1}};function za(){return n=>{let i=n.value;return i.length<3?{tooFewVertices:!0}:md(i)?{edgesIntersect:!0}:null}}function md(n){let i=[];for(let e=0;e<n.length;++e)i.push(new gt(n[e],n.at(e-1)));for(let e=0;e<n.length;++e)for(let t=0;t<n.length;++t)if(!(e===t||(e+1)%n.length===t||(t+1)%n.length===e)&&tn.areLineIntersecting(i[e],i[t]))return!0;return!1}function hd(n,i){if(n&1){let e=Q();h(0,"div",11),x("mousedown",function(){let o=k(e).$implicit,r=M(2);return I(r.onBoxSelected(o))}),u(1),h(2,"button",12),x("click",function(){let o=k(e).$implicit,r=M(2);return I(r.removeVertex(o))})("mousedown",function(o){return k(e),I(o.stopPropagation())}),h(3,"mat-icon",13),u(4,"close"),m()()()}if(n&2){let e=i.$implicit,t=M(2);F("selected",e===t.selectedVertex()),c(),E(" ",t.getVertexLabel(e)," ")}}function pd(n,i){if(n&1){let e=Q();h(0,"div",9),x("cdkDropListDropped",function(o){k(e);let r=M();return I(r.dropVertexBox(o))}),Se(1,hd,5,3,"div",10,Wt),m()}if(n&2){let e=M();c(),we(e.sectorForm.get("vertices").value)}}function ud(n,i){n&1&&(h(0,"div",8),u(1),_(2,"translate"),m()),n&2&&(c(),v(b(2,1,"tool.sectors.sectorContour.addSectorVertices")))}var Bn=(()=>{class n{constructor(){this.selectedVertex=O(null),this.store=l(N),this.snackbarService=l(nt),this.sectorsContoursService=l(ft),this.translate=l(J),this.fb=l(ti),this.route=l(Gt),this.router=l(X),this.destroyRef=l(G),this.changeDetector=l(Me)}ngOnInit(){this.prepareSector(),this.initForm(),this.subscribeOnCanvasClicked(),this.emitContourPreviewChanged()}subscribeOnCanvasClicked(){this.sectorsContoursService.canvasClicked$.pipe(H(this.destroyRef)).subscribe(e=>this.addVertex(new j(e.x,e.y)))}prepareSector(){let e=this.route.snapshot.paramMap.get("id");e?(this.sector=this.store.selectSignal(be)().find(t=>t.id===e),this.selectedVertex.set(this.sector.vertices[0])):this.sector=ft.createNewSector()}initForm(){let e=this.store.selectSignal(be)().filter(t=>t.id!==this.sector.id).map(t=>t.name);this.sectorForm=this.fb.group({name:this.fb.nonNullable.control(this.sector.name,{validators:[L.required,Ba(e)]}),color:this.fb.nonNullable.control(this.sector.color,{validators:[L.required]}),vertices:this.fb.nonNullable.control(this.sector.vertices,{validators:[za()]})}),this.sectorForm.statusChanges.pipe(H(this.destroyRef)).subscribe(()=>this.changeDetector.markForCheck())}addVertex(e){let t=[...this.sectorForm.controls.vertices.value],o=t.indexOf(this.selectedVertex());t.splice(o+1,0,e),this.sectorForm.controls.vertices.setValue(t),this.selectedVertex.set(e),this.emitContourPreviewChanged()}removeVertex(e){let t=this.sectorForm.controls.vertices.value.filter(o=>o!==e);this.sectorForm.controls.vertices.setValue(t),e===this.selectedVertex()&&this.resetSelectedVertex(),this.emitContourPreviewChanged()}navigateToSectorList(){this.router.navigate(["/tool/sectors"])}cancel(){this.sectorsContoursService.emitEditedSectorContour(null),this.navigateToSectorList()}save(){this.sectorForm.valid?(this.store.dispatch(ve.sectorModified({modifiedSector:this.getUpdatedSectorModel()})),this.sectorsContoursService.emitEditedSectorContour(null),this.navigateToSectorList()):this.showWarning(this.showValidationError())}showValidationError(){return this.sectorForm.controls.name.hasError("required")?this.translate.instant("tool.sectors.sectorContour.nameRequired"):this.sectorForm.controls.name.hasError("nonUnique")?this.translate.instant("tool.sectors.sectorContour.nameAlreadyInUse"):this.sectorForm.controls.vertices.hasError("tooFewVertices")?this.translate.instant("tool.sectors.sectorContour.tooFewVertices"):this.sectorForm.controls.vertices.hasError("edgesIntersect")?this.translate.instant("tool.sectors.sectorContour.linesCannotIntersecting"):""}showWarning(e){this.snackbarService.open(e,this.translate.instant("common.ok"),{duration:3e3})}onBoxSelected(e){this.selectedVertex.set(e),this.emitContourPreviewChanged()}onColorChanged(){this.emitContourPreviewChanged()}dropVertexBox(e){let t=this.sectorForm.controls.vertices.value;Xo(t,e.previousIndex,e.currentIndex),this.sectorForm.controls.vertices.setValue(t),this.emitContourPreviewChanged()}getVertexLabel(e){return`(${e.x.toFixed(2)}, ${e.y.toFixed(2)})`}resetSelectedVertex(){let e=this.sectorForm.controls.vertices.value;this.selectedVertex.set(e.at(-1)??null)}emitContourPreviewChanged(){this.sectorsContoursService.emitEditedSectorContour({sector:this.getUpdatedSectorModel(),selectedVertex:this.selectedVertex()})}getUpdatedSectorModel(){let e=this.sectorForm.getRawValue();return xe(D({},this.sector),{color:e.color,name:e.name,vertices:e.vertices})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-sector-contour-edition"]],decls:16,vars:12,consts:[[1,"actions"],["mat-flat-button","",3,"click"],["mat-flat-button","","color","accent",3,"click"],[1,"info",3,"formGroup"],["appearance","outline","subscriptSizing","dynamic",1,"density-3"],["matInput","","formControlName","name"],["formControlName","color",3,"ngModelChange","label"],["cdkDropList","",1,"vertices-list"],[1,"no-vertices"],["cdkDropList","",1,"vertices-list",3,"cdkDropListDropped"],["cdkDrag","",1,"vertex-box",3,"selected"],["cdkDrag","",1,"vertex-box",3,"mousedown"],["mat-icon-button","",1,"vertex-remove",3,"click","mousedown"],["matListIcon",""]],template:function(t,o){t&1&&(h(0,"div",0)(1,"button",1),x("click",function(){return o.cancel()}),u(2),_(3,"translate"),m(),h(4,"button",2),x("click",function(){return o.save()}),u(5),_(6,"translate"),m()(),h(7,"form",3)(8,"mat-form-field",4)(9,"mat-label"),u(10),_(11,"translate"),m(),w(12,"input",5),m(),h(13,"app-color-picker",6),x("ngModelChange",function(){return o.onColorChanged()}),m(),R(14,pd,3,0,"div",7)(15,ud,3,3,"div",8),m()),t&2&&(c(2),v(b(3,6,"common.cancel")),c(3),v(b(6,8,"common.confirm")),c(2),y("formGroup",o.sectorForm),c(3),v(b(11,10,"tool.sectors.sectorContour.sectorName")),c(3),y("label",o.translate.instant("tool.sectors.sectorContour.sectorColor")),c(),A(o.sectorForm.get("vertices").value.length?14:15))},dependencies:[V,se,Ve,en,Jo,We,ze,Oe,ot,it,Ne,Le,wo,K,ii,Jt,Ct,Xe,Xt,St,ei,ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:20px;height:100%}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1 1 0}[_nghost-%COMP%]   .info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;flex:1}[_nghost-%COMP%]   .info[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .no-vertices[_ngcontent-%COMP%]{color:var(--irr-contrast-light);margin:auto}.vertices-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.vertices-list[_ngcontent-%COMP%]   .vertex-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}.vertices-list[_ngcontent-%COMP%]   .vertex-box.selected[_ngcontent-%COMP%]{background:var(--irr-contrast-light)}.vertices-list[_ngcontent-%COMP%]   .vertex-box[_ngcontent-%COMP%]{cursor:move}.vertices-list[_ngcontent-%COMP%]   .vertex-box[_ngcontent-%COMP%]   .vertex-remove[_ngcontent-%COMP%]     .mat-icon{width:24px;height:24px;font-size:24px}.vertices-list[_ngcontent-%COMP%]   .vertex-box[_ngcontent-%COMP%]   .vertex-remove[_ngcontent-%COMP%]    {--mat-icon-button-state-layer-size: 32px;padding:4px}.vertices-list[_ngcontent-%COMP%]   .vertex-box[_ngcontent-%COMP%]   .vertex-remove[_ngcontent-%COMP%]     .mat-mdc-button-touch-target{width:var(--mat-icon-button-state-layer-size);height:var(--mat-icon-button-state-layer-size)}.vertices-list[_ngcontent-%COMP%]   .vertex-box[_ngcontent-%COMP%]   .vertex-remove[_ngcontent-%COMP%]{margin:-6px;color:var(--irr-contrast-medium)}.vertices-list[_ngcontent-%COMP%]   .vertex-box.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.vertices-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:10px 16px;box-sizing:border-box;border-radius:4px;background:var(--irr-contrast-lightest);color:var(--irr-contrast-high);font-size:14px;box-shadow:0 0 5px 1px #0000001a}.cdk-drag-preview.selected[_ngcontent-%COMP%]{background:var(--irr-contrast-light)}.cdk-drag-preview[_ngcontent-%COMP%]{cursor:grab}.cdk-drag-preview[_ngcontent-%COMP%]   .vertex-remove[_ngcontent-%COMP%]{display:none}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0})}}return n})();var Uy=[{path:"",redirectTo:"config",pathMatch:"full"},{path:"config",component:os,children:[{path:"",component:ns},{path:"project",component:Ps}]},{path:"tray",component:Ds,canActivate:[Co],children:[{path:"",component:Bs},{path:"random",component:Ls},{path:"tile/:id",component:Us}]},{path:"sectors",component:Xs,canActivate:[Co],children:[{path:"",component:La},{path:":id/property",component:Va},{path:":id/contour",component:Bn},{path:"contour",component:Bn}]},{path:"generating",component:da,canActivate:[Co,ma]}];export{Uy as toolRoutes};
